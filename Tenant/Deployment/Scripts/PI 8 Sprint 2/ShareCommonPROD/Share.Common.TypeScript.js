!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.share=t():e.share=t()}(window,function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=12)}([function(e,t,n){"use strict";n.r(t),function(e){n.d(t,"AdalClient",function(){return E}),n.d(t,"SPFxAdalClient",function(){return x}),n.d(t,"objectToMap",function(){return A}),n.d(t,"mergeMaps",function(){return R}),n.d(t,"setup",function(){return M}),n.d(t,"RuntimeConfigImpl",function(){return D}),n.d(t,"RuntimeConfig",function(){return L}),n.d(t,"mergeHeaders",function(){return I}),n.d(t,"mergeOptions",function(){return C}),n.d(t,"FetchClient",function(){return w}),n.d(t,"BearerTokenFetchClient",function(){return O}),n.d(t,"PnPClientStorageWrapper",function(){return k}),n.d(t,"PnPClientStorage",function(){return F}),n.d(t,"getCtxCallback",function(){return s}),n.d(t,"dateAdd",function(){return u}),n.d(t,"combine",function(){return c}),n.d(t,"getRandomString",function(){return l}),n.d(t,"getGUID",function(){return p}),n.d(t,"isFunc",function(){return d}),n.d(t,"objectDefinedNotNull",function(){return f}),n.d(t,"isArray",function(){return h}),n.d(t,"extend",function(){return y}),n.d(t,"isUrlAbsolute",function(){return g}),n.d(t,"stringIsNullOrEmpty",function(){return m}),n.d(t,"getAttrValueFromString",function(){return v}),n.d(t,"sanitizeGuid",function(){return b}),n.d(t,"jsS",function(){return S}),n.d(t,"hOP",function(){return _}),n.d(t,"getHashCode",function(){return T});var r=n(10),o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function i(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var a=void 0!==e?e:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{};function s(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return function(){t.apply(e,n)}}function u(e,t,n){var r=new Date(e);switch(t.toLowerCase()){case"year":r.setFullYear(r.getFullYear()+n);break;case"quarter":r.setMonth(r.getMonth()+3*n);break;case"month":r.setMonth(r.getMonth()+n);break;case"week":r.setDate(r.getDate()+7*n);break;case"day":r.setDate(r.getDate()+n);break;case"hour":r.setTime(r.getTime()+36e5*n);break;case"minute":r.setTime(r.getTime()+6e4*n);break;case"second":r.setTime(r.getTime()+1e3*n);break;default:r=void 0}return r}function c(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.filter(function(e){return!m(e)}).map(function(e){return e.replace(/^[\\|\/]/,"").replace(/[\\|\/]$/,"")}).join("/").replace(/\\/g,"/")}function l(e){for(var t=new Array(e),n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=0;r<e;r++)t[r]=n.charAt(Math.floor(Math.random()*n.length));return t.join("")}function p(){var e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?n:3&n|8).toString(16)})}function d(e){return"function"==typeof e}function f(e){return void 0!==e&&null!==e}function h(e){return Array.isArray?Array.isArray(e):e&&"number"==typeof e.length&&e.constructor===Array}function y(e,t,n,r){if(void 0===n&&(n=!1),void 0===r&&(r=function(){return!0}),!f(t))return e;var o=n?function(e,t){return!(t in e)}:function(){return!0};return Object.getOwnPropertyNames(t).filter(function(t){return o(e,t)&&r(t)}).reduce(function(e,n){return e[n]=t[n],e},e)}function g(e){return/^https?:\/\/|^\/\//i.test(e)}function m(e){return void 0===e||null===e||e.length<1}function v(e,t){e=e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");var n=new RegExp(t+"\\s*?=\\s*?(\"|')([^\\1]*?)\\1","i").exec(e);return null!==n&&n.length>0?n[2]:null}function b(e){if(m(e))return e;var t=/([0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12})/i.exec(e);return null===t?e:t[1]}function S(e){return JSON.stringify(e)}function _(e,t){return Object.hasOwnProperty.call(e,t)}function T(e){var t=0;if(0===e.length)return t;for(var n=0;n<e.length;n++){t=(t<<5)-t+e.charCodeAt(n),t|=0}return t}function I(e,t){void 0!==t&&null!==t&&new Request("",{headers:t}).headers.forEach(function(t,n){e.append(n,t)})}function C(e,t){if(f(t)){var n=y(e.headers||{},t.headers);(e=y(e,t)).headers=n}}var w=function(){function e(){}return e.prototype.fetch=function(e,t){return a.fetch(e,t)},e}(),O=function(e){function t(t){var n=e.call(this)||this;return n._token=t,n}return i(t,e),Object.defineProperty(t.prototype,"token",{get:function(){return this._token||""},set:function(e){this._token=e},enumerable:!0,configurable:!0}),t.prototype.fetch=function(t,n){void 0===n&&(n={});var r=new Headers;return I(r,n.headers),r.set("Authorization","Bearer "+this._token),n.headers=r,e.prototype.fetch.call(this,t,n)},t}(w);function P(e){var t=document.createElement("a");return t.href=e,t.protocol+"//"+t.hostname}var E=function(e){function t(t,n,r){var o=e.call(this,null)||this;return o.clientId=t,o.tenant=n,o.redirectUri=r,o._displayCallback=null,o._loginPromise=null,o}return i(t,e),t.fromSPFxContext=function(e){return new x(e)},t.prototype.fetch=function(t,n){var r=this;if(!g(t))throw Error("You must supply absolute urls to AdalClient.fetch.");return this.getToken(P(t)).then(function(o){return r.token=o,e.prototype.fetch.call(r,t,n)})},t.prototype.getToken=function(e){var n=this;return new Promise(function(r,o){n.ensureAuthContext().then(function(e){return n.login()}).then(function(n){t._authContext.acquireToken(e,function(e,t){if(e)return o(Error(e));r(t)})}).catch(o)})},t.prototype.ensureAuthContext=function(){var e=this;return new Promise(function(n){null===t._authContext&&(t._authContext=Object(r.inject)({clientId:e.clientId,displayCall:function(t){e._displayCallback&&e._displayCallback(t)},navigateToLoginRequestUrl:!1,redirectUri:e.redirectUri,tenant:e.tenant})),n()})},t.prototype.login=function(){var e=this;return this._loginPromise?this._loginPromise:(this._loginPromise=new Promise(function(n,r){if(t._authContext.getCachedUser())return n();e._displayCallback=function(o){var i=window.open(o,"login","width=483, height=600");if(!i)return r(Error("Could not open pop-up window for auth. Likely pop-ups are blocked by the browser."));i&&i.focus&&i.focus();var a=window.setInterval(function(){i&&!i.closed&&void 0!==i.closed||window.clearInterval(a);try{-1!==i.document.URL.indexOf(e.redirectUri)&&(window.clearInterval(a),t._authContext.handleWindowCallback(i.location.hash),i.close(),n())}catch(e){r(e)}},30)},e.ensureAuthContext().then(function(n){t._authContext._loginInProgress=!1,t._authContext.login(),e._displayCallback=null})}),this._loginPromise)},t._authContext=null,t}(O),x=function(e){function t(t){var n=e.call(this,null)||this;return n.context=t,n}return i(t,e),t.prototype.fetch=function(t,n){var r=this;return this.getToken(P(t)).then(function(o){return r.token=o,e.prototype.fetch.call(r,t,n)})},t.prototype.getToken=function(e){return this.context.aadTokenProviderFactory.getTokenProvider().then(function(t){return t.getToken(e)})},t}(O),N=d(Object.entries)?Object.entries:function(e){return Object.keys(e).map(function(t){return[t,e[t]]})};function A(e){return void 0!==e&&null!==e?new Map(N(e)):new Map}function R(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var r=0;r<t.length;r++)t[r].forEach(function(t,n){e.set(n,t)});return e}function M(e){L.extend(e)}var j=["defaultCachingStore","defaultCachingTimeoutSeconds","globalCacheDisable","enableCacheExpiration","cacheExpirationIntervalMilliseconds","spfxContext"],D=function(){function e(e){void 0===e&&(e=new Map),this._v=e,this._v.set(j[0],"session"),this._v.set(j[1],60),this._v.set(j[2],!1),this._v.set(j[3],!1),this._v.set(j[4],750),this._v.set(j[5],null)}return e.prototype.extend=function(e){this._v=R(this._v,A(e))},e.prototype.get=function(e){return this._v.get(e)},Object.defineProperty(e.prototype,"defaultCachingStore",{get:function(){return this.get(j[0])},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"defaultCachingTimeoutSeconds",{get:function(){return this.get(j[1])},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"globalCacheDisable",{get:function(){return this.get(j[2])},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enableCacheExpiration",{get:function(){return this.get(j[3])},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cacheExpirationIntervalMilliseconds",{get:function(){return this.get(j[4])},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"spfxContext",{get:function(){return this.get(j[5])},enumerable:!0,configurable:!0}),e}(),L=new D,k=function(){function e(e,t){void 0===t&&(t=-1),this.store=e,this.defaultTimeoutMinutes=t,this.enabled=this.test(),L.enableCacheExpiration&&this.cacheExpirationHandler()}return e.prototype.get=function(e){if(!this.enabled)return null;var t=this.store.getItem(e);if(!f(t))return null;var n=JSON.parse(t);return new Date(n.expiration)<=new Date?(this.delete(e),null):n.value},e.prototype.put=function(e,t,n){this.enabled&&this.store.setItem(e,this.createPersistable(t,n))},e.prototype.delete=function(e){this.enabled&&this.store.removeItem(e)},e.prototype.getOrPut=function(e,t,n){var r=this;return this.enabled?new Promise(function(o){var i=r.get(e);null==i?t().then(function(t){r.put(e,t,n),o(t)}):o(i)}):t()},e.prototype.deleteExpired=function(){var e=this;return new Promise(function(t,n){e.enabled||t();try{for(var r=0;r<e.store.length;r++){var o=e.store.key(r);null!==o&&/["|']?pnp["|']? ?: ?1/i.test(e.store.getItem(o))&&e.get(o)}t()}catch(e){n(e)}})},e.prototype.test=function(){try{return this.store.setItem("t","t"),this.store.removeItem("t"),!0}catch(e){return!1}},e.prototype.createPersistable=function(e,t){if(void 0===t){var n=L.defaultCachingTimeoutSeconds;this.defaultTimeoutMinutes>0&&(n=60*this.defaultTimeoutMinutes),t=u(new Date,"second",n)}return S({pnp:1,expiration:t,value:e})},e.prototype.cacheExpirationHandler=function(){var e=this;this.deleteExpired().then(function(t){setTimeout(s(e,e.cacheExpirationHandler),L.cacheExpirationIntervalMilliseconds)}).catch(function(e){console.error(e)})},e}(),U=function(){function e(e){void 0===e&&(e=new Map),this._store=e}return Object.defineProperty(e.prototype,"length",{get:function(){return this._store.size},enumerable:!0,configurable:!0}),e.prototype.clear=function(){this._store.clear()},e.prototype.getItem=function(e){return this._store.get(e)},e.prototype.key=function(e){return Array.from(this._store)[e][0]},e.prototype.removeItem=function(e){this._store.delete(e)},e.prototype.setItem=function(e,t){this._store.set(e,t)},e}(),F=function(){function e(e,t){void 0===e&&(e=null),void 0===t&&(t=null),this._local=e,this._session=t}return Object.defineProperty(e.prototype,"local",{get:function(){return null===this._local&&(this._local=this.getStore("local")),this._local},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"session",{get:function(){return null===this._session&&(this._session=this.getStore("session")),this._session},enumerable:!0,configurable:!0}),e.prototype.getStore=function(e){return new k("local"===e?"undefined"==typeof localStorage?new U:localStorage:"undefined"==typeof sessionStorage?new U:sessionStorage)},e}()}.call(this,n(5))},function(e,t,n){"use strict";n.d(t,"a",function(){return o});
/**
 * @license
 * v1.2.6
 * MIT (https://github.com/pnp/pnpjs/blob/master/LICENSE)
 * Copyright (c) 2018 Microsoft
 * docs: https://pnp.github.io/pnpjs/
 * source: https://github.com/pnp/pnpjs
 * bugs: https://github.com/pnp/pnpjs/issues
 */
var r,o=function(){function e(){}return Object.defineProperty(e,"activeLogLevel",{get:function(){return e.instance.activeLogLevel},set:function(t){e.instance.activeLogLevel=t},enumerable:!0,configurable:!0}),Object.defineProperty(e,"instance",{get:function(){return void 0!==e._instance&&null!==e._instance||(e._instance=new i),e._instance},enumerable:!0,configurable:!0}),e.subscribe=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];t.map(function(t){return e.instance.subscribe(t)})},e.clearSubscribers=function(){return e.instance.clearSubscribers()},Object.defineProperty(e,"count",{get:function(){return e.instance.count},enumerable:!0,configurable:!0}),e.write=function(t,n){void 0===n&&(n=1),e.instance.log({level:n,message:t})},e.writeJSON=function(e,t){void 0===t&&(t=1),this.write(JSON.stringify(e),t)},e.log=function(t){e.instance.log(t)},e.error=function(t){e.instance.log({data:t,level:3,message:t.message})},e}(),i=function(){function e(e,t){void 0===e&&(e=2),void 0===t&&(t=[]),this.activeLogLevel=e,this.subscribers=t}return e.prototype.subscribe=function(e){this.subscribers.push(e)},e.prototype.clearSubscribers=function(){var e=this.subscribers.slice(0);return this.subscribers.length=0,e},Object.defineProperty(e.prototype,"count",{get:function(){return this.subscribers.length},enumerable:!0,configurable:!0}),e.prototype.write=function(e,t){void 0===t&&(t=1),this.log({level:t,message:e})},e.prototype.log=function(e){void 0!==e&&this.activeLogLevel<=e.level&&this.subscribers.map(function(t){return t.log(e)})},e}();!function(e){e[e.Verbose=0]="Verbose",e[e.Info=1]="Info",e[e.Warning=2]="Warning",e[e.Error=3]="Error",e[e.Off=99]="Off"}(r||(r={}));(function(){function e(){}e.prototype.log=function(e){var t=this.format(e);switch(e.level){case 0:case 1:console.log(t);break;case 2:console.warn(t);break;case 3:console.error(t)}},e.prototype.format=function(e){var t=[];return t.push("Message: "+e.message),void 0!==e.data&&t.push(" Data: "+JSON.stringify(e.data)),t.join("")}})(),function(){function e(e){this.method=e}e.prototype.log=function(e){this.method(e)}}()},function(e,t,n){"use strict";(function(e){n.d(t,"c",function(){return r}),n.d(t,"d",function(){return o}),n.d(t,"f",function(){return i}),n.d(t,"e",function(){return a}),n.d(t,"a",function(){return u}),n.d(t,"b",function(){return c});var r="function",o="object",i="undefined",a="prototype",s="hasOwnProperty";function u(){return typeof globalThis!==i&&globalThis?globalThis:typeof self!==i&&self?self:typeof window!==i&&window?window:typeof e!==i&&e?e:null}function c(e){var t=Object.create;if(t)return t(e);if(null==e)return{};var n=typeof e;if(n!==o&&n!==r)throw new TypeError("Object prototype may only be an Object:"+e);function i(){}return i[a]=e,new i}var l=function(e,t){return(l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t[s](n)&&(e[n]=t[n])})(e,t)};var p=u()||{};!function(e,t,n){e.__assign||(e.__assign=Object.assign||t),e.__extends||(e.__extends=n)}(p,function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object[a][s].call(t,o)&&(e[o]=t[o]);return e},function(e,t){function n(){this.constructor=e}l(e,t),e[a]=null===t?c(t):(n[a]=t[a],new n)}),__assign||(__assign=p.__assign),__extends||(__extends=p.__extends)}).call(this,n(5))},function(e,t,n){"use strict";n.d(t,"c",function(){return i}),n.d(t,"d",function(){return a}),n.d(t,"h",function(){return p}),n.d(t,"g",function(){return d}),n.d(t,"k",function(){return f}),n.d(t,"a",function(){return h}),n.d(t,"e",function(){return y}),n.d(t,"b",function(){return g}),n.d(t,"j",function(){return I}),n.d(t,"i",function(){return C}),n.d(t,"f",function(){return w});var r=n(0),o=n(1),i=function(){function e(e){this.key=e,this.expiration=Object(r.dateAdd)(new Date,"second",r.RuntimeConfig.defaultCachingTimeoutSeconds),this.storeName=r.RuntimeConfig.defaultCachingStore}return Object.defineProperty(e.prototype,"store",{get:function(){return"local"===this.storeName?e.storage.local:e.storage.session},enumerable:!0,configurable:!0}),e.storage=new r.PnPClientStorage,e}(),a=function(){function e(e,t){this.parser=e,this.cacheOptions=t}return e.prototype.parse=function(e){var t=this;return this.parser.parse(e).then(function(e){return t.cacheData(e)})},e.prototype.cacheData=function(e){return null!==this.cacheOptions.store&&this.cacheOptions.store.put(this.cacheOptions.key,e,this.cacheOptions.expiration),e},e}(),s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function u(e,t){function n(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function c(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a}var l=function(e){function t(t,n,r,o){void 0===r&&(r=n.status),void 0===o&&(o=n.statusText);var i=e.call(this,t)||this;return i.response=n,i.status=r,i.statusText=o,i.isHttpRequestError=!0,i}return u(t,e),t.init=function(e){return e.clone().text().then(function(n){return new t("Error making HttpClient request in queryable ["+e.status+"] "+e.statusText+" ::> "+n,e.clone())})},t}(Error),p=function(){function e(){}return e.prototype.parse=function(e){var t=this;return new Promise(function(n,r){t.handleError(e,r)&&t.parseImpl(e,n,r)})},e.prototype.parseImpl=function(e,t,n){var r=this;e.headers.has("Content-Length")&&0===parseFloat(e.headers.get("Content-Length"))||204===e.status?t({}):e.text().then(function(e){return e.replace(/\s/gi,"").length>0?JSON.parse(e):{}}).then(function(e){return t(r.parseODataJSON(e))}).catch(function(e){return n(e)})},e.prototype.handleError=function(e,t){return e.ok||l.init(e).then(t),e.ok},e.prototype.parseODataJSON=function(e){var t=e;return Object(r.hOP)(e,"d")?t=Object(r.hOP)(e.d,"results")?e.d.results:e.d:Object(r.hOP)(e,"value")&&(t=e.value),t},e}(),d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return u(t,e),t}(p),f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return u(t,e),t.prototype.parseImpl=function(e,t){e.text().then(t)},t}(p),h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return u(t,e),t.prototype.parseImpl=function(e,t){e.blob().then(t)},t}(p),y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return u(t,e),t.prototype.parseImpl=function(e,t){e.json().then(t)},t}(p),g=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return u(t,e),t.prototype.parseImpl=function(e,t){Object(r.isFunc)(e.arrayBuffer)?e.arrayBuffer().then(t):e.buffer().then(t)},t}(p);!function(e){function t(t){var n=e.call(this)||this;return n.parser=t,n}u(t,e),t.prototype.parseImpl=function(e,t){this.parser(e).then(t)}}(p);function m(e,t){return new Promise(function(n){e.result=t,e.hasResult=!0,n(e)})}function v(e){return e.pipeline.length>0?e.pipeline.shift()(e):Promise.resolve(e)}function b(e){e.pipeline.length<1&&o.a.write("["+e.requestId+"] ("+(new Date).getTime()+") Request pipeline contains no methods!",2);var t=v(e).then(function(e){return function(e){return o.a.log({data:0===o.a.activeLogLevel?e.result:{},level:1,message:"["+e.requestId+"] ("+(new Date).getTime()+") Returning result from pipeline. Set logging to verbose to see data."}),Promise.resolve(e.result)}(e)}).catch(function(e){throw o.a.error(e),e});return e.isBatched&&e.batch.addResolveBatchDependency(t),t}function S(e){return void 0===e&&(e=!1),function(t,n,i){var a=i.value;i.value=function(){for(var i=[],s=0;s<arguments.length;s++)i[s]=arguments[s];return!e&&i.length>0&&Object(r.hOP)(i[0],"hasResult")&&i[0].hasResult?(o.a.write("["+i[0].requestId+"] ("+(new Date).getTime()+") Skipping request pipeline method "+n+", existing result in pipeline.",0),Promise.resolve(i[0])):(o.a.write("["+i[0].requestId+"] ("+(new Date).getTime()+") Calling request pipeline method "+n+".",0),a.apply(t,i).then(function(e){return v(e)}))}}}var _=function(){function e(){}return e.logStart=function(e){return new Promise(function(t){o.a.log({data:1===o.a.activeLogLevel?{}:e,level:1,message:"["+e.requestId+"] ("+(new Date).getTime()+") Beginning "+e.verb+" request ("+e.requestAbsoluteUrl+")"}),t(e)})},e.caching=function(e){return new Promise(function(t){if(e.isCached){o.a.write("["+e.requestId+"] ("+(new Date).getTime()+") Caching is enabled for request, checking cache...",1);var n=new i(e.requestAbsoluteUrl.toLowerCase());if(void 0!==e.cachingOptions&&(n=Object(r.extend)(n,e.cachingOptions)),null!==n.store){var s=n.store.get(n.key);if(null!==s)return o.a.log({data:1===o.a.activeLogLevel?{}:s,level:1,message:"["+e.requestId+"] ("+(new Date).getTime()+") Value returned from cache."}),Object(r.isFunc)(e.batchDependency)&&e.batchDependency(),Object(r.hOP)(e.parser,"hydrate")&&(s=e.parser.hydrate(s)),m(e,s).then(function(e){return t(e)})}o.a.write("["+e.requestId+"] ("+(new Date).getTime()+") Value not found in cache.",1),e.parser=new a(e.parser,n)}return t(e)})},e.send=function(e){return new Promise(function(t,n){if(e.isBatched){var i=e.batch.add(e.requestAbsoluteUrl,e.verb,e.options,e.parser,e.requestId);Object(r.isFunc)(e.batchDependency)&&e.batchDependency(),o.a.write("["+e.requestId+"] ("+(new Date).getTime()+") Batching request in batch "+e.batch.batchId+".",1),t(m(e,i))}else{o.a.write("["+e.requestId+"] ("+(new Date).getTime()+") Sending request.",1);var a=e.clientFactory(),s=Object(r.extend)(e.options||{},{method:e.verb});a.fetch(e.requestAbsoluteUrl,s).then(function(t){return e.parser.parse(t)}).then(function(t){return m(e,t)}).then(function(e){return t(e)}).catch(function(e){return n(e)})}})},e.logEnd=function(e){return new Promise(function(t){e.isBatched?o.a.log({data:1===o.a.activeLogLevel?{}:e,level:1,message:"["+e.requestId+"] ("+(new Date).getTime()+") "+e.verb+" request will complete in batch "+e.batch.batchId+"."}):o.a.log({data:1===o.a.activeLogLevel?{}:e,level:1,message:"["+e.requestId+"] ("+(new Date).getTime()+") Completing "+e.verb+" request."}),t(e)})},c([S(!0)],e,"logStart",null),c([S()],e,"caching",null),c([S()],e,"send",null),c([S(!0)],e,"logEnd",null),e}();function T(){return[_.logStart,_.caching,_.send,_.logEnd].slice(0)}var I=function(){function e(){this._query=new Map,this._options={},this._url="",this._parentUrl="",this._useCaching=!1,this._cachingOptions=null,this._cloneParentWasCaching=!1,this._cloneParentCacheOptions=null}return e.prototype.toUrl=function(){return this._url},e.prototype.concat=function(e){return this._url+=e,this},Object.defineProperty(e.prototype,"query",{get:function(){return this._query},enumerable:!0,configurable:!0}),e.prototype.configure=function(e){return Object(r.mergeOptions)(this._options,e),this},e.prototype.configureFrom=function(e){return Object(r.mergeOptions)(this._options,e._options),this},e.prototype.usingCaching=function(e){return r.RuntimeConfig.globalCacheDisable||(this._useCaching=!0,void 0!==e&&(this._cachingOptions=e)),this},e.prototype.getCore=function(e,t){return void 0===e&&(e=new y),void 0===t&&(t={}),this._cloneParentWasCaching&&this.usingCaching(this._cloneParentCacheOptions),this.toRequestContext("GET",t,e,T()).then(function(e){return b(e)})},e.prototype.postCore=function(e,t){return void 0===e&&(e={}),void 0===t&&(t=new y),this.toRequestContext("POST",e,t,T()).then(function(e){return b(e)})},e.prototype.patchCore=function(e,t){return void 0===e&&(e={}),void 0===t&&(t=new y),this.toRequestContext("PATCH",e,t,T()).then(function(e){return b(e)})},e.prototype.deleteCore=function(e,t){return void 0===e&&(e={}),void 0===t&&(t=new y),this.toRequestContext("DELETE",e,t,T()).then(function(e){return b(e)})},e.prototype.putCore=function(e,t){return void 0===e&&(e={}),void 0===t&&(t=new y),this.toRequestContext("PUT",e,t,T()).then(function(e){return b(e)})},e.prototype.append=function(e){this._url=Object(r.combine)(this._url,e)},Object.defineProperty(e.prototype,"parentUrl",{get:function(){return this._parentUrl},enumerable:!0,configurable:!0}),e.prototype.extend=function(e,t){this._parentUrl=e._url,this._url=Object(r.combine)(this._parentUrl,t||""),this.configureFrom(e)},e.prototype._clone=function(e,t){return e.configureFrom(this),this._useCaching&&(e._cloneParentWasCaching=!0,e._cloneParentCacheOptions=this._cachingOptions),e},e}(),C=function(e){function t(){var t=e.call(this)||this;return t._batch=null,t}return u(t,e),t.prototype.inBatch=function(e){if(null!==this.batch)throw Error("This query is already part of a batch.");return this._batch=e,this},t.prototype.toUrl=function(){return this._url},t.prototype.get=function(e,t){return void 0===e&&(e=new d),void 0===t&&(t={}),this.getCore(e,t)},t.prototype.getCore=function(t,n){return void 0===t&&(t=new d),void 0===n&&(n={}),e.prototype.getCore.call(this,t,n)},t.prototype.postCore=function(t,n){return void 0===t&&(t={}),void 0===n&&(n=new d),e.prototype.postCore.call(this,t,n)},t.prototype.patchCore=function(t,n){return void 0===t&&(t={}),void 0===n&&(n=new d),e.prototype.patchCore.call(this,t,n)},t.prototype.deleteCore=function(t,n){return void 0===t&&(t={}),void 0===n&&(n=new d),e.prototype.deleteCore.call(this,t,n)},t.prototype.putCore=function(t,n){return void 0===t&&(t={}),void 0===n&&(n=new d),e.prototype.putCore.call(this,t,n)},t.prototype.addBatchDependency=function(){return null!==this._batch?this._batch.addDependency():function(){return null}},Object.defineProperty(t.prototype,"hasBatch",{get:function(){return Object(r.objectDefinedNotNull)(this._batch)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"batch",{get:function(){return this.hasBatch?this._batch:null},enumerable:!0,configurable:!0}),t.prototype._clone=function(t,n){return t=e.prototype._clone.call(this,t,n),n.includeBatch&&(t=t.inBatch(this._batch)),t},t}(I),w=function(){function e(e){void 0===e&&(e=Object(r.getGUID)()),this._batchId=e,this._reqs=[],this._deps=[],this._rDeps=[]}return Object.defineProperty(e.prototype,"batchId",{get:function(){return this._batchId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"requests",{get:function(){return this._reqs},enumerable:!0,configurable:!0}),e.prototype.add=function(e,t,n,r,o){var i={id:o,method:t.toUpperCase(),options:n,parser:r,reject:null,resolve:null,url:e},a=new Promise(function(e,t){i.resolve=e,i.reject=t});return this._reqs.push(i),a},e.prototype.addDependency=function(){var e=function(){};return this._deps.push(new Promise(function(t){e=t})),e},e.prototype.addResolveBatchDependency=function(e){this._rDeps.push(e)},e.prototype.execute=function(){var e=this;return Promise.all(this._deps).then(function(){return Promise.all(e._deps)}).then(function(){return e.executeImpl()}).then(function(){return Promise.all(e._rDeps)}).then(function(){})},e}()},function(e,t,n){"use strict";n.r(t),function(e){n.d(t,"odataUrlFrom",function(){return d}),n.d(t,"spODataEntity",function(){return y}),n.d(t,"spODataEntityArray",function(){return g}),n.d(t,"SharePointQueryable",function(){return w}),n.d(t,"SharePointQueryableInstance",function(){return P}),n.d(t,"SharePointQueryableCollection",function(){return O}),n.d(t,"SharePointQueryableSecurable",function(){return pe}),n.d(t,"FileFolderShared",function(){return ye}),n.d(t,"SharePointQueryableShareable",function(){return de}),n.d(t,"SharePointQueryableShareableFile",function(){return ge}),n.d(t,"SharePointQueryableShareableFolder",function(){return me}),n.d(t,"SharePointQueryableShareableItem",function(){return he}),n.d(t,"SharePointQueryableShareableWeb",function(){return fe}),n.d(t,"AppCatalog",function(){return ot}),n.d(t,"App",function(){return it}),n.d(t,"SPBatch",function(){return at}),n.d(t,"ContentType",function(){return we}),n.d(t,"ContentTypes",function(){return Ce}),n.d(t,"FieldLink",function(){return Pe}),n.d(t,"FieldLinks",function(){return Oe}),n.d(t,"Field",function(){return je}),n.d(t,"Fields",function(){return Me}),n.d(t,"CheckinType",function(){return se}),n.d(t,"WebPartsPersonalizationScope",function(){return ue}),n.d(t,"MoveOperations",function(){return ce}),n.d(t,"TemplateFileType",function(){return le}),n.d(t,"File",function(){return et}),n.d(t,"Files",function(){return Ze}),n.d(t,"Folder",function(){return Ie}),n.d(t,"Folders",function(){return Te}),n.d(t,"SPHttpClient",function(){return _}),n.d(t,"Item",function(){return ze}),n.d(t,"Items",function(){return Ke}),n.d(t,"ItemVersion",function(){return Qe}),n.d(t,"ItemVersions",function(){return $e}),n.d(t,"PagedItemCollection",function(){return Xe}),n.d(t,"NavigationNodes",function(){return vt}),n.d(t,"NavigationNode",function(){return bt}),n.d(t,"NavigationService",function(){return _t}),n.d(t,"List",function(){return qe}),n.d(t,"Lists",function(){return Ge}),n.d(t,"RegionalSettings",function(){return Tt}),n.d(t,"InstalledLanguages",function(){return It}),n.d(t,"TimeZone",function(){return Ct}),n.d(t,"TimeZones",function(){return wt}),n.d(t,"sp",function(){return rn}),n.d(t,"SPRest",function(){return nn}),n.d(t,"RoleDefinitionBindings",function(){return ae}),n.d(t,"Search",function(){return Mt}),n.d(t,"SearchQueryBuilder",function(){return xt}),n.d(t,"SearchResults",function(){return jt}),n.d(t,"SortDirection",function(){return Nt}),n.d(t,"ReorderingRuleMatchType",function(){return At}),n.d(t,"QueryPropertyValueType",function(){return Rt}),n.d(t,"SearchBuiltInSourceId",function(){return Ft}),n.d(t,"SearchSuggest",function(){return Bt}),n.d(t,"Site",function(){return zt}),n.d(t,"UserProfileQuery",function(){return $t}),n.d(t,"toAbsoluteUrl",function(){return I}),n.d(t,"extractWebUrl",function(){return p}),n.d(t,"UtilityMethod",function(){return tn}),n.d(t,"View",function(){return Ae}),n.d(t,"Views",function(){return Ne}),n.d(t,"ViewFields",function(){return Re}),n.d(t,"WebPartDefinitions",function(){return be}),n.d(t,"WebPartDefinition",function(){return Se}),n.d(t,"WebPart",function(){return _e}),n.d(t,"Web",function(){return Kt}),n.d(t,"SiteScripts",function(){return Zt}),n.d(t,"SiteDesigns",function(){return en}),n.d(t,"PromotedState",function(){return rt}),n.d(t,"ClientSidePage",function(){return pt}),n.d(t,"CanvasSection",function(){return dt}),n.d(t,"CanvasControl",function(){return ft}),n.d(t,"CanvasColumn",function(){return ht}),n.d(t,"ClientSidePart",function(){return yt}),n.d(t,"ClientSideText",function(){return gt}),n.d(t,"ClientSideWebpart",function(){return mt}),n.d(t,"Comments",function(){return He}),n.d(t,"Comment",function(){return Ve}),n.d(t,"Replies",function(){return We}),n.d(t,"SocialQuery",function(){return Yt}),n.d(t,"MySocialQuery",function(){return Jt}),n.d(t,"SocialActorType",function(){return Dt}),n.d(t,"SocialActorTypes",function(){return Lt}),n.d(t,"SocialFollowResult",function(){return kt}),n.d(t,"SocialStatusCode",function(){return Ut}),n.d(t,"ControlMode",function(){return j}),n.d(t,"FieldTypes",function(){return D}),n.d(t,"DateTimeFieldFormatType",function(){return L}),n.d(t,"AddFieldOptions",function(){return k}),n.d(t,"CalendarType",function(){return U}),n.d(t,"UrlFieldFormatType",function(){return F}),n.d(t,"PermissionKind",function(){return B}),n.d(t,"PrincipalType",function(){return G}),n.d(t,"PrincipalSource",function(){return q}),n.d(t,"RoleType",function(){return H}),n.d(t,"PageType",function(){return V}),n.d(t,"SharingLinkKind",function(){return W}),n.d(t,"SharingRole",function(){return K}),n.d(t,"SharingOperationStatusCode",function(){return z}),n.d(t,"SPSharedObjectType",function(){return $}),n.d(t,"SharingDomainRestrictionMode",function(){return Q}),n.d(t,"RenderListDataOptions",function(){return X}),n.d(t,"FieldUserSelectionMode",function(){return Y}),n.d(t,"ChoiceFieldFormatType",function(){return J}),n.d(t,"UrlZone",function(){return Z});var r=n(0),o=n(1),i=n(3),a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function s(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function u(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a}function c(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(a,s)}u((r=r.apply(e,t||[])).next())})}function l(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}function p(e){if(Object(r.stringIsNullOrEmpty)(e))return"";var t=e.indexOf("_api/");return t<0&&(t=e.indexOf("_vti_bin/")),t>-1?e.substr(0,t):e}function d(e){var t=[],n=["odata.type","odata.editLink","__metadata","odata.metadata"];return Object(r.hOP)(e,n[0])&&"SP.Web"===e[n[0]]?Object(r.hOP)(e,n[1])?t.push(e[n[1]]):Object(r.hOP)(e,n[2])&&t.push(e.__metadata.uri):Object(r.hOP)(e,n[3])&&Object(r.hOP)(e,n[1])?t.push(p(e[n[3]]),"_api",e[n[1]]):Object(r.hOP)(e,n[1])?t.push("_api",e[n[1]]):Object(r.hOP)(e,n[2])&&t.push(e.__metadata.uri),t.length<1?(o.a.write("No uri information found in ODataEntity parsing, chaining will fail for this object.",2),""):r.combine.apply(void 0,t)}var f=function(e){function t(t){var n=e.call(this)||this;return n.factory=t,n.hydrate=function(e){var t=new n.factory(d(e),null);return Object(r.extend)(t,e)},n}return s(t,e),t.prototype.parse=function(t){var n=this;return e.prototype.parse.call(this,t).then(function(e){var t=new n.factory(d(e),null);return Object(r.extend)(t,e)})},t}(i.h),h=function(e){function t(t){var n=e.call(this)||this;return n.factory=t,n.hydrate=function(e){return e.map(function(e){var t=new n.factory(d(e),null);return Object(r.extend)(t,e)})},n}return s(t,e),t.prototype.parse=function(t){var n=this;return e.prototype.parse.call(this,t).then(function(e){return e.map(function(e){var t=new n.factory(d(e),null);return Object(r.extend)(t,e)})})},t}(i.h);function y(e){return new f(e)}function g(e){return new h(e)}var m=new(function(){function e(){}return Object.defineProperty(e.prototype,"headers",{get:function(){var e=r.RuntimeConfig.get("sp");return void 0!==e&&void 0!==e.headers?e.headers:{}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"baseUrl",{get:function(){var e=r.RuntimeConfig.get("sp");return void 0!==e&&void 0!==e.baseUrl?e.baseUrl:void 0!==r.RuntimeConfig.spfxContext&&null!==r.RuntimeConfig.spfxContext?r.RuntimeConfig.spfxContext.pageContext.web.absoluteUrl:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fetchClientFactory",{get:function(){var e=r.RuntimeConfig.get("sp");return void 0!==e&&void 0!==e.fetchClientFactory?e.fetchClientFactory:function(){return new r.FetchClient}},enumerable:!0,configurable:!0}),e}()),v=function(){return function(){}}(),b=new Map,S=function(){function e(e,t){void 0===t&&(t=b),this._httpClient=e,this._digests=t}return e.prototype.getDigest=function(e){var t=this,n=this._digests.get(e);if(void 0!==n&&new Date<n.expiration)return Promise.resolve(n.value);var o=Object(r.combine)(e,"/_api/contextinfo");return this._httpClient.fetchRaw(o,{cache:"no-cache",credentials:"same-origin",headers:Object(r.extend)({Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose;charset=utf-8"},m.headers,!0),method:"POST"}).then(function(e){return(new i.g).parse(e).then(function(e){return e.GetContextWebInformation})}).then(function(n){var r=new v;r.value=n.FormDigestValue;var o=n.FormDigestTimeoutSeconds,i=new Date;return i.setTime(i.getTime()+1e3*o),r.expiration=i,t._digests.set(e,r),r.value})},e.prototype.clear=function(){this._digests.clear()},e}(),_=function(){function e(e){void 0===e&&(e=m.fetchClientFactory()),this._impl=e,this._digestCache=new S(this)}return e.prototype.fetch=function(e,t){var n=this;void 0===t&&(t={});var o=Object(r.extend)(t,{cache:"no-cache",credentials:"same-origin"},!0),i=new Headers;return Object(r.mergeHeaders)(i,m.headers),Object(r.mergeHeaders)(i,t.headers),i.has("Accept")||i.append("Accept","application/json"),i.has("Content-Type")||i.append("Content-Type","application/json;odata=verbose;charset=utf-8"),i.has("X-ClientService-ClientTag")||i.append("X-ClientService-ClientTag","PnPCoreJS:@pnp-1.2.6"),i.has("User-Agent")||i.append("User-Agent","NONISV|SharePointPnP|PnPCoreJS/1.2.6"),!(o=Object(r.extend)(o,{headers:i})).method||"GET"===o.method.toUpperCase()||i.has("X-RequestDigest")||i.has("Authorization")?this.fetchRaw(e,o):this._digestCache.getDigest(p(e)).then(function(t){return i.append("X-RequestDigest",t),n.fetchRaw(e,o)})},e.prototype.fetchRaw=function(e,t){var n=this;void 0===t&&(t={});var o=new Headers;Object(r.mergeHeaders)(o,t.headers),t=Object(r.extend)(t,{headers:o});var i=function(o){var a=function(e){var t;e.headers.has("Retry-After")?t=parseInt(e.headers.get("Retry-After"),10):(t=o.delay,o.delay*=2),o.attempts++,o.retryCount<=o.attempts?o.reject(Error("Retry count exceeded ("+o.retryCount+") for request. Response status: ["+e.status+"] "+e.statusText)):setTimeout(Object(r.getCtxCallback)(n,i,o),t)};n._impl.fetch(e,t).then(function(e){429===e.status?a(e):o.resolve(e)}).catch(function(e){503===e.status?a(e):o.reject(e)})};return new Promise(function(e,t){var r={attempts:0,delay:100,reject:t,resolve:e,retryCount:7};i.call(n,r)})},e.prototype.get=function(e,t){void 0===t&&(t={});var n=Object(r.extend)(t,{method:"GET"});return this.fetch(e,n)},e.prototype.post=function(e,t){void 0===t&&(t={});var n=Object(r.extend)(t,{method:"POST"});return this.fetch(e,n)},e.prototype.patch=function(e,t){void 0===t&&(t={});var n=Object(r.extend)(t,{method:"PATCH"});return this.fetch(e,n)},e.prototype.delete=function(e,t){void 0===t&&(t={});var n=Object(r.extend)(t,{method:"DELETE"});return this.fetch(e,n)},e}(),T=void 0!==e?e:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{};function I(e){return new Promise(function(t){if(Object(r.isUrlAbsolute)(e))return t(e);if(null!==m.baseUrl)return t(Object(r.combine)(m.baseUrl,e));if(void 0!==T._spPageContextInfo){if(Object(r.hOP)(T._spPageContextInfo,"webAbsoluteUrl"))return t(Object(r.combine)(T._spPageContextInfo.webAbsoluteUrl,e));if(Object(r.hOP)(T._spPageContextInfo,"webServerRelativeUrl"))return t(Object(r.combine)(T._spPageContextInfo.webServerRelativeUrl,e))}if(void 0!==T.location){var n=T.location.toString().toLowerCase();["/_layouts/","/siteassets/"].forEach(function(o){var i=n.indexOf(o);if(i>0)return t(Object(r.combine)(n.substr(0,i),e))})}return t(e)})}function C(e){return{__metadata:{type:e}}}var w=function(e){function t(t,n){var o=e.call(this)||this;if(o._forceCaching=!1,"string"==typeof t)if(Object(r.isUrlAbsolute)(t)||t.lastIndexOf("/")<0)o._parentUrl=t,o._url=Object(r.combine)(t,n);else if(t.lastIndexOf("/")>t.lastIndexOf("(")){var i=t.lastIndexOf("/");o._parentUrl=t.slice(0,i),n=Object(r.combine)(t.slice(i),n),o._url=Object(r.combine)(o._parentUrl,n)}else{i=t.lastIndexOf("(");o._parentUrl=t.slice(0,i),o._url=Object(r.combine)(t,n)}else{o.extend(t,n);var a=t.query.get("@target");void 0!==a&&o.query.set("@target",a)}return o}return s(t,e),t.prototype.as=function(e){var t=new e(this._url,null);return Object(r.extend)(t,this,!0)},t.prototype.toUrlAndQuery=function(){var e=new Map(this.query),t=this.toUrl().replace(/'!(@.*?)::(.*?)'/gi,function(t,n,r){return o.a.write("Rewriting aliased parameter from match "+t+" to label: "+n+" value: "+r,0),e.set(n,"'"+r+"'"),n});e.size>0&&(t+=""+(t.indexOf("?")>-1?"&":"?")+Array.from(e).map(function(e){return e[0]+"="+e[1]}).join("&"));return t},t.prototype.select=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.length>0&&this.query.set("$select",e.join(",")),this},t.prototype.expand=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.length>0&&this.query.set("$expand",e.join(",")),this},t.prototype.getParent=function(e,t,n,r){void 0===t&&(t=this.parentUrl);var o=new e(t,n).configureFrom(this),i="@target";return this.query.has(i)&&o.query.set(i,this.query.get(i)),void 0!==r&&(o=o.inBatch(r)),o},t.prototype.clone=function(t,n,r){void 0===r&&(r=!0);var o=e.prototype._clone.call(this,new t(this,n),{includeBatch:r}),i="@target";return this.query.has(i)&&o.query.set(i,this.query.get(i)),o},t.prototype.toRequestContext=function(e,t,n,o){var i=this;void 0===t&&(t={});var a=this.hasBatch?this.addBatchDependency():function(){};return I(this.toUrlAndQuery()).then(function(s){return Object(r.mergeOptions)(t,i._options),{batch:i.batch,batchDependency:a,cachingOptions:i._cachingOptions,clientFactory:function(){return new _},isBatched:i.hasBatch,isCached:i._forceCaching||i._useCaching&&/^get$/i.test(e),options:t,parser:n,pipeline:o,requestAbsoluteUrl:s,requestId:Object(r.getGUID)(),verb:e}})},t}(i.i),O=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t.prototype.filter=function(e){return this.query.set("$filter",e),this},t.prototype.orderBy=function(e,t){void 0===t&&(t=!0);var n="$orderby",r=this.query.has(n)?this.query.get(n).split(","):[];return r.push(e+" "+(t?"asc":"desc")),this.query.set(n,r.join(",")),this},t.prototype.skip=function(e){return this.query.set("$skip",e.toString()),this},t.prototype.top=function(e){return this.query.set("$top",e.toString()),this},t}(w),P=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t.prototype._update=function(e,t){var n=this;return function(o){return n.postCore({body:Object(r.jsS)(Object(r.extend)(C(e),o)),headers:{"X-HTTP-Method":"MERGE"}}).then(function(e){return t(e,o)})}},t.prototype._delete=function(){return this.postCore({headers:{"X-HTTP-Method":"DELETE"}})},t.prototype._deleteWithETag=function(e){return void 0===e&&(e="*"),this.postCore({headers:{"IF-Match":e,"X-HTTP-Method":"DELETE"}})},t}(w);function E(e){return function(t){return function(t){function n(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return t.call(this,n[0],n.length>1&&void 0!==n[1]?n[1]:e)||this}return s(n,t),n}(t)}}var x,N=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return s(t,e),n=t,t.prototype.getById=function(e){return new R(this,"getById("+e+")")},t.prototype.getByEmail=function(e){return new R(this,"getByEmail('"+e+"')")},t.prototype.getByLoginName=function(e){var t=new R(this);return t.concat("('!@v::"+encodeURIComponent(e)+"')"),t},t.prototype.removeById=function(e){return this.clone(n,"removeById("+e+")").postCore()},t.prototype.removeByLoginName=function(e){var t=this.clone(n,"removeByLoginName(@v)");return t.query.set("@v","'"+encodeURIComponent(e)+"'"),t.postCore()},t.prototype.add=function(e){var t=this;return this.clone(n,null).postCore({body:Object(r.jsS)(Object(r.extend)(C("SP.User"),{LoginName:e}))}).then(function(){return t.getByLoginName(e)})},t=n=u([E("siteusers")],t)}(O),A=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),Object.defineProperty(t.prototype,"groups",{get:function(){return new ee(this,"groups")},enumerable:!0,configurable:!0}),t}(P),R=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.update=t._update("SP.User",function(e){return{data:e,user:t}}),t.delete=t._delete,t}return s(t,e),t}(A),M=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t=u([E("currentuser")],t)}(A);!function(e){e[e.None=0]="None",e[e.User=1]="User",e[e.DistributionList=2]="DistributionList",e[e.SecurityGroup=4]="SecurityGroup",e[e.SharePointGroup=8]="SharePointGroup",e[e.All=15]="All"}(x||(x={}));var j,D,L,k,U,F,B,G,q,H,V,W,K,z,$,Q,X,Y,J,Z,ee=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return s(t,e),n=t,t.prototype.getById=function(e){var t=new te(this);return t.concat("("+e+")"),t},t.prototype.add=function(e){var t=this,n=Object(r.jsS)(Object(r.extend)(C("SP.Group"),e));return this.postCore({body:n}).then(function(e){return{data:e,group:t.getById(e.Id)}})},t.prototype.getByName=function(e){return new te(this,"getByName('"+e+"')")},t.prototype.removeById=function(e){return this.clone(n,"removeById('"+e+"')").postCore()},t.prototype.removeByLoginName=function(e){return this.clone(n,"removeByLoginName('"+e+"')").postCore()},t=n=u([E("sitegroups")],t)}(O),te=function(e){function t(){var n=null!==e&&e.apply(this,arguments)||this;return n.update=n._update("SP.Group",function(e,o){var i=n;return Object(r.hOP)(o,"Title")&&(i=n.getParent(t,n.parentUrl,"getByName('"+o.Title+"')")),{data:e,group:i}}),n}return s(t,e),Object.defineProperty(t.prototype,"users",{get:function(){return new N(this,"users")},enumerable:!0,configurable:!0}),t}(P),ne=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return s(t,e),n=t,t.prototype.getById=function(e){var t=new re(this);return t.concat("("+e+")"),t},t.prototype.add=function(e,t){return this.clone(n,"addroleassignment(principalid="+e+", roledefid="+t+")").postCore()},t.prototype.remove=function(e,t){return this.clone(n,"removeroleassignment(principalid="+e+", roledefid="+t+")").postCore()},t=n=u([E("roleassignments")],t)}(O),re=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.delete=t._delete,t}return s(t,e),Object.defineProperty(t.prototype,"groups",{get:function(){return new ee(this,"groups")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bindings",{get:function(){return new ae(this)},enumerable:!0,configurable:!0}),t}(P),oe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t.prototype.getById=function(e){return new ie(this,"getById("+e+")")},t.prototype.getByName=function(e){return new ie(this,"getbyname('"+e+"')")},t.prototype.getByType=function(e){return new ie(this,"getbytype("+e+")")},t.prototype.add=function(e,t,n,o){var i=this,a=Object(r.jsS)({BasePermissions:Object(r.extend)({__metadata:{type:"SP.BasePermissions"}},o),Description:t,Name:e,Order:n,__metadata:{type:"SP.RoleDefinition"}});return this.postCore({body:a}).then(function(e){return{data:e,definition:i.getById(e.Id)}})},t=u([E("roledefinitions")],t)}(O),ie=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.delete=t._delete,t}return s(t,e),t.prototype.update=function(e){var t=this,n=["BasePermissions"];void 0!==Object(r.hOP)(e,n[0])&&(e[n[0]]=Object(r.extend)({__metadata:{type:"SP."+n[0]}},e[n[0]]));var o=Object(r.jsS)(Object(r.extend)(C("SP.RoleDefinition"),e));return this.postCore({body:o,headers:{"X-HTTP-Method":"MERGE"}}).then(function(n){var o=t;Object(r.hOP)(e,"Name")&&(o=t.getParent(oe,t.parentUrl,"").getByName(e.Name));return{data:n,definition:o}})},t}(P),ae=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t=u([E("roledefinitionbindings")],t)}(O);!function(e){e[e.Display=1]="Display",e[e.Edit=2]="Edit",e[e.New=3]="New"}(j||(j={})),function(e){e[e.Invalid=0]="Invalid",e[e.Integer=1]="Integer",e[e.Text=2]="Text",e[e.Note=3]="Note",e[e.DateTime=4]="DateTime",e[e.Counter=5]="Counter",e[e.Choice=6]="Choice",e[e.Lookup=7]="Lookup",e[e.Boolean=8]="Boolean",e[e.Number=9]="Number",e[e.Currency=10]="Currency",e[e.URL=11]="URL",e[e.Computed=12]="Computed",e[e.Threading=13]="Threading",e[e.Guid=14]="Guid",e[e.MultiChoice=15]="MultiChoice",e[e.GridChoice=16]="GridChoice",e[e.Calculated=17]="Calculated",e[e.File=18]="File",e[e.Attachments=19]="Attachments",e[e.User=20]="User",e[e.Recurrence=21]="Recurrence",e[e.CrossProjectLink=22]="CrossProjectLink",e[e.ModStat=23]="ModStat",e[e.Error=24]="Error",e[e.ContentTypeId=25]="ContentTypeId",e[e.PageSeparator=26]="PageSeparator",e[e.ThreadIndex=27]="ThreadIndex",e[e.WorkflowStatus=28]="WorkflowStatus",e[e.AllDayEvent=29]="AllDayEvent",e[e.WorkflowEventType=30]="WorkflowEventType"}(D||(D={})),function(e){e[e.DateOnly=0]="DateOnly",e[e.DateTime=1]="DateTime"}(L||(L={})),function(e){e[e.DefaultValue=0]="DefaultValue",e[e.AddToDefaultContentType=1]="AddToDefaultContentType",e[e.AddToNoContentType=2]="AddToNoContentType",e[e.AddToAllContentTypes=4]="AddToAllContentTypes",e[e.AddFieldInternalNameHint=8]="AddFieldInternalNameHint",e[e.AddFieldToDefaultView=16]="AddFieldToDefaultView",e[e.AddFieldCheckDisplayName=32]="AddFieldCheckDisplayName"}(k||(k={})),function(e){e[e.Gregorian=1]="Gregorian",e[e.Japan=3]="Japan",e[e.Taiwan=4]="Taiwan",e[e.Korea=5]="Korea",e[e.Hijri=6]="Hijri",e[e.Thai=7]="Thai",e[e.Hebrew=8]="Hebrew",e[e.GregorianMEFrench=9]="GregorianMEFrench",e[e.GregorianArabic=10]="GregorianArabic",e[e.GregorianXLITEnglish=11]="GregorianXLITEnglish",e[e.GregorianXLITFrench=12]="GregorianXLITFrench",e[e.KoreaJapanLunar=14]="KoreaJapanLunar",e[e.ChineseLunar=15]="ChineseLunar",e[e.SakaEra=16]="SakaEra",e[e.UmAlQura=23]="UmAlQura"}(U||(U={})),function(e){e[e.Hyperlink=0]="Hyperlink",e[e.Image=1]="Image"}(F||(F={})),function(e){e[e.EmptyMask=0]="EmptyMask",e[e.ViewListItems=1]="ViewListItems",e[e.AddListItems=2]="AddListItems",e[e.EditListItems=3]="EditListItems",e[e.DeleteListItems=4]="DeleteListItems",e[e.ApproveItems=5]="ApproveItems",e[e.OpenItems=6]="OpenItems",e[e.ViewVersions=7]="ViewVersions",e[e.DeleteVersions=8]="DeleteVersions",e[e.CancelCheckout=9]="CancelCheckout",e[e.ManagePersonalViews=10]="ManagePersonalViews",e[e.ManageLists=12]="ManageLists",e[e.ViewFormPages=13]="ViewFormPages",e[e.AnonymousSearchAccessList=14]="AnonymousSearchAccessList",e[e.Open=17]="Open",e[e.ViewPages=18]="ViewPages",e[e.AddAndCustomizePages=19]="AddAndCustomizePages",e[e.ApplyThemeAndBorder=20]="ApplyThemeAndBorder",e[e.ApplyStyleSheets=21]="ApplyStyleSheets",e[e.ViewUsageData=22]="ViewUsageData",e[e.CreateSSCSite=23]="CreateSSCSite",e[e.ManageSubwebs=24]="ManageSubwebs",e[e.CreateGroups=25]="CreateGroups",e[e.ManagePermissions=26]="ManagePermissions",e[e.BrowseDirectories=27]="BrowseDirectories",e[e.BrowseUserInfo=28]="BrowseUserInfo",e[e.AddDelPrivateWebParts=29]="AddDelPrivateWebParts",e[e.UpdatePersonalWebParts=30]="UpdatePersonalWebParts",e[e.ManageWeb=31]="ManageWeb",e[e.AnonymousSearchAccessWebLists=32]="AnonymousSearchAccessWebLists",e[e.UseClientIntegration=37]="UseClientIntegration",e[e.UseRemoteAPIs=38]="UseRemoteAPIs",e[e.ManageAlerts=39]="ManageAlerts",e[e.CreateAlerts=40]="CreateAlerts",e[e.EditMyUserInfo=41]="EditMyUserInfo",e[e.EnumeratePermissions=63]="EnumeratePermissions",e[e.FullMask=65]="FullMask"}(B||(B={})),function(e){e[e.None=0]="None",e[e.User=1]="User",e[e.DistributionList=2]="DistributionList",e[e.SecurityGroup=4]="SecurityGroup",e[e.SharePointGroup=8]="SharePointGroup",e[e.All=15]="All"}(G||(G={})),function(e){e[e.None=0]="None",e[e.UserInfoList=1]="UserInfoList",e[e.Windows=2]="Windows",e[e.MembershipProvider=4]="MembershipProvider",e[e.RoleProvider=8]="RoleProvider",e[e.All=15]="All"}(q||(q={})),function(e){e[e.None=0]="None",e[e.Guest=1]="Guest",e[e.Reader=2]="Reader",e[e.Contributor=3]="Contributor",e[e.WebDesigner=4]="WebDesigner",e[e.Administrator=5]="Administrator"}(H||(H={})),function(e){e[e.Invalid=-1]="Invalid",e[e.DefaultView=0]="DefaultView",e[e.NormalView=1]="NormalView",e[e.DialogView=2]="DialogView",e[e.View=3]="View",e[e.DisplayForm=4]="DisplayForm",e[e.DisplayFormDialog=5]="DisplayFormDialog",e[e.EditForm=6]="EditForm",e[e.EditFormDialog=7]="EditFormDialog",e[e.NewForm=8]="NewForm",e[e.NewFormDialog=9]="NewFormDialog",e[e.SolutionForm=10]="SolutionForm",e[e.PAGE_MAXITEMS=11]="PAGE_MAXITEMS"}(V||(V={})),function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Direct=1]="Direct",e[e.OrganizationView=2]="OrganizationView",e[e.OrganizationEdit=3]="OrganizationEdit",e[e.AnonymousView=4]="AnonymousView",e[e.AnonymousEdit=5]="AnonymousEdit",e[e.Flexible=6]="Flexible"}(W||(W={})),function(e){e[e.None=0]="None",e[e.View=1]="View",e[e.Edit=2]="Edit",e[e.Owner=3]="Owner"}(K||(K={})),function(e){e[e.CompletedSuccessfully=0]="CompletedSuccessfully",e[e.AccessRequestsQueued=1]="AccessRequestsQueued",e[e.NoResolvedUsers=-1]="NoResolvedUsers",e[e.AccessDenied=-2]="AccessDenied",e[e.CrossSiteRequestNotSupported=-3]="CrossSiteRequestNotSupported",e[e.UnknowError=-4]="UnknowError",e[e.EmailBodyTooLong=-5]="EmailBodyTooLong",e[e.ListUniqueScopesExceeded=-6]="ListUniqueScopesExceeded",e[e.CapabilityDisabled=-7]="CapabilityDisabled",e[e.ObjectNotSupported=-8]="ObjectNotSupported",e[e.NestedGroupsNotSupported=-9]="NestedGroupsNotSupported"}(z||(z={})),function(e){e[e.Unknown=0]="Unknown",e[e.File=1]="File",e[e.Folder=2]="Folder",e[e.Item=3]="Item",e[e.List=4]="List",e[e.Web=5]="Web",e[e.Max=6]="Max"}($||($={})),function(e){e[e.None=0]="None",e[e.AllowList=1]="AllowList",e[e.BlockList=2]="BlockList"}(Q||(Q={})),function(e){e[e.None=0]="None",e[e.ContextInfo=1]="ContextInfo",e[e.ListData=2]="ListData",e[e.ListSchema=4]="ListSchema",e[e.MenuView=8]="MenuView",e[e.ListContentType=16]="ListContentType",e[e.FileSystemItemId=32]="FileSystemItemId",e[e.ClientFormSchema=64]="ClientFormSchema",e[e.QuickLaunch=128]="QuickLaunch",e[e.Spotlight=256]="Spotlight",e[e.Visualization=512]="Visualization",e[e.ViewMetadata=1024]="ViewMetadata",e[e.DisableAutoHyperlink=2048]="DisableAutoHyperlink",e[e.EnableMediaTAUrls=4096]="EnableMediaTAUrls",e[e.ParentInfo=8192]="ParentInfo",e[e.PageContextInfo=16384]="PageContextInfo",e[e.ClientSideComponentManifest=32768]="ClientSideComponentManifest"}(X||(X={})),function(e){e[e.PeopleAndGroups=1]="PeopleAndGroups",e[e.PeopleOnly=0]="PeopleOnly"}(Y||(Y={})),function(e){e[e.Dropdown=0]="Dropdown",e[e.RadioButtons=1]="RadioButtons"}(J||(J={})),function(e){e[e.DefaultZone=0]="DefaultZone",e[e.Intranet=1]="Intranet",e[e.Internet=2]="Internet",e[e.Custom=3]="Custom",e[e.Extranet=4]="Extranet"}(Z||(Z={}));var se,ue,ce,le,pe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),Object.defineProperty(t.prototype,"roleAssignments",{get:function(){return new ne(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"firstUniqueAncestorSecurableObject",{get:function(){return new P(this,"FirstUniqueAncestorSecurableObject")},enumerable:!0,configurable:!0}),t.prototype.getUserEffectivePermissions=function(e){var t=this.clone(w,"getUserEffectivePermissions(@user)");return t.query.set("@user","'"+encodeURIComponent(e)+"'"),t.get().then(function(e){return Object(r.hOP)(e,"GetUserEffectivePermissions")?e.GetUserEffectivePermissions:e})},t.prototype.getCurrentUserEffectivePermissions=function(){var e=this;return new P("_api/web","currentuser").configureFrom(this).select("LoginName").get().then(function(t){return e.getUserEffectivePermissions(t.LoginName)})},t.prototype.breakRoleInheritance=function(e,n){return void 0===e&&(e=!1),void 0===n&&(n=!1),this.clone(t,"breakroleinheritance(copyroleassignments="+e+", clearsubscopes="+n+")").postCore()},t.prototype.resetRoleInheritance=function(){return this.clone(t,"resetroleinheritance").postCore()},t.prototype.userHasPermissions=function(e,t){var n=this;return this.getUserEffectivePermissions(e).then(function(e){return n.hasPermissions(e,t)})},t.prototype.currentUserHasPermissions=function(e){var t=this;return this.getCurrentUserEffectivePermissions().then(function(n){return t.hasPermissions(n,e)})},t.prototype.hasPermissions=function(e,t){if(!t)return!0;if(t===B.FullMask)return 32767==(32767&e.High)&&65535===e.Low;var n=1;return(t-=1)>=0&&t<32?(n<<=t,0!=(e.Low&n)):t>=32&&t<64&&(n<<=t-32,0!=(e.High&n))},t}(P),de=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t.prototype.getShareLink=function(e,n){void 0===n&&(n=null);var o=null!==n?n.toISOString():null;return this.clone(t,"shareLink").postCore({body:Object(r.jsS)({request:{createLink:!0,emailData:null,settings:{expiration:o,linkKind:e}}})})},t.prototype.shareWith=function(e,n,o,i,a){var s=this;void 0===o&&(o=!1),void 0===i&&(i=!1),Array.isArray(e)||(e=[e]);var u=Object(r.jsS)(e.map(function(e){return{Key:e}})),c=n===K.Edit?H.Contributor:H.Reader;return new O("_api/web","roledefinitions").select("Id").filter("RoleTypeKind eq "+c).get().then(function(e){if(!Array.isArray(e)||e.length<1)throw Error("Could not locate a role defintion with RoleTypeKind "+c);var n={includeAnonymousLinkInEmail:o,peoplePickerInput:u,propagateAcl:i,roleValue:"role:"+e[0].Id,useSimplifiedRoles:!0};return void 0!==a&&(n=Object(r.extend)(n,{emailBody:a.body,emailSubject:void 0!==a.subject?a.subject:"",sendEmail:!0})),s.clone(t,"shareObject").postCore({body:Object(r.jsS)(n)})})},t.prototype.shareObject=function(e,t){var n=this;return void 0===t&&(t=!1),t?this.sendShareObjectRequest(e):(e=Object(r.extend)(e,{group:null,includeAnonymousLinkInEmail:!1,propagateAcl:!1,useSimplifiedRoles:!0},!0),this.getRoleValue(e.role,e.group).then(function(t){Array.isArray(e.loginNames)||(e.loginNames=[e.loginNames]);var o={peoplePickerInput:Object(r.jsS)(e.loginNames.map(function(e){return{Key:e}})),roleValue:t,url:e.url};return void 0!==e.emailData&&null!==e.emailData&&(o=Object(r.extend)(o,{emailBody:e.emailData.body,emailSubject:void 0!==e.emailData.subject?e.emailData.subject:"Shared with you.",sendEmail:!0})),n.sendShareObjectRequest(o)}))},t.prototype.unshareObjectWeb=function(e){return this.clone(t,"unshareObject").postCore({body:Object(r.jsS)({url:e})})},t.prototype.checkPermissions=function(e){return this.clone(t,"checkPermissions").postCore({body:Object(r.jsS)({recipients:e})})},t.prototype.getSharingInformation=function(e,n){void 0===e&&(e=null);var o=this.clone(t,"getSharingInformation");return o.expand.apply(o,n).postCore({body:Object(r.jsS)({request:e})})},t.prototype.getObjectSharingSettings=function(e){return void 0===e&&(e=!0),this.clone(t,"getObjectSharingSettings").postCore({body:Object(r.jsS)({useSimplifiedRoles:e})})},t.prototype.unshareObject=function(){return this.clone(t,"unshareObject").postCore()},t.prototype.deleteLinkByKind=function(e){return this.clone(t,"deleteLinkByKind").postCore({body:Object(r.jsS)({linkKind:e})})},t.prototype.unshareLink=function(e,n){return void 0===n&&(n="00000000-0000-0000-0000-000000000000"),this.clone(t,"unshareLink").postCore({body:Object(r.jsS)({linkKind:e,shareId:n})})},t.prototype.getRoleValue=function(e,t){if(void 0===t||null===t){var n=e===K.Edit?H.Contributor:H.Reader;return new O("_api/web","roledefinitions").select("Id").top(1).filter("RoleTypeKind eq "+n).get().then(function(e){if(e.length<1)throw Error("Could not locate associated role definition for supplied role. Edit and View are supported");return"role: "+e[0].Id})}switch(t){case H.Contributor:return new P("_api/web","associatedmembergroup").select("Id").get().then(function(e){return"group: "+e.Id});case H.Reader:case H.Guest:return new P("_api/web","associatedvisitorgroup").select("Id").get().then(function(e){return"group: "+e.Id});default:throw Error("Could not determine role value for supplied value. Contributor, Reader, and Guest are supported")}},t.prototype.getShareObjectWeb=function(e){return Promise.resolve(new P(p(e),"/_api/SP.Web.ShareObject"))},t.prototype.sendShareObjectRequest=function(e){return this.getShareObjectWeb(this.toUrl()).then(function(n){return n.expand("UsersWithAccessRequests","GroupsSharedWith").as(t).postCore({body:Object(r.jsS)(e)})})},t}(w),fe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t.prototype.shareWith=function(e,t,n){var o=this;void 0===t&&(t=K.View);var i=this.addBatchDependency();return new P(p(this.toUrl()),"/_api/web/url").get().then(function(a){return i(),o.shareObject(Object(r.combine)(a,"/_layouts/15/aclinv.aspx?forSharing=1&mbypass=1"),e,t,n)})},t.prototype.shareObject=function(e,t,n,r,o,i,a,s){return void 0===i&&(i=!1),void 0===a&&(a=!1),void 0===s&&(s=!0),this.clone(de,null).shareObject({emailData:r,group:o,includeAnonymousLinkInEmail:a,loginNames:t,propagateAcl:i,role:n,url:e,useSimplifiedRoles:s})},t.prototype.shareObjectRaw=function(e){return this.clone(de,null).shareObject(e,!0)},t.prototype.unshareObject=function(e){return this.clone(de,null).unshareObjectWeb(e)},t}(pe),he=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t.prototype.getShareLink=function(e,t){return void 0===e&&(e=W.OrganizationView),void 0===t&&(t=null),this.clone(de,null).getShareLink(e,t)},t.prototype.shareWith=function(e,t,n,r){return void 0===t&&(t=K.View),void 0===n&&(n=!1),this.clone(de,null).shareWith(e,t,n,!1,r)},t.prototype.checkSharingPermissions=function(e){return this.clone(de,null).checkPermissions(e)},t.prototype.getSharingInformation=function(e,t){return void 0===e&&(e=null),this.clone(de,null).getSharingInformation(e,t)},t.prototype.getObjectSharingSettings=function(e){return void 0===e&&(e=!0),this.clone(de,null).getObjectSharingSettings(e)},t.prototype.unshare=function(){return this.clone(de,null).unshareObject()},t.prototype.deleteSharingLinkByKind=function(e){return this.clone(de,null).deleteLinkByKind(e)},t.prototype.unshareLink=function(e,t){return this.clone(de,null).unshareLink(e,t)},t}(pe),ye=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t.prototype.getShareLink=function(e,t){void 0===e&&(e=W.OrganizationView),void 0===t&&(t=null);var n=this.addBatchDependency();return this.getShareable().then(function(r){return n(),r.getShareLink(e,t)})},t.prototype.checkSharingPermissions=function(e){var t=this.addBatchDependency();return this.getShareable().then(function(n){return t(),n.checkPermissions(e)})},t.prototype.getSharingInformation=function(e,t){void 0===e&&(e=null);var n=this.addBatchDependency();return this.getShareable().then(function(r){return n(),r.getSharingInformation(e,t)})},t.prototype.getObjectSharingSettings=function(e){void 0===e&&(e=!0);var t=this.addBatchDependency();return this.getShareable().then(function(n){return t(),n.getObjectSharingSettings(e)})},t.prototype.unshare=function(){var e=this.addBatchDependency();return this.getShareable().then(function(t){return e(),t.unshareObject()})},t.prototype.deleteSharingLinkByKind=function(e){var t=this.addBatchDependency();return this.getShareable().then(function(n){return t(),n.deleteLinkByKind(e)})},t.prototype.unshareLink=function(e,t){var n=this.addBatchDependency();return this.getShareable().then(function(r){return n(),r.unshareLink(e,t)})},t.prototype.getShareable=function(){var e=this;return this.clone(ge,"listItemAllFields",!1).select("odata.id").get().then(function(t){var n=new de(d(t));return e.hasBatch&&(n=n.inBatch(e.batch)),n})},t}(P),ge=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t.prototype.shareWith=function(e,t,n,r){void 0===t&&(t=K.View),void 0===n&&(n=!1);var o=this.addBatchDependency();return this.getShareable().then(function(i){return o(),i.shareWith(e,t,n,!1,r)})},t}(ye),me=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t.prototype.shareWith=function(e,t,n,r,o){void 0===t&&(t=K.View),void 0===n&&(n=!1),void 0===r&&(r=!1);var i=this.addBatchDependency();return this.getShareable().then(function(a){return i(),a.shareWith(e,t,n,r,o)})},t}(ye),ve=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),Object.defineProperty(t.prototype,"webparts",{get:function(){return new be(this,"webparts")},enumerable:!0,configurable:!0}),t.prototype.export=function(e){return this.clone(t,"ExportWebPart").postCore({body:Object(r.jsS)({webPartId:e})})},t.prototype.import=function(e){return this.clone(t,"ImportWebPart").postCore({body:Object(r.jsS)({webPartXml:e})})},t}(w),be=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t.prototype.getById=function(e){return new Se(this,"getbyid('"+e+"')")},t.prototype.getByControlId=function(e){return new Se(this,"getByControlId('"+e+"')")},t}(O),Se=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),Object.defineProperty(t.prototype,"webpart",{get:function(){return new _e(this)},enumerable:!0,configurable:!0}),t.prototype.saveChanges=function(){return this.clone(t,"SaveWebPartChanges").postCore()},t.prototype.moveTo=function(e,n){return this.clone(t,"MoveWebPartTo(zoneID='"+e+"', zoneIndex="+n+")").postCore()},t.prototype.close=function(){return this.clone(t,"CloseWebPart").postCore()},t.prototype.open=function(){return this.clone(t,"OpenWebPart").postCore()},t.prototype.delete=function(){return this.clone(t,"DeleteWebPart").postCore()},t}(P),_e=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t=u([E("webpart")],t)}(P),Te=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return s(t,e),n=t,t.prototype.getByName=function(e){var t=new Ie(this);return t.concat("('"+e+"')"),t},t.prototype.add=function(e){var t=this;return this.clone(n,"add('"+e+"')").postCore().then(function(n){return{data:n,folder:t.getByName(e)}})},t=n=u([E("folders")],t)}(O),Ie=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.update=t._update("SP.Folder",function(e){return{data:e,folder:t}}),t}return s(t,e),Object.defineProperty(t.prototype,"contentTypeOrder",{get:function(){return new O(this,"contentTypeOrder")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"files",{get:function(){return new Ze(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"folders",{get:function(){return new Te(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"listItemAllFields",{get:function(){return new P(this,"listItemAllFields")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parentFolder",{get:function(){return new t(this,"parentFolder")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"properties",{get:function(){return new P(this,"properties")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"serverRelativeUrl",{get:function(){return new w(this,"serverRelativeUrl")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"uniqueContentTypeOrder",{get:function(){return new O(this,"uniqueContentTypeOrder")},enumerable:!0,configurable:!0}),t.prototype.delete=function(e){return void 0===e&&(e="*"),this.clone(t,null).postCore({headers:{"IF-Match":e,"X-HTTP-Method":"DELETE"}})},t.prototype.recycle=function(){return this.clone(t,"recycle").postCore()},t.prototype.getItem=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=this.listItemAllFields;return n.select.apply(n,e).get().then(function(e){return Object(r.extend)(new ze(d(e)),e)})},t.prototype.moveTo=function(e){var t=this;return this.select("ServerRelativeUrl").get().then(function(n){var o=n.ServerRelativeUrl,i=new _,a=t.toUrl().split("/_api")[0],s=a.replace("://","___").split("/")[0].replace("___","://"),u=a+"/_api/SP.MoveCopyUtil.MoveFolder()";return i.post(u,{body:Object(r.jsS)({destUrl:0===e.indexOf("http")?e:""+s+e,srcUrl:""+s+o})}).then(function(e){return e.json()})})},t}(me),Ce=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return s(t,e),n=t,t.prototype.addAvailableContentType=function(e){var t=this,o=Object(r.jsS)({contentTypeId:e});return this.clone(n,"addAvailableContentType").postCore({body:o}).then(function(e){return{contentType:t.getById(e.id),data:e}})},t.prototype.getById=function(e){var t=new we(this);return t.concat("('"+e+"')"),t},t.prototype.add=function(e,t,n,o,i){var a=this;void 0===n&&(n=""),void 0===o&&(o="Custom Content Types"),void 0===i&&(i={});var s=Object(r.jsS)(Object.assign(C("SP.ContentType"),{Description:n,Group:o,Id:{StringValue:e},Name:t},i));return this.postCore({body:s}).then(function(e){return{contentType:a.getById(e.id),data:e}})},t=n=u([E("contenttypes")],t)}(O),we=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.delete=t._delete,t}return s(t,e),Object.defineProperty(t.prototype,"fieldLinks",{get:function(){return new Oe(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fields",{get:function(){return new O(this,"fields")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new t(this,"parent")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"workflowAssociations",{get:function(){return new O(this,"workflowAssociations")},enumerable:!0,configurable:!0}),t}(P),Oe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t.prototype.getById=function(e){var t=new Pe(this);return t.concat("(guid'"+e+"')"),t},t=u([E("fieldlinks")],t)}(O),Pe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t}(P),Ee=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return s(t,e),n=t,t.prototype.getByName=function(e){var t=new xe(this);return t.concat("('"+e+"')"),t},t.prototype.add=function(e,t){var r=this;return this.clone(n,"add(FileName='"+e+"')",!1).postCore({body:t}).then(function(t){return{data:t,file:r.getByName(e)}})},t.prototype.addMultiple=function(e){var t=this;return e.reduce(function(e,r){return e.then(function(){return t.clone(n,"add(FileName='"+r.name+"')",!1).postCore({body:r.content})})},Promise.resolve())},t.prototype.deleteMultiple=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return t.reduce(function(t,n){return t.then(function(){return e.getByName(n).delete()})},Promise.resolve())},t.prototype.recycleMultiple=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return t.reduce(function(t,n){return t.then(function(){return e.getByName(n).recycle()})},Promise.resolve())},t=n=u([E("AttachmentFiles")],t)}(O),xe=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.delete=t._deleteWithETag,t}return s(t,e),t.prototype.getText=function(){return this.getParsed(new i.k)},t.prototype.getBlob=function(){return this.getParsed(new i.a)},t.prototype.getBuffer=function(){return this.getParsed(new i.b)},t.prototype.getJSON=function(){return this.getParsed(new i.e)},t.prototype.setContent=function(e){var n=this;return this.clone(t,"$value",!1).postCore({body:e,headers:{"X-HTTP-Method":"PUT"}}).then(function(e){return new t(n)})},t.prototype.recycle=function(e){return void 0===e&&(e="*"),this.clone(t,"recycleObject").postCore({headers:{"IF-Match":e,"X-HTTP-Method":"DELETE"}})},t.prototype.getParsed=function(e){return this.clone(t,"$value",!1).get(e)},t}(P),Ne=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return s(t,e),n=t,t.prototype.getById=function(e){var t=new Ae(this);return t.concat("('"+e+"')"),t},t.prototype.getByTitle=function(e){return new Ae(this,"getByTitle('"+e+"')")},t.prototype.add=function(e,t,o){var i=this;void 0===t&&(t=!1),void 0===o&&(o={});var a=Object(r.jsS)(Object.assign(C("SP.View"),{PersonalView:t,Title:e},o));return this.clone(n,null).postCore({body:a}).then(function(e){return{data:e,view:i.getById(e.Id)}})},t=n=u([E("views")],t)}(O),Ae=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.update=t._update("SP.View",function(e){return{data:e,view:t}}),t.delete=t._delete,t}return s(t,e),Object.defineProperty(t.prototype,"fields",{get:function(){return new Re(this)},enumerable:!0,configurable:!0}),t.prototype.renderAsHtml=function(){return this.clone(w,"renderashtml").get()},t.prototype.setViewXml=function(e){return this.clone(t,"SetViewXml").postCore({body:Object(r.jsS)({viewXml:e})})},t}(P),Re=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return s(t,e),n=t,t.prototype.getSchemaXml=function(){return this.clone(w,"schemaxml").get()},t.prototype.add=function(e){return this.clone(n,"addviewfield('"+e+"')").postCore()},t.prototype.move=function(e,t){return this.clone(n,"moveviewfieldto").postCore({body:Object(r.jsS)({field:e,index:t})})},t.prototype.removeAll=function(){return this.clone(n,"removeallviewfields").postCore()},t.prototype.remove=function(e){return this.clone(n,"removeviewfield('"+e+"')").postCore()},t=n=u([E("viewfields")],t)}(O),Me=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return s(t,e),n=t,t.prototype.getById=function(e){var t=new je(this);return t.concat("('"+e+"')"),t},t.prototype.getByTitle=function(e){return new je(this,"getByTitle('"+e+"')")},t.prototype.getByInternalNameOrTitle=function(e){return new je(this,"getByInternalNameOrTitle('"+e+"')")},t.prototype.createFieldAsXml=function(e){var t,o=this;t="string"==typeof e?{SchemaXml:e}:e;var i=Object(r.jsS)({parameters:Object(r.extend)(C("SP.XmlSchemaFieldCreationInformation"),t)});return this.clone(n,"createfieldasxml").postCore({body:i}).then(function(e){return{data:e,field:o.getById(e.Id)}})},t.prototype.add=function(e,t,o){var i=this,a=Object(r.jsS)(Object.assign(C(t),{Title:e},o));return this.clone(n,null).postCore({body:a}).then(function(e){return{data:e,field:i.getById(e.Id)}})},t.prototype.addText=function(e,t,n){void 0===t&&(t=255);var o={FieldTypeKind:2,MaxLength:t};return this.add(e,"SP.FieldText",Object(r.extend)(o,n))},t.prototype.addCalculated=function(e,t,n,o,i){void 0===o&&(o=D.Text);var a={DateFormat:n,FieldTypeKind:17,Formula:t,OutputType:o};return this.add(e,"SP.FieldCalculated",Object(r.extend)(a,i))},t.prototype.addDateTime=function(e,t,n,o,i){void 0===t&&(t=L.DateOnly),void 0===n&&(n=U.Gregorian),void 0===o&&(o=0);var a={DateTimeCalendarType:n,DisplayFormat:t,FieldTypeKind:4,FriendlyDisplayFormat:o};return this.add(e,"SP.FieldDateTime",Object(r.extend)(a,i))},t.prototype.addNumber=function(e,t,n,o){var i={FieldTypeKind:9};return void 0!==t&&(i=Object(r.extend)({MinimumValue:t},i)),void 0!==n&&(i=Object(r.extend)({MaximumValue:n},i)),this.add(e,"SP.FieldNumber",Object(r.extend)(i,o))},t.prototype.addCurrency=function(e,t,n,o,i){void 0===o&&(o=1033);var a={CurrencyLocaleId:o,FieldTypeKind:10};return void 0!==t&&(a=Object(r.extend)({MinimumValue:t},a)),void 0!==n&&(a=Object(r.extend)({MaximumValue:n},a)),this.add(e,"SP.FieldCurrency",Object(r.extend)(a,i))},t.prototype.addMultilineText=function(e,t,n,o,i,a,s){void 0===t&&(t=6),void 0===n&&(n=!0),void 0===o&&(o=!1),void 0===i&&(i=!1),void 0===a&&(a=!0);var u={AllowHyperlink:a,AppendOnly:i,FieldTypeKind:3,NumberOfLines:t,RestrictedMode:o,RichText:n};return this.add(e,"SP.FieldMultiLineText",Object(r.extend)(u,s))},t.prototype.addUrl=function(e,t,n){void 0===t&&(t=F.Hyperlink);var o={DisplayFormat:t,FieldTypeKind:11};return this.add(e,"SP.FieldUrl",Object(r.extend)(o,n))},t.prototype.addUser=function(e,t,n){var o={FieldTypeKind:20,SelectionMode:t};return this.add(e,"SP.FieldUser",Object(r.extend)(o,n))},t.prototype.addLookup=function(e,t,o,i){var a=this,s=Object(r.extend)({FieldTypeKind:7,LookupFieldName:o,LookupListId:t,Title:e},i),u=Object(r.jsS)({parameters:Object(r.extend)(C("SP.FieldCreationInformation"),s)});return this.clone(n,"addfield").postCore({body:u}).then(function(e){return{data:e,field:a.getById(e.Id)}})},t.prototype.addChoice=function(e,t,n,o,i){void 0===n&&(n=J.Dropdown);var a={Choices:{results:t},EditFormat:n,FieldTypeKind:6,FillInChoice:o};return this.add(e,"SP.FieldChoice",Object(r.extend)(a,i))},t.prototype.addMultiChoice=function(e,t,n,o){var i={Choices:{results:t},FieldTypeKind:15,FillInChoice:n};return this.add(e,"SP.FieldMultiChoice",Object(r.extend)(i,o))},t.prototype.addBoolean=function(e,t){return this.add(e,"SP.Field",Object(r.extend)({FieldTypeKind:8},t))},t.prototype.addDependentLookupField=function(e,t,r){var o=this;return this.clone(n,"adddependentlookupfield(displayName='"+e+"', primarylookupfieldid='"+t+"', showfield='"+r+"')").postCore().then(function(e){return{data:e,field:o.getById(e.Id)}})},t=n=u([E("fields")],t)}(O),je=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.delete=t._delete,t}return s(t,e),t.prototype.update=function(e,t){var n=this;void 0===t&&(t="SP.Field");var o=Object(r.jsS)(Object(r.extend)(C(t),e));return this.postCore({body:o,headers:{"X-HTTP-Method":"MERGE"}}).then(function(e){return{data:e,field:n}})},t.prototype.setShowInDisplayForm=function(e){return this.clone(t,"setshowindisplayform("+e+")").postCore()},t.prototype.setShowInEditForm=function(e){return this.clone(t,"setshowineditform("+e+")").postCore()},t.prototype.setShowInNewForm=function(e){return this.clone(t,"setshowinnewform("+e+")").postCore()},t}(P),De=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t.prototype.getById=function(e){var t=new Le(this);return t.concat("('"+e+"')"),t},t=u([E("forms")],t)}(O),Le=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t}(P),ke=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t.prototype.getById=function(e){var t=new Ue(this);return t.concat("('"+e+"')"),t},t.prototype.add=function(e,t,n){var o=this,i=Object(r.jsS)({clientState:n||"pnp-js-core-subscription",expirationDateTime:t,notificationUrl:e,resource:this.toUrl()});return this.postCore({body:i,headers:{"Content-Type":"application/json"}}).then(function(e){return{data:e,subscription:o.getById(e.id)}})},t=u([E("subscriptions")],t)}(O),Ue=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t.prototype.update=function(e){var t=this,n=Object(r.jsS)({expirationDateTime:e});return this.patchCore({body:n,headers:{"Content-Type":"application/json"}}).then(function(e){return{data:e,subscription:t}})},t.prototype.delete=function(){return e.prototype.deleteCore.call(this)},t}(P),Fe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return s(t,e),n=t,t.prototype.getById=function(e){var t=new Be(this);return t.concat("('"+e+"')"),t},t.prototype.add=function(e){var t=this,n=Object(r.jsS)(Object(r.extend)({__metadata:{type:"SP.UserCustomAction"}},e));return this.postCore({body:n}).then(function(e){return{action:t.getById(e.Id),data:e}})},t.prototype.clear=function(){return this.clone(n,"clear").postCore()},t=n=u([E("usercustomactions")],t)}(O),Be=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.update=t._update("SP.UserCustomAction",function(e){return{data:e,action:t}}),t}return s(t,e),t.prototype.delete=function(){return e.prototype.deleteCore.call(this)},t}(P),Ge=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return s(t,e),n=t,t.prototype.getById=function(e){var t=new qe(this);return t.concat("('"+e+"')"),t},t.prototype.getByTitle=function(e){return new qe(this,"getByTitle('"+e+"')")},t.prototype.add=function(e,t,n,o,i){var a=this;void 0===t&&(t=""),void 0===n&&(n=100),void 0===o&&(o=!1),void 0===i&&(i={});var s=Object(r.extend)({AllowContentTypes:o,BaseTemplate:n,ContentTypesEnabled:o,Description:t,Title:e,__metadata:{type:"SP.List"}},i);return this.postCore({body:Object(r.jsS)(s)}).then(function(e){return{data:e,list:a.getByTitle(s.Title)}})},t.prototype.ensure=function(e,t,n,o,i){var a=this;if(void 0===t&&(t=""),void 0===n&&(n=100),void 0===o&&(o=!1),void 0===i&&(i={}),this.hasBatch)throw Error("The ensure list method is not supported for use in a batch.");return new Promise(function(s,u){var c=Object(r.extend)(i,{Title:e,Description:t,ContentTypesEnabled:o},!0),l=a.getByTitle(c.Title);l.get().then(function(e){l.update(c).then(function(e){s({created:!1,data:e,list:a.getByTitle(c.Title)})}).catch(function(e){return u(e)})}).catch(function(r){a.add(e,t,n,o,c).then(function(e){s({created:!0,data:e.data,list:a.getByTitle(c.Title)})}).catch(function(e){return u(e)})})})},t.prototype.ensureSiteAssetsLibrary=function(){return this.clone(n,"ensuresiteassetslibrary").postCore().then(function(e){return new qe(d(e))})},t.prototype.ensureSitePagesLibrary=function(){return this.clone(n,"ensuresitepageslibrary").postCore().then(function(e){return new qe(d(e))})},t=n=u([E("lists")],t)}(O),qe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),Object.defineProperty(t.prototype,"contentTypes",{get:function(){return new Ce(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"items",{get:function(){return new Ke(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"views",{get:function(){return new Ne(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fields",{get:function(){return new Me(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"forms",{get:function(){return new De(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"defaultView",{get:function(){return new Ae(this,"DefaultView")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"userCustomActions",{get:function(){return new Fe(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"effectiveBasePermissions",{get:function(){return new w(this,"EffectiveBasePermissions")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"eventReceivers",{get:function(){return new O(this,"EventReceivers")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"relatedFields",{get:function(){return new w(this,"getRelatedFields")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"informationRightsManagementSettings",{get:function(){return new w(this,"InformationRightsManagementSettings")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"subscriptions",{get:function(){return new ke(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rootFolder",{get:function(){return new Ie(this,"rootFolder")},enumerable:!0,configurable:!0}),t.prototype.getView=function(e){return new Ae(this,"getView('"+e+"')")},t.prototype.update=function(e,n){var o=this;void 0===n&&(n="*");var i=Object(r.jsS)(Object(r.extend)({__metadata:{type:"SP.List"}},e));return this.postCore({body:i,headers:{"IF-Match":n,"X-HTTP-Method":"MERGE"}}).then(function(n){var i=o;return Object(r.hOP)(e,"Title")&&(i=o.getParent(t,o.parentUrl,"getByTitle('"+e.Title+"')")),{data:n,list:i}})},t.prototype.delete=function(e){return void 0===e&&(e="*"),this.postCore({headers:{"IF-Match":e,"X-HTTP-Method":"DELETE"}})},t.prototype.getChanges=function(e){return this.clone(t,"getchanges").postCore({body:Object(r.jsS)({query:Object(r.extend)({__metadata:{type:"SP.ChangeQuery"}},e)})})},t.prototype.getItemsByCAMLQuery=function(e){for(var n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];var i=this.clone(t,"getitems");return i.expand.apply(i,n).postCore({body:Object(r.jsS)({query:Object(r.extend)({__metadata:{type:"SP.CamlQuery"}},e)})})},t.prototype.getListItemChangesSinceToken=function(e){return this.clone(t,"getlistitemchangessincetoken").postCore({body:Object(r.jsS)({query:Object(r.extend)({__metadata:{type:"SP.ChangeLogItemQuery"}},e)})},{parse:function(e){return e.text()}})},t.prototype.recycle=function(){return this.clone(t,"recycle").postCore().then(function(e){return Object(r.hOP)(e,"Recycle")?e.Recycle:e})},t.prototype.renderListData=function(e){var n=this.clone(t,"renderlistdata(@viewXml)");return n.query.set("@viewXml","'"+e+"'"),n.postCore().then(function(e){return JSON.parse(Object(r.hOP)(e,"RenderListData")?e.RenderListData:e)})},t.prototype.renderListDataAsStream=function(e,n){void 0===n&&(n=null);var o={overrideParameters:Object(r.extend)(C("SP.RenderListDataOverrideParameters"),n),parameters:Object(r.extend)(C("SP.RenderListDataParameters"),e)};return this.clone(t,"RenderListDataAsStream",!0).postCore({body:Object(r.jsS)(o)})},t.prototype.renderListFormData=function(e,n,o){return this.clone(t,"renderlistformdata(itemid="+e+", formid='"+n+"', mode='"+o+"')").postCore().then(function(e){return JSON.parse(Object(r.hOP)(e,"RenderListFormData")?e.RenderListFormData:e)})},t.prototype.reserveListItemId=function(){return this.clone(t,"reservelistitemid").postCore().then(function(e){return Object(r.hOP)(e,"ReserveListItemId")?e.ReserveListItemId:e})},t.prototype.getListItemEntityTypeFullName=function(){return this.clone(t,null,!1).select("ListItemEntityTypeFullName").get().then(function(e){return e.ListItemEntityTypeFullName})},t.prototype.addValidateUpdateItemUsingPath=function(e,n,o,i){return void 0===o&&(o=!1),this.clone(t,"AddValidateUpdateItemUsingPath()").postCore({body:Object(r.jsS)({bNewDocumentUpdate:o,checkInComment:i,formValues:e,listItemCreateInfo:{FolderPath:{DecodedUrl:n,__metadata:{type:"SP.ResourcePath"}},__metadata:{type:"SP.ListItemCreationInformationUsingPath"}}})}).then(function(e){return void 0!==e.AddValidateUpdateItemUsingPath?e.AddValidateUpdateItemUsingPath.results:e})},t}(pe),He=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return s(t,e),n=t,t.prototype.add=function(e){var t=this;"string"==typeof e&&(e={text:e});var o=Object(r.jsS)(Object(r.extend)(C("Microsoft.SharePoint.Comments.comment"),e));return this.clone(n,null).postCore({body:o}).then(function(e){return Object(r.extend)(t.getById(e.id),e)})},t.prototype.getById=function(e){var t=new Ve(this);return t.concat("("+e+")"),t},t.prototype.clear=function(){return this.clone(n,"DeleteAll").postCore()},t=n=u([E("comments")],t)}(O),Ve=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),Object.defineProperty(t.prototype,"replies",{get:function(){return new We(this)},enumerable:!0,configurable:!0}),t.prototype.like=function(){return this.clone(t,"Like").postCore()},t.prototype.unlike=function(){return this.clone(t,"Unlike").postCore()},t.prototype.delete=function(){return this.clone(t,"DeleteComment").postCore()},t}(P),We=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return s(t,e),n=t,t.prototype.add=function(e){"string"==typeof e&&(e={text:e});var t=Object(r.jsS)(Object(r.extend)(C("Microsoft.SharePoint.Comments.comment"),e));return this.clone(n,null).postCore({body:t}).then(function(e){return Object(r.extend)(new Ve(d(e)),e)})},t=n=u([E("replies")],t)}(O),Ke=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return s(t,e),n=t,t.prototype.getById=function(e){var t=new ze(this);return t.concat("("+e+")"),t},t.prototype.getItemByStringId=function(e){return new ze(this.parentUrl,"getItemByStringId('"+e+"')")},t.prototype.skip=function(e,t){return void 0===t&&(t=!1),t?this.query.set("$skiptoken",encodeURIComponent("Paged=TRUE&PagedPrev=TRUE&p_ID="+e)):this.query.set("$skiptoken",encodeURIComponent("Paged=TRUE&p_ID="+e)),this},t.prototype.getPaged=function(){return this.get(new Ye(this))},t.prototype.getAll=function(e,t){void 0===e&&(e=2e3),void 0===t&&(t="application/json;odata=nometadata"),o.a.write("Calling items.getAll should be done sparingly. Ensure this is the correct choice. If you are unsure, it is not.",2);var r=new n(this,"").top(e).configure({headers:{Accept:t}});return this.query.forEach(function(e,t){/^\$select|filter|top|expand$/i.test(t)&&r.query.set(t,e)}),new Promise(function(e,t){var n=[],o=function(r){[].push.apply(n,r.results),r.hasNext?r.getNext().then(o).catch(t):e(n)};r.getPaged().then(o).catch(t)})},t.prototype.add=function(e,t){var o=this;void 0===e&&(e={}),void 0===t&&(t=null);var i=this.addBatchDependency();return this.ensureListItemEntityTypeName(t).then(function(t){var a=Object(r.jsS)(Object(r.extend)(C(t),e)),s=o.clone(n,"").postCore({body:a}).then(function(e){return{data:e,item:o.getById(e.Id)}});return i(),s})},t.prototype.ensureListItemEntityTypeName=function(e){return e?Promise.resolve(e):this.getParent(qe).getListItemEntityTypeFullName()},t=n=u([E("items")],t)}(O),ze=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.delete=t._deleteWithETag,t}return s(t,e),Object.defineProperty(t.prototype,"attachmentFiles",{get:function(){return new Ee(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"contentType",{get:function(){return new we(this,"ContentType")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"comments",{get:function(){return new He(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"effectiveBasePermissions",{get:function(){return new w(this,"EffectiveBasePermissions")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"effectiveBasePermissionsForUI",{get:function(){return new w(this,"EffectiveBasePermissionsForUI")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fieldValuesAsHTML",{get:function(){return new P(this,"FieldValuesAsHTML")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fieldValuesAsText",{get:function(){return new P(this,"FieldValuesAsText")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fieldValuesForEdit",{get:function(){return new P(this,"FieldValuesForEdit")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"folder",{get:function(){return new Ie(this,"folder")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"file",{get:function(){return new et(this,"file")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"versions",{get:function(){return new $e(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"list",{get:function(){return this.getParent(qe,this.parentUrl.substr(0,this.parentUrl.lastIndexOf("/")))},enumerable:!0,configurable:!0}),t.prototype.update=function(e,t,n){var o=this;return void 0===t&&(t="*"),void 0===n&&(n=null),new Promise(function(i,a){var s=o.addBatchDependency();return o.ensureListItemEntityTypeName(n).then(function(n){var a=Object(r.jsS)(Object(r.extend)(C(n),e));return s(),o.postCore({body:a,headers:{"IF-Match":t,"X-HTTP-Method":"MERGE"}},new Je).then(function(e){i({data:e,item:o})})}).catch(function(e){return a(e)})})},t.prototype.getLikedBy=function(){return this.clone(t,"likedBy").postCore()},t.prototype.like=function(){return this.clone(t,"like").postCore()},t.prototype.unlike=function(){return this.clone(t,"unlike").postCore()},t.prototype.recycle=function(){return this.clone(t,"recycle").postCore()},t.prototype.getWopiFrameUrl=function(e){void 0===e&&(e=0);var n=this.clone(t,"getWOPIFrameUrl(@action)");return n.query.set("@action",e),n.postCore().then(function(e){return Object(r.hOP)(e,"GetWOPIFrameUrl")?e.GetWOPIFrameUrl:e})},t.prototype.validateUpdateListItem=function(e,n){return void 0===n&&(n=!1),this.clone(t,"validateupdatelistitem").postCore({body:Object(r.jsS)({formValues:e,bNewDocumentUpdate:n})})},t.prototype.getLikedByInformation=function(){return this.clone(t,"likedByInformation").expand("likedby").getCore()},t.prototype.ensureListItemEntityTypeName=function(e){return e?Promise.resolve(e):this.list.getListItemEntityTypeFullName()},t}(he),$e=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t.prototype.getById=function(e){var t=new Qe(this);return t.concat("("+e+")"),t},t=u([E("versions")],t)}(O),Qe=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.delete=t._deleteWithETag,t}return s(t,e),t}(P),Xe=function(){function e(e,t,n){this.parent=e,this.nextUrl=t,this.results=n}return Object.defineProperty(e.prototype,"hasNext",{get:function(){return"string"==typeof this.nextUrl&&this.nextUrl.length>0},enumerable:!0,configurable:!0}),e.prototype.getNext=function(){return this.hasNext?new Ke(this.nextUrl,null).configureFrom(this.parent).getPaged():new Promise(function(e){return e(null)})},e}(),Ye=function(e){function t(t){var n=e.call(this)||this;return n._parent=t,n}return s(t,e),t.prototype.parse=function(e){var t=this;return new Promise(function(n,o){t.handleError(e,o)&&e.json().then(function(e){var o=Object(r.hOP)(e,"d")&&Object(r.hOP)(e.d,"__next")?e.d.__next:e["odata.nextLink"];n(new Xe(t._parent,o,t.parseODataJSON(e)))})})},t}(i.h),Je=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t.prototype.parse=function(e){var t=this;return new Promise(function(n,r){t.handleError(e,r)&&n({"odata.etag":e.headers.get("etag")})})},t}(i.h),Ze=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return s(t,e),n=t,t.prototype.getByName=function(e){var t=new et(this);return t.concat("('"+e+"')"),t},t.prototype.add=function(e,t,r){var o=this;return void 0===r&&(r=!0),new n(this,"add(overwrite="+r+",url='"+e+"')").postCore({body:t}).then(function(t){return{data:t,file:o.getByName(e)}})},t.prototype.addChunked=function(e,t,r,o,i){var a=this;return void 0===o&&(o=!0),void 0===i&&(i=10485760),this.clone(n,"add(overwrite="+o+",url='"+e+"')",!1).postCore().then(function(){return a.getByName(e)}).then(function(e){return e.setContentChunked(t,r,i)})},t.prototype.addTemplateFile=function(e,t){var r=this;return this.clone(n,"addTemplateFile(urloffile='"+e+"',templatefiletype="+t+")",!1).postCore().then(function(t){return{data:t,file:r.getByName(e)}})},t=n=u([E("files")],t)}(O),et=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),Object.defineProperty(t.prototype,"listItemAllFields",{get:function(){return new P(this,"listItemAllFields")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"versions",{get:function(){return new tt(this)},enumerable:!0,configurable:!0}),t.prototype.approve=function(e){return void 0===e&&(e=""),this.clone(t,"approve(comment='"+e+"')").postCore()},t.prototype.cancelUpload=function(e){return this.clone(t,"cancelUpload(uploadId=guid'"+e+"')",!1).postCore()},t.prototype.checkin=function(e,n){if(void 0===e&&(e=""),void 0===n&&(n=se.Major),e.length>1023)throw Error("The maximum comment length is 1023 characters.");return this.clone(t,"checkin(comment='"+e+"',checkintype="+n+")").postCore()},t.prototype.checkout=function(){return this.clone(t,"checkout").postCore()},t.prototype.copyTo=function(e,n){return void 0===n&&(n=!0),this.clone(t,"copyTo(strnewurl='"+e+"',boverwrite="+n+")").postCore()},t.prototype.delete=function(e){return void 0===e&&(e="*"),this.clone(t,null).postCore({headers:{"IF-Match":e,"X-HTTP-Method":"DELETE"}})},t.prototype.deny=function(e){if(void 0===e&&(e=""),e.length>1023)throw Error("The maximum comment length is 1023 characters.");return this.clone(t,"deny(comment='"+e+"')").postCore()},t.prototype.getLimitedWebPartManager=function(e){return void 0===e&&(e=ue.Shared),new ve(this,"getLimitedWebPartManager(scope="+e+")")},t.prototype.moveTo=function(e,n){return void 0===n&&(n=ce.Overwrite),this.clone(t,"moveTo(newurl='"+e+"',flags="+n+")").postCore()},t.prototype.publish=function(e){if(void 0===e&&(e=""),e.length>1023)throw Error("The maximum comment length is 1023 characters.");return this.clone(t,"publish(comment='"+e+"')").postCore()},t.prototype.recycle=function(){return this.clone(t,"recycle").postCore()},t.prototype.undoCheckout=function(){return this.clone(t,"undoCheckout").postCore()},t.prototype.unpublish=function(e){if(void 0===e&&(e=""),e.length>1023)throw Error("The maximum comment length is 1023 characters.");return this.clone(t,"unpublish(comment='"+e+"')").postCore()},t.prototype.getText=function(){return this.clone(t,"$value",!1).get(new i.k,{headers:{binaryStringResponseBody:"true"}})},t.prototype.getBlob=function(){return this.clone(t,"$value",!1).get(new i.a,{headers:{binaryStringResponseBody:"true"}})},t.prototype.getBuffer=function(){return this.clone(t,"$value",!1).get(new i.b,{headers:{binaryStringResponseBody:"true"}})},t.prototype.getJSON=function(){return this.clone(t,"$value",!1).get(new i.e,{headers:{binaryStringResponseBody:"true"}})},t.prototype.setContent=function(e){var n=this;return this.clone(t,"$value",!1).postCore({body:e,headers:{"X-HTTP-Method":"PUT"}}).then(function(e){return new t(n)})},t.prototype.getItem=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=this.listItemAllFields;return n.select.apply(n,e).get().then(function(e){return Object(r.extend)(new ze(d(e)),e)})},t.prototype.setContentChunked=function(e,t,n){var o=this;void 0===n&&(n=10485760),void 0===t&&(t=function(){return null});var i=e.size,a=parseInt((e.size/n).toString(),10)+(e.size%n==0?1:0),s=Object(r.getGUID)();t({uploadId:s,blockNumber:1,chunkSize:n,currentPointer:0,fileSize:i,stage:"starting",totalBlocks:a});for(var u=this.startUpload(s,e.slice(0,n)),c=function(r){u=u.then(function(u){return t({uploadId:s,blockNumber:r,chunkSize:n,currentPointer:u,fileSize:i,stage:"continue",totalBlocks:a}),o.continueUpload(s,u,e.slice(u,u+n))})},l=2;l<a;l++)c(l);return u.then(function(r){return t({uploadId:s,blockNumber:a,chunkSize:n,currentPointer:r,fileSize:i,stage:"finishing",totalBlocks:a}),o.finishUpload(s,r,e.slice(r))})},t.prototype.startUpload=function(e,n){return this.clone(t,"startUpload(uploadId=guid'"+e+"')",!1).postCore({body:n}).then(function(e){return"object"==typeof e&&(e=e.StartUpload),parseFloat(e)})},t.prototype.continueUpload=function(e,n,r){return this.clone(t,"continueUpload(uploadId=guid'"+e+"',fileOffset="+n+")",!1).postCore({body:r}).then(function(e){return"object"==typeof e&&(e=e.ContinueUpload),parseFloat(e)})},t.prototype.finishUpload=function(e,n,r){return this.clone(t,"finishUpload(uploadId=guid'"+e+"',fileOffset="+n+")",!1).postCore({body:r}).then(function(e){return{data:e,file:new t(d(e))}})},t}(ge),tt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return s(t,e),n=t,t.prototype.getById=function(e){var t=new nt(this);return t.concat("("+e+")"),t},t.prototype.deleteAll=function(){return new n(this,"deleteAll").postCore()},t.prototype.deleteById=function(e){return this.clone(n,"deleteById(vid="+e+")").postCore()},t.prototype.recycleByID=function(e){return this.clone(n,"recycleByID(vid="+e+")").postCore()},t.prototype.deleteByLabel=function(e){return this.clone(n,"deleteByLabel(versionlabel='"+e+"')").postCore()},t.prototype.recycleByLabel=function(e){return this.clone(n,"recycleByLabel(versionlabel='"+e+"')").postCore()},t.prototype.restoreByLabel=function(e){return this.clone(n,"restoreByLabel(versionlabel='"+e+"')").postCore()},t=n=u([E("versions")],t)}(O),nt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.delete=t._deleteWithETag,t}return s(t,e),t}(P);!function(e){e[e.Minor=0]="Minor",e[e.Major=1]="Major",e[e.Overwrite=2]="Overwrite"}(se||(se={})),function(e){e[e.User=0]="User",e[e.Shared=1]="Shared"}(ue||(ue={})),function(e){e[e.Overwrite=1]="Overwrite",e[e.AllowBrokenThickets=8]="AllowBrokenThickets"}(ce||(ce={})),function(e){e[e.StandardPage=0]="StandardPage",e[e.WikiPage=1]="WikiPage",e[e.FormPage=2]="FormPage",e[e.ClientSidePage=3]="ClientSidePage"}(le||(le={}));var rt,ot=function(e){function t(t,n){return void 0===n&&(n="_api/web/tenantappcatalog/AvailableApps"),e.call(this,p("string"==typeof t?t:t.toUrl()),n)||this}return s(t,e),t.prototype.getAppById=function(e){return new it(this,"getById('"+e+"')")},t.prototype.add=function(e,n,r){return void 0===r&&(r=!0),new t(p(this.toUrl()),"_api/web/tenantappcatalog/add(overwrite="+r+",url='"+e+"')").postCore({body:n}).then(function(e){return{data:e,file:new et(d(e))}})},t}(O),it=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t.prototype.deploy=function(e){return void 0===e&&(e=!1),this.clone(t,"Deploy("+e+")").postCore()},t.prototype.retract=function(){return this.clone(t,"Retract").postCore()},t.prototype.install=function(){return this.clone(t,"Install").postCore()},t.prototype.uninstall=function(){return this.clone(t,"Uninstall").postCore()},t.prototype.upgrade=function(){return this.clone(t,"Upgrade").postCore()},t.prototype.remove=function(){return this.clone(t,"Remove").postCore()},t}(P),at=function(e){function t(t){var n=e.call(this)||this;return n.baseUrl=t,n}return s(t,e),t.ParseResponse=function(e){return new Promise(function(t,n){for(var r,o,i=[],a=new RegExp("^HTTP/[0-9.]+ +([0-9]+) +(.*)","i"),s=e.split("\n"),u="batch",c=0;c<s.length;++c){var l=s[c];switch(u){case"batch":if("--batchresponse_"===l.substr(0,"--batchresponse_".length))u="batchHeaders";else if(""!==l.trim())throw Error("Invalid response, line "+c);break;case"batchHeaders":""===l.trim()&&(u="status");break;case"status":var p=a.exec(l);if(3!==p.length)throw Error("Invalid status, line "+c);r=parseInt(p[1],10),o=p[2],u="statusHeaders";break;case"statusHeaders":""===l.trim()&&(u="body");break;case"body":i.push(204===r?new Response:new Response(l,{status:r,statusText:o})),u="batch"}}"status"!==u&&n(Error("Unexpected end of input")),t(i)})},t.prototype.executeImpl=function(){var e=this;if(o.a.write("["+this.batchId+"] ("+(new Date).getTime()+") Executing batch with "+this.requests.length+" requests.",1),this.requests.length<1)return o.a.write("Resolving empty batch.",1),Promise.resolve();var n=new _;return I(this.baseUrl).then(function(i){for(var a=[],s="",u=0;u<e.requests.length;u++){var c=e.requests[u];"GET"===c.method?(s.length>0&&(a.push("--changeset_"+s+"--\n\n"),s=""),a.push("--batch_"+e.batchId+"\n")):(s.length<1&&(s=Object(r.getGUID)(),a.push("--batch_"+e.batchId+"\n"),a.push('Content-Type: multipart/mixed; boundary="changeset_'+s+'"\n\n')),a.push("--changeset_"+s+"\n")),a.push("Content-Type: application/http\n"),a.push("Content-Transfer-Encoding: binary\n\n");var l=new Headers,p=Object(r.isUrlAbsolute)(c.url)?c.url:Object(r.combine)(i,c.url);if(o.a.write("["+e.batchId+"] ("+(new Date).getTime()+") Adding request "+c.method+" "+p+" to batch.",0),"GET"!==c.method){var d=c.method,f=c.options.headers;Object(r.hOP)(c,"options")&&Object(r.hOP)(c.options,"headers")&&void 0!==f["X-HTTP-Method"]&&(d=f["X-HTTP-Method"],delete f["X-HTTP-Method"]),a.push(d+" "+p+" HTTP/1.1\n"),l.set("Content-Type","application/json;odata=verbose;charset=utf-8")}else a.push(c.method+" "+p+" HTTP/1.1\n");Object(r.mergeHeaders)(l,m.headers),c.options&&Object(r.mergeHeaders)(l,c.options.headers),l.has("Accept")||l.append("Accept","application/json"),l.has("Content-Type")||l.append("Content-Type","application/json;odata=verbose;charset=utf-8"),l.has("X-ClientService-ClientTag")||l.append("X-ClientService-ClientTag","PnPCoreJS:@pnp-1.2.6"),l.forEach(function(e,t){a.push(t+": "+e+"\n")}),a.push("\n"),c.options.body&&a.push(c.options.body+"\n\n")}s.length>0&&(a.push("--changeset_"+s+"--\n\n"),s=""),a.push("--batch_"+e.batchId+"--\n");var h={body:a.join(""),headers:{"Content-Type":"multipart/mixed; boundary=batch_"+e.batchId},method:"POST"};return o.a.write("["+e.batchId+"] ("+(new Date).getTime()+") Sending batch request.",1),n.fetch(Object(r.combine)(i,"/_api/$batch"),h).then(function(e){return e.text()}).then(t.ParseResponse).then(function(t){if(t.length!==e.requests.length)throw Error("Could not properly parse responses to match requests in batch.");return o.a.write("["+e.batchId+"] ("+(new Date).getTime()+") Resolving batched requests.",1),t.reduce(function(t,n,r){var i=e.requests[r];return o.a.write("["+i.id+"] ("+(new Date).getTime()+") Resolving request in batch "+e.batchId+".",1),t.then(function(e){return i.parser.parse(n).then(i.resolve).catch(i.reject)})},Promise.resolve())})})},t}(i.f);function st(e){return e.length<1?1:Math.max.apply(null,e.map(function(e){return e.order}))+1}function ut(e,t){void 0===t&&(t=0);var n=this.substring(t).search(e);return n>=0?n+t:n}function ct(e,t,n){var r=[];if(void 0===e||null===e)return r;var o=e.replace(/[\t\r\n]/g,""),i=ut.call(o,t);if(i<0)return r;for(;i>-1;){for(var a=1,s=i+1,u=-1,c=-1;;){if(u=ut.call(o,/<div[^>]*>/i,s),c=ut.call(o,/<\/div>/i,s),u<0&&(u=o.length+1),u<c?(a++,s=u+1):c<u&&(a--,s=c+1),0===a){var l=o.substring(i,c+6).trim();r.push(n(l));break}if(a>1e3||a<0)throw Error("getBoundedDivMarkup exceeded depth parameters.")}i=ut.call(o,t,c)}return r}function lt(e){for(var t=0;t<e.length;t++)e[t].order=t+1,Object(r.hOP)(e[t],"columns")?lt(e[t].columns):Object(r.hOP)(e[t],"controls")&&lt(e[t].controls)}!function(e){e[e.NotPromoted=0]="NotPromoted",e[e.PromoteOnPublish=1]="PromoteOnPublish",e[e.Promoted=2]="Promoted"}(rt||(rt={}));var pt=function(e){function t(t,n,r){void 0===n&&(n=[]),void 0===r&&(r=!1);var o=e.call(this,t)||this;return o.sections=n,o.commentsDisabled=r,o}return s(t,e),t.create=function(e,n,o,i){return void 0===i&&(i="Article"),e.rootFolder.files.select("Name").filter("Name eq '"+n+"'").get().then(function(a){if(a.length>0)throw Error("A file with the name '"+n+"' already exists in the library '"+e.toUrl()+"'.");return e.rootFolder.select("ServerRelativePath").get().then(function(a){var s=Object(r.combine)("/",a.ServerRelativePath.DecodedUrl,n);return e.rootFolder.files.addTemplateFile(s,le.ClientSidePage).then(function(e){return e.file.getItem().then(function(e){return e.update({BannerImageUrl:{Url:"/_layouts/15/images/sitepagethumbnail.png"},CanvasContent1:"",ClientSideApplicationId:"b6917cb1-93a0-4b97-a84d-7cf49975d4ec",ContentTypeId:"0x0101009D1CB255DA76424F860D91F20E6C4118",PageLayoutType:i,PromotedState:0,Title:o}).then(function(e){return new t(e.item.file,e.item.CommentsDisabled)})})})})})},t.fromFile=function(e){var n=new t(e);return n.load().then(function(e){return n})},t.jsonToEscapedString=function(e){return Object(r.jsS)(e).replace(/"/g,"&quot;").replace(/:/g,"&#58;").replace(/{/g,"&#123;").replace(/}/g,"&#125;").replace(/\[/g,"[").replace(/\]/g,"]").replace(/\./g,".")},t.escapedStringToJson=function(e){return JSON.parse(function(e){return[[/&quot;/g,'"'],[/&#58;/g,":"],[/&#123;/g,"{"],[/&#125;/g,"}"],[/\\\\/g,"\\"],[/\\\?/g,"?"],[/\\\./g,"."],[/\\\[/g,"["],[/\\\]/g,"]"],[/\\\(/g,"("],[/\\\)/g,")"],[/\\\|/g,"|"],[/\\\+/g,"+"]].reduce(function(e,t){return e.replace(t[0],t[1])},e)}(e))},t.prototype.addSection=function(){var e=new dt(this,st(this.sections));return this.sections.push(e),e},t.prototype.toHtml=function(){lt(this.sections);var e=[];e.push("<div>");for(var t=0;t<this.sections.length;t++)e.push(this.sections[t].toHtml());return e.push("</div>"),e.join("")},t.prototype.fromHtml=function(e){var t=this;return this.sections=[],ct(e,/<div\b[^>]*data-sp-canvascontrol[^>]*?>/i,function(e){var n=/controlType&quot;&#58;(\d*?),/i.exec(e),r=null;switch(null==n||n.length<2?0:parseInt(n[1],10)){case 0:(r=new ht(null,0)).fromHtml(e),t.mergeColumnToTree(r);break;case 3:(r=new mt("")).fromHtml(e),t.mergePartToTree(r);break;case 4:(r=new gt).fromHtml(e),t.mergePartToTree(r)}}),lt(this.sections),this},t.prototype.load=function(){var e=this;return this.getItem("CanvasContent1","CommentsDisabled").then(function(t){e.fromHtml(t.CanvasContent1),e.commentsDisabled=t.CommentsDisabled})},t.prototype.save=function(){return this.updateProperties({CanvasContent1:this.toHtml()})},t.prototype.enableComments=function(){var e=this;return this.setCommentsOn(!0).then(function(t){return e.commentsDisabled=!1,t})},t.prototype.disableComments=function(){var e=this;return this.setCommentsOn(!1).then(function(t){return e.commentsDisabled=!0,t})},t.prototype.findControlById=function(e){return this.findControl(function(t){return t.id===e})},t.prototype.findControl=function(e){for(var t=0;t<this.sections.length;t++)for(var n=0;n<this.sections[t].columns.length;n++)for(var r=0;r<this.sections[t].columns[n].controls.length;r++)if(e(this.sections[t].columns[n].controls[r]))return this.sections[t].columns[n].controls[r];return null},t.prototype.like=function(){return this.getItem().then(function(e){return e.like()})},t.prototype.unlike=function(){return this.getItem().then(function(e){return e.unlike()})},t.prototype.getLikedByInformation=function(){return this.getItem().then(function(e){return e.getLikedByInformation()})},t.prototype.setCommentsOn=function(e){return this.getItem().then(function(t){return new ze(t,"SetCommentsDisabled("+!e+")").update({})})},t.prototype.mergePartToTree=function(e){var t=null,n=null,r=this.sections.filter(function(t){return t.order===e.controlData.position.zoneIndex});r.length<1?(t=new dt(this,e.controlData.position.zoneIndex),this.sections.push(t)):t=r[0];var o=t.columns.filter(function(t){return t.order===e.controlData.position.sectionIndex});o.length<1?(n=new ht(t,e.controlData.position.sectionIndex,e.controlData.position.sectionFactor),t.columns.push(n)):n=o[0],e.column=n,n.addControl(e)},t.prototype.mergeColumnToTree=function(e){var t=null,n=this.sections.filter(function(t){return t.order===e.controlData.position.zoneIndex});n.length<1?(t=new dt(this,e.controlData.position.zoneIndex),this.sections.push(t)):t=n[0],e.section=t,t.columns.push(e)},t.prototype.updateProperties=function(e,t){return void 0===t&&(t="*"),this.getItem().then(function(n){return n.update(e,t)})},t}(et),dt=function(){function e(e,t,n){void 0===n&&(n=[]),this.page=e,this.order=t,this.columns=n,this._memId=Object(r.getGUID)()}return Object.defineProperty(e.prototype,"defaultColumn",{get:function(){return this.columns.length<1&&this.addColumn(12),this.columns[0]},enumerable:!0,configurable:!0}),e.prototype.addColumn=function(e){var t=new ht(this,st(this.columns),e);return this.columns.push(t),t},e.prototype.addControl=function(e){return this.defaultColumn.addControl(e),this},e.prototype.toHtml=function(){for(var e=[],t=0;t<this.columns.length;t++)e.push(this.columns[t].toHtml());return e.join("")},e.prototype.remove=function(){var e=this;this.page.sections=this.page.sections.filter(function(t){return t._memId!==e._memId}),lt(this.page.sections)},e}(),ft=function(){function e(e,t,n,o,i,a){void 0===n&&(n=null),void 0===o&&(o=1),void 0===i&&(i=Object(r.getGUID)()),void 0===a&&(a=null),this.controlType=e,this.dataVersion=t,this.column=n,this.order=o,this.id=i,this.controlData=a}return Object.defineProperty(e.prototype,"jsonData",{get:function(){return pt.jsonToEscapedString(this.getControlData())},enumerable:!0,configurable:!0}),e.prototype.fromHtml=function(e){this.controlData=pt.escapedStringToJson(Object(r.getAttrValueFromString)(e,"data-sp-controldata")),this.dataVersion=Object(r.getAttrValueFromString)(e,"data-sp-canvasdataversion"),this.controlType=this.controlData.controlType,this.id=this.controlData.id},e}(),ht=function(e){function t(t,n,r,o,i){void 0===r&&(r=12),void 0===o&&(o=[]),void 0===i&&(i="1.0");var a=e.call(this,0,i)||this;return a.section=t,a.order=n,a.factor=r,a.controls=o,a}return s(t,e),t.prototype.addControl=function(e){return e.column=this,this.controls.push(e),this},t.prototype.getControl=function(e){return this.controls[e]},t.prototype.toHtml=function(){var e=[];if(this.controls.length<1)e.push('<div data-sp-canvascontrol="" data-sp-canvasdataversion="'+this.dataVersion+'" data-sp-controldata="'+this.jsonData+'"></div>');else for(var t=0;t<this.controls.length;t++)e.push(this.controls[t].toHtml(t+1));return e.join("")},t.prototype.fromHtml=function(t){e.prototype.fromHtml.call(this,t),this.controlData=pt.escapedStringToJson(Object(r.getAttrValueFromString)(t,"data-sp-controldata")),this.factor=this.controlData.position.sectionFactor,this.order=this.controlData.position.sectionIndex},t.prototype.getControlData=function(){return{displayMode:2,position:{sectionFactor:this.factor,sectionIndex:this.order,zoneIndex:this.section.order}}},t.prototype.remove=function(){var e=this;this.section.columns=this.section.columns.filter(function(t){return t.id!==e.id}),lt(this.column.controls)},t}(ft),yt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t.prototype.remove=function(){var e=this;this.column.controls=this.column.controls.filter(function(t){return t.id!==e.id}),lt(this.column.controls)},t}(ft),gt=function(e){function t(t){void 0===t&&(t="");var n=e.call(this,4,"1.0")||this;return n.text=t,n}return s(t,e),Object.defineProperty(t.prototype,"text",{get:function(){return this._text},set:function(e){e.startsWith("<p>")||(e="<p>"+e+"</p>"),this._text=e},enumerable:!0,configurable:!0}),t.prototype.getControlData=function(){return{controlType:this.controlType,editorType:"CKEditor",id:this.id,position:{controlIndex:this.order,sectionFactor:this.column.factor,sectionIndex:this.column.order,zoneIndex:this.column.section.order}}},t.prototype.toHtml=function(e){this.order=e;var t=[];return t.push('<div data-sp-canvascontrol="" data-sp-canvasdataversion="'+this.dataVersion+'" data-sp-controldata="'+this.jsonData+'">'),t.push('<div data-sp-rte="">'),t.push(""+this.text),t.push("</div>"),t.push("</div>"),t.join("")},t.prototype.fromHtml=function(t){var n=this;e.prototype.fromHtml.call(this,t),this.text="",ct(t,/<div[^>]*data-sp-rte[^>]*>/i,function(e){var t=/<div[^>]*data-sp-rte[^>]*>(.*?)<\/div>$/i.exec(e);n.text=t.length>1?t[1]:""})},t}(yt),mt=function(e){function t(t,n,r,o,i,a,s){void 0===n&&(n=""),void 0===r&&(r={}),void 0===o&&(o=""),void 0===i&&(i=""),void 0===a&&(a=null),void 0===s&&(s="1.0");var u=e.call(this,3,"1.0")||this;return u.title=t,u.description=n,u.propertieJson=r,u.webPartId=o,u.htmlProperties=i,u.serverProcessedContent=a,u.canvasDataVersion=s,u}return s(t,e),t.fromComponentDef=function(e){var n=new t("");return n.import(e),n},t.prototype.import=function(e){this.webPartId=e.Id.replace(/^\{|\}$/g,"").toLowerCase();var t=JSON.parse(e.Manifest);this.title=t.preconfiguredEntries[0].title.default,this.description=t.preconfiguredEntries[0].description.default,this.dataVersion="1.0",this.propertieJson=this.parseJsonProperties(t.preconfiguredEntries[0].properties)},t.prototype.setProperties=function(e){return this.propertieJson=Object(r.extend)(this.propertieJson,e),this},t.prototype.getProperties=function(){return this.propertieJson},t.prototype.toHtml=function(e){this.order=e;var t={dataVersion:this.dataVersion,description:this.description,id:this.webPartId,instanceId:this.id,properties:this.propertieJson,serverProcessedContent:this.serverProcessedContent,title:this.title},n=[];return n.push('<div data-sp-canvascontrol="" data-sp-canvasdataversion="'+this.canvasDataVersion+'" data-sp-controldata="'+this.jsonData+'">'),n.push('<div data-sp-webpart="" data-sp-webpartdataversion="'+this.dataVersion+'" data-sp-webpartdata="'+pt.jsonToEscapedString(t)+'">'),n.push("<div data-sp-componentid>"),n.push(this.webPartId),n.push("</div>"),n.push('<div data-sp-htmlproperties="">'),n.push(this.renderHtmlProperties()),n.push("</div>"),n.push("</div>"),n.push("</div>"),n.join("")},t.prototype.fromHtml=function(t){e.prototype.fromHtml.call(this,t);var n=pt.escapedStringToJson(Object(r.getAttrValueFromString)(t,"data-sp-webpartdata"));this.title=n.title,this.description=n.description,this.webPartId=n.id,this.canvasDataVersion=Object(r.getAttrValueFromString)(t,"data-sp-canvasdataversion").replace(/\\\./,"."),this.dataVersion=Object(r.getAttrValueFromString)(t,"data-sp-webpartdataversion").replace(/\\\./,"."),this.setProperties(n.properties),void 0!==n.serverProcessedContent&&(this.serverProcessedContent=n.serverProcessedContent);var o=ct(t,/<div\b[^>]*data-sp-htmlproperties[^>]*?>/i,function(e){return e.replace(/^<div\b[^>]*data-sp-htmlproperties[^>]*?>/i,"").replace(/<\/div>$/i,"")});this.htmlProperties=o.length>0?o[0]:""},t.prototype.getControlData=function(){return{controlType:this.controlType,id:this.id,position:{controlIndex:this.order,sectionFactor:this.column.factor,sectionIndex:this.column.order,zoneIndex:this.column.section.order},webPartId:this.webPartId}},t.prototype.renderHtmlProperties=function(){var e=[];if(void 0===this.serverProcessedContent||null===this.serverProcessedContent)e.push(this.htmlProperties);else if(void 0!==this.serverProcessedContent){if(void 0!==this.serverProcessedContent.searchablePlainTexts)for(var t=Object.keys(this.serverProcessedContent.searchablePlainTexts),n=0;n<t.length;n++)e.push('<div data-sp-prop-name="'+t[n]+'" data-sp-searchableplaintext="true">'),e.push(this.serverProcessedContent.searchablePlainTexts[t[n]]),e.push("</div>");if(void 0!==this.serverProcessedContent.imageSources)for(t=Object.keys(this.serverProcessedContent.imageSources),n=0;n<t.length;n++)e.push('<img data-sp-prop-name="'+t[n]+'" src="'+this.serverProcessedContent.imageSources[t[n]]+'" />');if(void 0!==this.serverProcessedContent.links)for(t=Object.keys(this.serverProcessedContent.links),n=0;n<t.length;n++)e.push('<a data-sp-prop-name="'+t[n]+'" href="'+this.serverProcessedContent.links[t[n]]+'"></a>')}return e.join("")},t.prototype.parseJsonProperties=function(e){return void 0!==e.webPartData&&void 0!==e.webPartData.serverProcessedContent?this.serverProcessedContent=e.webPartData.serverProcessedContent:void 0!==e.serverProcessedContent?this.serverProcessedContent=e.serverProcessedContent:this.serverProcessedContent=null,void 0!==e.webPartData&&void 0!==e.webPartData.properties?e.webPartData.properties:void 0!==e.properties?e.properties:e},t}(yt),vt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t.prototype.getById=function(e){var t=new bt(this);return t.concat("("+e+")"),t},t.prototype.add=function(e,n,o){var i=this;void 0===o&&(o=!0);var a=Object(r.jsS)(Object(r.extend)(C("SP.NavigationNode"),{IsVisible:o,Title:e,Url:n}));return this.clone(t,null).postCore({body:a}).then(function(e){return{data:e,node:i.getById(e.Id)}})},t.prototype.moveAfter=function(e,n){var o=Object(r.jsS)({nodeId:e,previousNodeId:n});return this.clone(t,"MoveAfter").postCore({body:o})},t}(O),bt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),Object.defineProperty(t.prototype,"children",{get:function(){return new vt(this,"Children")},enumerable:!0,configurable:!0}),t.prototype.delete=function(){return e.prototype.deleteCore.call(this)},t.prototype.update=function(e){var t=this,n=Object(r.jsS)(Object(r.extend)({__metadata:{type:"SP.NavigationNode"}},e));return this.postCore({body:n,headers:{"X-HTTP-Method":"MERGE"}}).then(function(e){return{data:e,node:t}})},t}(P),St=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),Object.defineProperty(t.prototype,"quicklaunch",{get:function(){return new vt(this,"quicklaunch")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"topNavigationBar",{get:function(){return new vt(this,"topnavigationbar")},enumerable:!0,configurable:!0}),t=u([E("navigation")],t)}(w),_t=function(e){function t(t){return void 0===t&&(t=null),e.call(this,"_api/navigation",t)||this}return s(t,e),t.prototype.getMenuState=function(e,n,o,i){return void 0===e&&(e=null),void 0===n&&(n=10),void 0===o&&(o=null),void 0===i&&(i=null),new t("MenuState").postCore({body:Object(r.jsS)({customProperties:i,depth:n,mapProviderName:o,menuNodeKey:e})})},t.prototype.getMenuNodeKey=function(e,n){return void 0===n&&(n=null),new t("MenuNodeKey").postCore({body:Object(r.jsS)({currentUrl:e,mapProviderName:n})})},t}(w),Tt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),Object.defineProperty(t.prototype,"installedLanguages",{get:function(){return new It(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"globalInstalledLanguages",{get:function(){return new It(this,"globalinstalledlanguages")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"timeZone",{get:function(){return new Ct(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"timeZones",{get:function(){return new wt(this)},enumerable:!0,configurable:!0}),t=u([E("regionalsettings")],t)}(P),It=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t=u([E("installedlanguages")],t)}(O),Ct=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return s(t,e),n=t,t.prototype.utcToLocalTime=function(e){var t;return t="string"==typeof e?e:e.toISOString(),this.clone(n,"utctolocaltime('"+t+"')").postCore().then(function(e){return Object(r.hOP)(e,"UTCToLocalTime")?e.UTCToLocalTime:e})},t.prototype.localTimeToUTC=function(e){var t;return t="string"==typeof e?e:Object(r.dateAdd)(e,"minute",-1*e.getTimezoneOffset()).toISOString(),this.clone(n,"localtimetoutc('"+t+"')").postCore().then(function(e){return Object(r.hOP)(e,"LocalTimeToUTC")?e.LocalTimeToUTC:e})},t=n=u([E("timezone")],t)}(P),wt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return s(t,e),n=t,t.prototype.getById=function(e){return this.clone(n,"GetById("+e+")").postCore({},y(Ct))},t=n=u([E("timezones")],t)}(O),Ot=new Map([["text","Querytext"],["template","QueryTemplate"],["sourceId","SourceId"],["trimDuplicatesIncludeId",""],["startRow",""],["rowLimit",""],["rankingModelId",""],["rowsPerPage",""],["selectProperties",""],["culture",""],["timeZoneId",""],["refinementFilters",""],["refiners",""],["hiddenConstraints",""],["sortList",""],["timeout",""],["hithighlightedProperties",""],["clientType",""],["personalizationData",""],["resultsURL",""],["queryTag",""],["properties",""],["queryTemplatePropertiesUrl",""],["reorderingRules",""],["hitHighlightedMultivaluePropertyLimit",""],["collapseSpecification",""],["uiLanguage",""],["desiredSnippetLength",""],["maxSnippetLength",""],["summaryLength",""]]),Pt=new Map([]);function Et(e){return e.replace(/^(.)/,function(e){return e.toUpperCase()})}function xt(e,t){return void 0===e&&(e=""),void 0===t&&(t={}),new Proxy({query:Object.assign({Querytext:e},t)},{get:function(e,t,n){var r=t.toString();if("toSearchQuery"===r)return function(){return e.query};if(Ot.has(r))return function(){for(var t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];var i=Ot.get(r);return e.query[i.length>0?i:Et(r)]=t.length>1?t:t[0],n};var o=Pt.has(r)?Pt.get(r):Et(r);return e.query[o]=!0,n}})}var Nt,At,Rt,Mt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t.prototype.execute=function(e){var t=this,n=this.parseQuery(e),o=Object(r.jsS)({request:Object(r.extend)(C("Microsoft.Office.Server.Search.REST.SearchRequest"),Object.assign({},n,{HitHighlightedProperties:this.fixArrProp(n.HitHighlightedProperties),Properties:this.fixArrProp(n.Properties),RefinementFilters:this.fixArrProp(n.RefinementFilters),ReorderingRules:this.fixArrProp(n.ReorderingRules),SelectProperties:this.fixArrProp(n.SelectProperties),SortList:this.fixArrProp(n.SortList)}))});if(this._useCaching){this._forceCaching=!0;var a="PnPjs.SearchWithCaching("+Object(r.getHashCode)(o)+")";Object(r.objectDefinedNotNull)(this._cachingOptions)?/\/_api\/search\/postquery$/i.test(this._cachingOptions.key)&&(this._cachingOptions.key=a):this._cachingOptions=new i.c(a)}return this.postCore({body:o}).then(function(e){return new jt(e,t.toUrl(),n)})},t.prototype.fixArrProp=function(e){return void 0===e?{results:[]}:(e=Object(r.isArray)(e)?e:[e],Object(r.hOP)(e,"results")?e:{results:e})},t.prototype.parseQuery=function(e){return"string"==typeof e?{Querytext:e}:e.toSearchQuery?e.toSearchQuery():e},t=u([E("_api/search/postquery")],t)}(P),jt=function(){function e(e,t,n,r,o){void 0===r&&(r=null),void 0===o&&(o=null),this._url=t,this._query=n,this._raw=r,this._primary=o,this._raw=e.postquery?e.postquery:e}return Object.defineProperty(e.prototype,"ElapsedTime",{get:function(){return this.RawSearchResults.ElapsedTime},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"RowCount",{get:function(){return this.RawSearchResults.PrimaryQueryResult.RelevantResults.RowCount},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TotalRows",{get:function(){return this.RawSearchResults.PrimaryQueryResult.RelevantResults.TotalRows},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TotalRowsIncludingDuplicates",{get:function(){return this.RawSearchResults.PrimaryQueryResult.RelevantResults.TotalRowsIncludingDuplicates},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"RawSearchResults",{get:function(){return this._raw},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"PrimarySearchResults",{get:function(){return null===this._primary&&(this._primary=this.formatSearchResults(this._raw.PrimaryQueryResult.RelevantResults.Table.Rows)),this._primary},enumerable:!0,configurable:!0}),e.prototype.getPage=function(e,t){if(this.TotalRows<this.RowCount)return Promise.resolve(null);var n=void 0!==t?t:Object(r.hOP)(this._query,"RowLimit")?this._query.RowLimit:10,o=Object(r.extend)(this._query,{RowLimit:n,StartRow:n*(e-1)});return o.StartRow>this.TotalRows?Promise.resolve(null):new Mt(this._url,null).execute(o)},e.prototype.formatSearchResults=function(e){for(var t=new Array,n=0,r=e.results?e.results:e;n<r.length;n++){var o=r[n],i=o.Cells.results?o.Cells.results:o.Cells;t.push(i.reduce(function(e,t){return Object.defineProperty(e,t.Key,{configurable:!1,enumerable:!0,value:t.Value,writable:!1}),e},{}))}return t},e}();!function(e){e[e.Ascending=0]="Ascending",e[e.Descending=1]="Descending",e[e.FQLFormula=2]="FQLFormula"}(Nt||(Nt={})),function(e){e[e.ResultContainsKeyword=0]="ResultContainsKeyword",e[e.TitleContainsKeyword=1]="TitleContainsKeyword",e[e.TitleMatchesKeyword=2]="TitleMatchesKeyword",e[e.UrlStartsWith=3]="UrlStartsWith",e[e.UrlExactlyMatches=4]="UrlExactlyMatches",e[e.ContentTypeIs=5]="ContentTypeIs",e[e.FileExtensionMatches=6]="FileExtensionMatches",e[e.ResultHasTag=7]="ResultHasTag",e[e.ManualCondition=8]="ManualCondition"}(At||(At={})),function(e){e[e.None=0]="None",e[e.StringType=1]="StringType",e[e.Int32Type=2]="Int32Type",e[e.BooleanType=3]="BooleanType",e[e.StringArrayType=4]="StringArrayType",e[e.UnSupportedType=5]="UnSupportedType"}(Rt||(Rt={}));var Dt,Lt,kt,Ut,Ft=function(){function e(){}return e.Documents="e7ec8cee-ded8-43c9-beb5-436b54b31e84",e.ItemsMatchingContentType="5dc9f503-801e-4ced-8a2c-5d1237132419",e.ItemsMatchingTag="e1327b9c-2b8c-4b23-99c9-3730cb29c3f7",e.ItemsRelatedToCurrentUser="48fec42e-4a92-48ce-8363-c2703a40e67d",e.ItemsWithSameKeywordAsThisItem="5c069288-1d17-454a-8ac6-9c642a065f48",e.LocalPeopleResults="b09a7990-05ea-4af9-81ef-edfab16c4e31",e.LocalReportsAndDataResults="203fba36-2763-4060-9931-911ac8c0583b",e.LocalSharePointResults="8413cd39-2156-4e00-b54d-11efd9abdb89",e.LocalVideoResults="78b793ce-7956-4669-aa3b-451fc5defebf",e.Pages="5e34578e-4d08-4edc-8bf3-002acf3cdbcc",e.Pictures="38403c8c-3975-41a8-826e-717f2d41568a",e.Popular="97c71db1-58ce-4891-8b64-585bc2326c12",e.RecentlyChangedItems="ba63bbae-fa9c-42c0-b027-9a878f16557c",e.RecommendedItems="ec675252-14fa-4fbe-84dd-8d098ed74181",e.Wiki="9479bf85-e257-4318-b5a8-81a180f5faa1",e}(),Bt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t.prototype.execute=function(e){return this.mapQueryToQueryString(e),this.get().then(function(e){var t=Object(r.hOP)(e,"suggest")?function(t){return e.suggest[t].results}:function(t){return e[t]};return{PeopleNames:t("PeopleNames"),PersonalResults:t("PersonalResults"),Queries:t("Queries")}})},t.prototype.mapQueryToQueryString=function(e){var t=this;this.query.set("querytext","'"+e.querytext+"'");var n=function(e){return function(n){return function(o){Object(r.hOP)(e,n)&&t.query.set(o,e[n].toString())}}}(e);n("count")("inumberofquerysuggestions"),n("personalCount")("inumberofresultsuggestions"),n("preQuery")("fprequerysuggestions"),n("hitHighlighting")("fhithighlighting"),n("capitalize")("fcapitalizefirstletters"),n("culture")("culture"),n("stemming")("enablestemming"),n("includePeople")("showpeoplenamesuggestions"),n("queryRules")("enablequeryrules"),n("prefixMatch")("fprefixmatchallterms")},t=u([E("_api/search/suggest")],t)}(P),Gt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return s(t,e),n=t,t.prototype.add=function(e,t){var o=this;return void 0===t&&(t=!1),this.clone(n,"add").postCore({body:Object(r.jsS)({featdefScope:0,featureId:e,force:t})}).then(function(t){return{data:t,feature:o.getById(e)}})},t.prototype.getById=function(e){var t=new qt(this);return t.concat("('"+e+"')"),t},t.prototype.remove=function(e,t){return void 0===t&&(t=!1),this.clone(n,"remove").postCore({body:Object(r.jsS)({featureId:e,force:t})})},t=n=u([E("features")],t)}(O),qt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t.prototype.deactivate=function(e){var n=this;void 0===e&&(e=!1);var r=this.addBatchDependency();return new t(this).select("DefinitionId").get().then(function(t){var o=n.getParent(Gt,n.parentUrl,"",n.batch).remove(t.DefinitionId,e);return r(),o})},t}(P),Ht=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return s(t,e),n=t,t.FromUrl=function(e){if(null===e)return new n("");var t=e.indexOf("_api/");return new n(t>-1?e.substr(0,t):e)},t.prototype.getRelatedItems=function(e,t){var o=this.clone(n,null);return o.concat(".GetRelatedItems"),o.postCore({body:Object(r.jsS)({SourceItemID:t,SourceListName:e})})},t.prototype.getPageOneRelatedItems=function(e,t){var o=this.clone(n,null);return o.concat(".GetPageOneRelatedItems"),o.postCore({body:Object(r.jsS)({SourceItemID:t,SourceListName:e})})},t.prototype.addSingleLink=function(e,t,o,i,a,s,u){void 0===u&&(u=!1);var c=this.clone(n,null);return c.concat(".AddSingleLink"),c.postCore({body:Object(r.jsS)({SourceItemID:t,SourceListName:e,SourceWebUrl:o,TargetItemID:a,TargetListName:i,TargetWebUrl:s,TryAddReverseLink:u})})},t.prototype.addSingleLinkToUrl=function(e,t,o,i){void 0===i&&(i=!1);var a=this.clone(n,null);return a.concat(".AddSingleLinkToUrl"),a.postCore({body:Object(r.jsS)({SourceItemID:t,SourceListName:e,TargetItemUrl:o,TryAddReverseLink:i})})},t.prototype.addSingleLinkFromUrl=function(e,t,o,i){void 0===i&&(i=!1);var a=this.clone(n,null);return a.concat(".AddSingleLinkFromUrl"),a.postCore({body:Object(r.jsS)({SourceItemUrl:e,TargetItemID:o,TargetListName:t,TryAddReverseLink:i})})},t.prototype.deleteSingleLink=function(e,t,o,i,a,s,u){void 0===u&&(u=!1);var c=this.clone(n,null);return c.concat(".DeleteSingleLink"),c.postCore({body:Object(r.jsS)({SourceItemID:t,SourceListName:e,SourceWebUrl:o,TargetItemID:a,TargetListName:i,TargetWebUrl:s,TryDeleteReverseLink:u})})},t=n=u([E("_api/SP.RelatedItemManager")],t)}(w),Vt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return s(t,e),n=t,t.prototype.add=function(e,t,o,i,a,s){void 0===o&&(o=""),void 0===i&&(i="STS"),void 0===a&&(a=1033),void 0===s&&(s=!0);var u={Description:o,Language:a,Title:e,Url:t,UseSamePermissionsAsParentSite:s,WebTemplate:i},c=Object(r.jsS)({parameters:Object(r.extend)({__metadata:{type:"SP.WebCreationInformation"}},u)});return this.clone(n,"add").postCore({body:c}).then(function(e){return{data:e,web:new Kt(d(e).replace(/_api\/web\/?/i,""))}})},t=n=u([E("webs")],t)}(O),Wt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t=u([E("webinfos")],t)}(O),Kt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return s(t,e),n=t,t.fromUrl=function(e,t){return new n(p(e),t)},Object.defineProperty(t.prototype,"webs",{get:function(){return new Vt(this)},enumerable:!0,configurable:!0}),t.prototype.getParentWeb=function(){var e=this;return this.select("ParentWeb/Id").expand("ParentWeb").get().then(function(t){var n=t.ParentWeb;return new zt(e.toUrlAndQuery().split("/_api")[0]).openWebById(n.Id)})},t.prototype.getSubwebsFilteredForCurrentUser=function(e,t){return void 0===e&&(e=-1),void 0===t&&(t=-1),this.clone(Vt,"getSubwebsFilteredForCurrentUser(nWebTemplateFilter="+e+",nConfigurationFilter="+t+")")},Object.defineProperty(t.prototype,"allProperties",{get:function(){return this.clone(O,"allproperties")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"webinfos",{get:function(){return new Wt(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"contentTypes",{get:function(){return new Ce(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lists",{get:function(){return new Ge(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fields",{get:function(){return new Me(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"features",{get:function(){return new Gt(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"availablefields",{get:function(){return new Me(this,"availablefields")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"navigation",{get:function(){return new St(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"siteUsers",{get:function(){return new N(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"siteGroups",{get:function(){return new ee(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"siteUserInfoList",{get:function(){return new qe(this,"siteuserinfolist")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"regionalSettings",{get:function(){return new Tt(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentUser",{get:function(){return new M(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"folders",{get:function(){return new Te(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"userCustomActions",{get:function(){return new Fe(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"roleDefinitions",{get:function(){return new oe(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"relatedItems",{get:function(){return Ht.FromUrl(this.toUrl())},enumerable:!0,configurable:!0}),t.prototype.createBatch=function(){return new at(this.parentUrl)},Object.defineProperty(t.prototype,"rootFolder",{get:function(){return new Ie(this,"rootFolder")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"associatedOwnerGroup",{get:function(){return new te(this,"associatedownergroup")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"associatedMemberGroup",{get:function(){return new te(this,"associatedmembergroup")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"associatedVisitorGroup",{get:function(){return new te(this,"associatedvisitorgroup")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"defaultDocumentLibrary",{get:function(){return new qe(this,"DefaultDocumentLibrary")},enumerable:!0,configurable:!0}),t.prototype.getFolderByServerRelativeUrl=function(e){return new Ie(this,"getFolderByServerRelativeUrl('"+e+"')")},t.prototype.getFolderByServerRelativePath=function(e){return new Ie(this,"getFolderByServerRelativePath(decodedUrl='"+e+"')")},t.prototype.getFileByServerRelativeUrl=function(e){return new et(this,"getFileByServerRelativeUrl('"+e+"')")},t.prototype.getFileByServerRelativePath=function(e){return new et(this,"getFileByServerRelativePath(decodedUrl='"+e+"')")},t.prototype.getList=function(e){return new qe(this,"getList('"+e+"')")},t.prototype.update=function(e){var t=this,n=Object(r.jsS)(Object(r.extend)({__metadata:{type:"SP.Web"}},e));return this.postCore({body:n,headers:{"X-HTTP-Method":"MERGE"}}).then(function(e){return{data:e,web:t}})},t.prototype.delete=function(){return e.prototype.deleteCore.call(this)},t.prototype.applyTheme=function(e,t,o,i){var a=Object(r.jsS)({backgroundImageUrl:o,colorPaletteUrl:e,fontSchemeUrl:t,shareGenerated:i});return this.clone(n,"applytheme").postCore({body:a})},t.prototype.applyWebTemplate=function(e){var t=this.clone(n,"applywebtemplate");return t.concat("(@t)"),t.query.set("@t",e),t.postCore()},t.prototype.ensureUser=function(e){var t=Object(r.jsS)({logonName:e});return this.clone(n,"ensureuser").postCore({body:t}).then(function(e){return{data:e,user:new R(d(e))}})},t.prototype.availableWebTemplates=function(e,t){return void 0===e&&(e=1033),void 0===t&&(t=!0),new O(this,"getavailablewebtemplates(lcid="+e+", doincludecrosslanguage="+t+")")},t.prototype.getCatalog=function(e){return this.clone(n,"getcatalog("+e+")").select("Id").get().then(function(e){return new qe(d(e))})},t.prototype.getChanges=function(e){var t=Object(r.jsS)({query:Object(r.extend)({__metadata:{type:"SP.ChangeQuery"}},e)});return this.clone(n,"getchanges").postCore({body:t})},Object.defineProperty(t.prototype,"customListTemplate",{get:function(){return new O(this,"getcustomlisttemplates")},enumerable:!0,configurable:!0}),t.prototype.getUserById=function(e){return new R(this,"getUserById("+e+")")},t.prototype.mapToIcon=function(e,t,r){return void 0===t&&(t=0),void 0===r&&(r=""),this.clone(n,"maptoicon(filename='"+e+"', progid='"+r+"', size="+t+")").get()},t.prototype.getStorageEntity=function(e){return this.clone(n,"getStorageEntity('"+e+"')").get()},t.prototype.setStorageEntity=function(e,t,o,i){return void 0===o&&(o=""),void 0===i&&(i=""),this.clone(n,"setStorageEntity").postCore({body:Object(r.jsS)({comments:i,description:o,key:e,value:t})})},t.prototype.removeStorageEntity=function(e){return this.clone(n,"removeStorageEntity('"+e+"')").postCore()},t.prototype.getAppCatalog=function(e){return new ot(e||this)},t.prototype.getClientSideWebParts=function(){return this.clone(O,"GetClientSideWebParts").get()},t.prototype.addClientSidePage=function(e,t,n){return void 0===t&&(t=e.replace(/\.[^/.]+$/,"")),void 0===n&&(n="Site Pages"),pt.create(this.lists.getByTitle(n),e,t)},t.prototype.addClientSidePageByPath=function(e,t,n){return void 0===n&&(n=e.replace(/\.[^/.]+$/,"")),pt.create(this.getList(t),e,n)},t.prototype.createDefaultAssociatedGroups=function(e,t,r){var o=this.clone(n,"createDefaultAssociatedGroups(userLogin=@u,userLogin2=@v,groupNameSeed=@s)");return o.query.set("@u","'"+encodeURIComponent(e||"")+"'"),o.query.set("@v","'"+encodeURIComponent(t||"")+"'"),o.query.set("@s","'"+encodeURIComponent(r||"")+"'"),o.postCore()},t.prototype.hubSiteData=function(e){return void 0===e&&(e=!1),this.clone(n,"hubSiteData("+e+")").get()},t.prototype.syncHubSiteTheme=function(){return this.clone(n,"syncHubSiteTheme").postCore()},t=n=u([E("_api/web")],t)}(fe),zt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return s(t,e),n=t,Object.defineProperty(t.prototype,"rootWeb",{get:function(){return new Kt(this,"rootweb")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"features",{get:function(){return new Gt(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"userCustomActions",{get:function(){return new Fe(this)},enumerable:!0,configurable:!0}),t.prototype.getRootWeb=function(){return this.rootWeb.select("Url").get().then(function(e){return new Kt(e.Url)})},t.prototype.getContextInfo=function(){return new n(this.parentUrl,"_api/contextinfo").postCore().then(function(e){if(Object(r.hOP)(e,"GetContextWebInformation")){var t=e.GetContextWebInformation;return t.SupportedSchemaVersions=t.SupportedSchemaVersions.results,t}return e})},t.prototype.getDocumentLibraries=function(e){var t=new w("","_api/sp.web.getdocumentlibraries(@v)");return t.query.set("@v","'"+e+"'"),t.get().then(function(e){return Object(r.hOP)(e,"GetDocumentLibraries")?e.GetDocumentLibraries:e})},t.prototype.getWebUrlFromPageUrl=function(e){var t=new w("","_api/sp.web.getweburlfrompageurl(@v)");return t.query.set("@v","'"+e+"'"),t.get().then(function(e){return Object(r.hOP)(e,"GetWebUrlFromPageUrl")?e.GetWebUrlFromPageUrl:e})},t.prototype.createBatch=function(){return new at(this.parentUrl)},t.prototype.openWebById=function(e){return this.clone(n,"openWebById('"+e+"')").postCore().then(function(e){return{data:e,web:Kt.fromUrl(e["odata.id"]||e.__metadata.uri)}})},t.prototype.joinHubSite=function(e){return this.clone(n,"joinHubSite('"+e+"')").postCore()},t.prototype.registerHubSite=function(){return this.clone(n,"registerHubSite").postCore()},t.prototype.unRegisterHubSite=function(){return this.clone(n,"unRegisterHubSite").postCore()},t.prototype.createCommunicationSite=function(e,t,n,o,i,a,s){var u=this;void 0===t&&(t=1033),void 0===n&&(n=!1);var p={Classification:a,Description:i,Lcid:t,ShareByEmailEnabled:n,SiteDesignId:s,Title:e,Url:o,WebTemplate:"SITEPAGEPUBLISHING#0",WebTemplateExtensionId:"00000000-0000-0000-0000-000000000000"},d=Object(r.jsS)({request:Object(r.extend)({__metadata:{type:"Microsoft.SharePoint.Portal.SPSiteCreationRequest"}},p)});return this.getRootWeb().then(function(e){return c(u,void 0,void 0,function(){var t,n;return l(this,function(r){return t=new _,n=e.parentUrl+"/_api/SPSiteManager/Create",[2,t.post(n,{body:d,headers:{Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose;charset=utf-8"}}).then(function(e){return e.json()})]})})})},t.prototype.createModernTeamSite=function(e,t,n,o,i,a,s){var u=this;void 0===n&&(n=!0),void 0===o&&(o=1033),void 0===i&&(i=""),void 0===a&&(a="");var p=Object(r.jsS)({alias:t,displayName:e,isPublic:n,optionalParams:{Classification:a,CreationOptions:{results:["SPSiteLanguage:"+o]},Description:i,Owners:{results:s||[]}}});return this.getRootWeb().then(function(e){return c(u,void 0,void 0,function(){var t,n;return l(this,function(r){return t=new _,n=e.parentUrl+"/_api/GroupSiteManager/CreateGroupEx",[2,t.post(n,{body:p,headers:{Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose;charset=utf-8"}}).then(function(e){return e.json()})]})})})},t=n=u([E("_api/site")],t)}(P),$t=function(e){function t(t,n){void 0===n&&(n="_api/sp.userprofiles.peoplemanager");var r=e.call(this,t,n)||this;return r.clientPeoplePickerQuery=new Xt(t).configureFrom(r),r.profileLoader=new Qt(t).configureFrom(r),r}return s(t,e),Object.defineProperty(t.prototype,"editProfileLink",{get:function(){return this.clone(t,"EditProfileLink").get()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isMyPeopleListPublic",{get:function(){return this.clone(t,"IsMyPeopleListPublic").get()},enumerable:!0,configurable:!0}),t.prototype.amIFollowedBy=function(e){var n=this.clone(t,"amifollowedby(@v)");return n.query.set("@v","'"+encodeURIComponent(e)+"'"),n.get()},t.prototype.amIFollowing=function(e){var n=this.clone(t,"amifollowing(@v)");return n.query.set("@v","'"+encodeURIComponent(e)+"'"),n.get()},t.prototype.getFollowedTags=function(e){return void 0===e&&(e=20),this.clone(t,"getfollowedtags("+e+")").get()},t.prototype.getFollowersFor=function(e){var n=this.clone(t,"getfollowersfor(@v)");return n.query.set("@v","'"+encodeURIComponent(e)+"'"),n.get()},Object.defineProperty(t.prototype,"myFollowers",{get:function(){return new O(this,"getmyfollowers")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"myProperties",{get:function(){return new t(this,"getmyproperties")},enumerable:!0,configurable:!0}),t.prototype.getPeopleFollowedBy=function(e){var n=this.clone(t,"getpeoplefollowedby(@v)");return n.query.set("@v","'"+encodeURIComponent(e)+"'"),n.get()},t.prototype.getPropertiesFor=function(e){var n=this.clone(t,"getpropertiesfor(@v)");return n.query.set("@v","'"+encodeURIComponent(e)+"'"),n.get()},Object.defineProperty(t.prototype,"trendingTags",{get:function(){var e=this.clone(t,null);return e.concat(".gettrendingtags"),e.get()},enumerable:!0,configurable:!0}),t.prototype.getUserProfilePropertyFor=function(e,n){var r=this.clone(t,"getuserprofilepropertyfor(accountname=@v, propertyname='"+n+"')");return r.query.set("@v","'"+encodeURIComponent(e)+"'"),r.get()},t.prototype.hideSuggestion=function(e){var n=this.clone(t,"hidesuggestion(@v)");return n.query.set("@v","'"+encodeURIComponent(e)+"'"),n.postCore()},t.prototype.isFollowing=function(e,n){var r=this.clone(t,null);return r.concat(".isfollowing(possiblefolloweraccountname=@v, possiblefolloweeaccountname=@y)"),r.query.set("@v","'"+encodeURIComponent(e)+"'"),r.query.set("@y","'"+encodeURIComponent(n)+"'"),r.get()},t.prototype.setMyProfilePic=function(e){var n=this;return new Promise(function(r,o){var i=null,a=new FileReader;a.onload=function(e){return i=e.target.result},a.readAsArrayBuffer(e),new t(n,"setmyprofilepicture").postCore({body:String.fromCharCode.apply(null,new Uint16Array(i))}).then(function(e){return r()}).catch(function(e){return o(e)})})},t.prototype.setSingleValueProfileProperty=function(e,n,o){var i=Object(r.jsS)({accountName:e,propertyName:n,propertyValue:o});return this.clone(t,"SetSingleValueProfileProperty").postCore({body:i})},t.prototype.setMultiValuedProfileProperty=function(e,n,o){var i=Object(r.jsS)({accountName:e,propertyName:n,propertyValues:o});return this.clone(t,"SetMultiValuedProfileProperty").postCore({body:i})},t.prototype.createPersonalSiteEnqueueBulk=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.profileLoader.createPersonalSiteEnqueueBulk(e)},Object.defineProperty(t.prototype,"ownerUserProfile",{get:function(){return this.profileLoader.ownerUserProfile},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"userProfile",{get:function(){return this.profileLoader.userProfile},enumerable:!0,configurable:!0}),t.prototype.createPersonalSite=function(e){return void 0===e&&(e=!1),this.profileLoader.createPersonalSite(e)},t.prototype.shareAllSocialData=function(e){return this.profileLoader.shareAllSocialData(e)},t.prototype.clientPeoplePickerResolveUser=function(e){return this.clientPeoplePickerQuery.clientPeoplePickerResolveUser(e)},t.prototype.clientPeoplePickerSearchUser=function(e){return this.clientPeoplePickerQuery.clientPeoplePickerSearchUser(e)},t}(P),Qt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return s(t,e),n=t,t.prototype.createPersonalSiteEnqueueBulk=function(e){return this.clone(n,"createpersonalsiteenqueuebulk",!1).postCore({body:Object(r.jsS)({emailIDs:e})})},Object.defineProperty(t.prototype,"ownerUserProfile",{get:function(){var e=this.getParent(n,this.parentUrl,"_api/sp.userprofiles.profileloader.getowneruserprofile");return this.hasBatch&&(e=e.inBatch(this.batch)),e.postCore()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"userProfile",{get:function(){return this.clone(n,"getuserprofile").postCore()},enumerable:!0,configurable:!0}),t.prototype.createPersonalSite=function(e){return void 0===e&&(e=!1),this.clone(n,"getuserprofile/createpersonalsiteenque("+e+")").postCore()},t.prototype.shareAllSocialData=function(e){return this.clone(n,"getuserprofile/shareallsocialdata("+e+")").postCore()},t=n=u([E("_api/sp.userprofiles.profileloader.getprofileloader")],t)}(w),Xt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return s(t,e),n=t,t.prototype.clientPeoplePickerResolveUser=function(e){var t=this.clone(n,null);return t.concat(".clientpeoplepickerresolveuser"),t.postCore({body:this.createClientPeoplePickerQueryParametersRequestBody(e)}).then(function(e){return"object"==typeof e?e.ClientPeoplePickerResolveUser:e}).then(JSON.parse)},t.prototype.clientPeoplePickerSearchUser=function(e){var t=this.clone(n,null);return t.concat(".clientpeoplepickersearchuser"),t.postCore({body:this.createClientPeoplePickerQueryParametersRequestBody(e)}).then(function(e){return"object"==typeof e?e.ClientPeoplePickerSearchUser:e}).then(JSON.parse)},t.prototype.createClientPeoplePickerQueryParametersRequestBody=function(e){return Object(r.jsS)({queryParams:Object(r.extend)(C("SP.UI.ApplicationPages.ClientPeoplePickerQueryParameters"),e)})},t=n=u([E("_api/sp.ui.applicationpages.clientpeoplepickerwebserviceinterface")],t)}(w),Yt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return s(t,e),n=t,Object.defineProperty(t.prototype,"my",{get:function(){return new Jt(this)},enumerable:!0,configurable:!0}),t.prototype.getFollowedSitesUri=function(){return this.clone(n,"FollowedSitesUri").get().then(function(e){return e.FollowedSitesUri||e})},t.prototype.getFollowedDocumentsUri=function(){return this.clone(n,"FollowedDocumentsUri").get().then(function(e){return e.FollowedDocumentsUri||e})},t.prototype.follow=function(e){return this.clone(n,"follow").postCore({body:this.createSocialActorInfoRequestBody(e)})},t.prototype.isFollowed=function(e){return this.clone(n,"isfollowed").postCore({body:this.createSocialActorInfoRequestBody(e)})},t.prototype.stopFollowing=function(e){return this.clone(n,"stopfollowing").postCore({body:this.createSocialActorInfoRequestBody(e)})},t.prototype.createSocialActorInfoRequestBody=function(e){return Object(r.jsS)({actor:Object.assign(C("SP.Social.SocialActorInfo"),{Id:null},e)})},t=n=u([E("_api/social.following")],t)}(P),Jt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return s(t,e),n=t,t.prototype.followed=function(e){return this.clone(n,"followed(types="+e+")").get().then(function(e){return Object(r.hOP)(e,"Followed")?e.Followed.results:e})},t.prototype.followedCount=function(e){return this.clone(n,"followedcount(types="+e+")").get().then(function(e){return e.FollowedCount||e})},t.prototype.followers=function(){return this.clone(n,"followers").get().then(function(e){return Object(r.hOP)(e,"Followers")?e.Followers.results:e})},t.prototype.suggestions=function(){return this.clone(n,"suggestions").get().then(function(e){return Object(r.hOP)(e,"Suggestions")?e.Suggestions.results:e})},t=n=u([E("my")],t)}(P);!function(e){e[e.User=0]="User",e[e.Document=1]="Document",e[e.Site=2]="Site",e[e.Tag=3]="Tag"}(Dt||(Dt={})),function(e){e[e.None=0]="None",e[e.User=1]="User",e[e.Document=2]="Document",e[e.Site=4]="Site",e[e.Tag=8]="Tag",e[e.ExcludeContentWithoutFeeds=268435456]="ExcludeContentWithoutFeeds",e[e.IncludeGroupsSites=536870912]="IncludeGroupsSites",e[e.WithinLast24Hours=1073741824]="WithinLast24Hours"}(Lt||(Lt={})),function(e){e[e.Ok=0]="Ok",e[e.AlreadyFollowing=1]="AlreadyFollowing",e[e.LimitReached=2]="LimitReached",e[e.InternalError=3]="InternalError"}(kt||(kt={})),function(e){e[e.OK=0]="OK",e[e.InvalidRequest=1]="InvalidRequest",e[e.AccessDenied=2]="AccessDenied",e[e.ItemNotFound=3]="ItemNotFound",e[e.InvalidOperation=4]="InvalidOperation",e[e.ItemNotModified=5]="ItemNotModified",e[e.InternalError=6]="InternalError",e[e.CacheReadError=7]="CacheReadError",e[e.CacheUpdateError=8]="CacheUpdateError",e[e.PersonalSiteNotFound=9]="PersonalSiteNotFound",e[e.FailedToCreatePersonalSite=10]="FailedToCreatePersonalSite",e[e.NotAuthorizedToCreatePersonalSite=11]="NotAuthorizedToCreatePersonalSite",e[e.CannotCreatePersonalSite=12]="CannotCreatePersonalSite",e[e.LimitReached=13]="LimitReached",e[e.AttachmentError=14]="AttachmentError",e[e.PartialData=15]="PartialData",e[e.FeatureDisabled=16]="FeatureDisabled",e[e.StorageQuotaExceeded=17]="StorageQuotaExceeded",e[e.DatabaseError=18]="DatabaseError"}(Ut||(Ut={}));var Zt=function(e){function t(n,r){return e.call(this,t.getBaseUrl(n),"_api/Microsoft.Sharepoint.Utilities.WebTemplateExtensions.SiteScriptUtility."+r)||this}return s(t,e),t.getBaseUrl=function(e){if("string"==typeof e)return e;var t=e.toUrl(),n=t.indexOf("_api/");return n<0?t:t.substr(0,n)},t.prototype.execute=function(e){return this.postCore({body:JSON.stringify(e)})},t.prototype.getSiteScripts=function(){return this.clone(t,"GetSiteScripts",!0).execute({})},t.prototype.createSiteScript=function(e,n,r){return c(this,void 0,void 0,function(){return l(this,function(o){switch(o.label){case 0:return[4,this.clone(t,"CreateSiteScript(Title=@title,Description=@desc)?@title='"+encodeURIComponent(e)+"'&@desc='"+encodeURIComponent(n)+"'").execute(r)];case 1:return[2,o.sent()]}})})},t.prototype.getSiteScriptMetadata=function(e){return c(this,void 0,void 0,function(){return l(this,function(n){switch(n.label){case 0:return[4,this.clone(t,"GetSiteScriptMetadata").execute({id:e})];case 1:return[2,n.sent()]}})})},t.prototype.deleteSiteScript=function(e){return c(this,void 0,void 0,function(){return l(this,function(n){switch(n.label){case 0:return[4,this.clone(t,"DeleteSiteScript").execute({id:e})];case 1:return n.sent(),[2]}})})},t.prototype.updateSiteScript=function(e,n){return c(this,void 0,void 0,function(){return l(this,function(r){switch(r.label){case 0:return n&&(e.Content=JSON.stringify(n)),[4,this.clone(t,"UpdateSiteScript").execute({updateInfo:e})];case 1:return[2,r.sent()]}})})},t}(w),en=function(e){function t(n,r){return e.call(this,t.getBaseUrl(n),"_api/Microsoft.Sharepoint.Utilities.WebTemplateExtensions.SiteScriptUtility."+r)||this}return s(t,e),t.getBaseUrl=function(e){if("string"==typeof e)return e;var t=e.toUrl(),n=t.indexOf("_api/");return n<0?t:t.substr(0,n)},t.prototype.execute=function(e){return this.postCore({body:JSON.stringify(e),headers:{"Content-Type":"application/json;charset=utf-8"}})},t.prototype.createSiteDesign=function(e){return c(this,void 0,void 0,function(){return l(this,function(n){switch(n.label){case 0:return[4,this.clone(t,"CreateSiteDesign").execute({info:e})];case 1:return[2,n.sent()]}})})},t.prototype.applySiteDesign=function(e,n){return c(this,void 0,void 0,function(){return l(this,function(r){switch(r.label){case 0:return[4,this.clone(t,"ApplySiteDesign").execute({siteDesignId:e,webUrl:n})];case 1:return[2,r.sent()]}})})},t.prototype.getSiteDesigns=function(){return c(this,void 0,void 0,function(){return l(this,function(e){switch(e.label){case 0:return[4,this.clone(t,"GetSiteDesigns").execute({})];case 1:return[2,e.sent()]}})})},t.prototype.getSiteDesignMetadata=function(e){return c(this,void 0,void 0,function(){return l(this,function(n){switch(n.label){case 0:return[4,this.clone(t,"GetSiteDesignMetadata").execute({id:e})];case 1:return[2,n.sent()]}})})},t.prototype.updateSiteDesign=function(e){return c(this,void 0,void 0,function(){return l(this,function(n){switch(n.label){case 0:return[4,this.clone(t,"UpdateSiteDesign").execute({updateInfo:e})];case 1:return[2,n.sent()]}})})},t.prototype.deleteSiteDesign=function(e){return c(this,void 0,void 0,function(){return l(this,function(n){switch(n.label){case 0:return[4,this.clone(t,"DeleteSiteDesign").execute({id:e})];case 1:return[2,n.sent()]}})})},t.prototype.getSiteDesignRights=function(e){return c(this,void 0,void 0,function(){return l(this,function(n){switch(n.label){case 0:return[4,this.clone(t,"GetSiteDesignRights").execute({id:e})];case 1:return[2,n.sent()]}})})},t.prototype.grantSiteDesignRights=function(e,n,r){return void 0===r&&(r=1),c(this,void 0,void 0,function(){return l(this,function(o){switch(o.label){case 0:return[4,this.clone(t,"GrantSiteDesignRights").execute({grantedRights:r.toString(),id:e,principalNames:n})];case 1:return[2,o.sent()]}})})},t.prototype.revokeSiteDesignRights=function(e,n){return c(this,void 0,void 0,function(){return l(this,function(r){switch(r.label){case 0:return[4,this.clone(t,"RevokeSiteDesignRights").execute({id:e,principalNames:n})];case 1:return[2,r.sent()]}})})},t}(w),tn=function(e){function t(n,r){return e.call(this,t.getBaseUrl(n),"_api/SP.Utilities.Utility."+r)||this}return s(t,e),t.getBaseUrl=function(e){if("string"==typeof e)return e;var t=e.toUrl(),n=t.indexOf("_api/");return n<0?t:t.substr(0,n)},t.prototype.excute=function(e){return this.postCore({body:Object(r.jsS)(e)})},t.prototype.sendEmail=function(e){var n={properties:Object(r.extend)(C("SP.Utilities.EmailProperties"),{Body:e.Body,From:e.From,Subject:e.Subject})};return e.To&&e.To.length>0&&(n.properties=Object(r.extend)(n.properties,{To:{results:e.To}})),e.CC&&e.CC.length>0&&(n.properties=Object(r.extend)(n.properties,{CC:{results:e.CC}})),e.BCC&&e.BCC.length>0&&(n.properties=Object(r.extend)(n.properties,{BCC:{results:e.BCC}})),e.AdditionalHeaders&&(n.properties=Object(r.extend)(n.properties,{AdditionalHeaders:e.AdditionalHeaders})),this.clone(t,"SendEmail",!0).excute(n)},t.prototype.getCurrentUserEmailAddresses=function(){return this.clone(t,"GetCurrentUserEmailAddresses",!0).excute({})},t.prototype.resolvePrincipal=function(e,n,r,o,i,a){void 0===a&&(a=!1);var s={addToUserInfoList:i,input:e,inputIsEmailOnly:o,matchUserInfoList:a,scopes:n,sources:r};return this.clone(t,"ResolvePrincipalInCurrentContext",!0).excute(s)},t.prototype.searchPrincipals=function(e,n,r,o,i){var a={groupName:o,input:e,maxCount:i,scopes:n,sources:r};return this.clone(t,"SearchPrincipalsUsingContextWeb",!0).excute(a)},t.prototype.createEmailBodyForInvitation=function(e){var n={pageAddress:e};return this.clone(t,"CreateEmailBodyForInvitation",!0).excute(n)},t.prototype.expandGroupsToPrincipals=function(e,n){void 0===n&&(n=30);var r={inputs:e,maxCount:n};return this.clone(t,"ExpandGroupsToPrincipals",!0).excute(r)},t.prototype.createWikiPage=function(e){return this.clone(t,"CreateWikiPageInContextWeb",!0).excute({parameters:e}).then(function(e){return{data:e,file:new et(d(e))}})},t.prototype.containsInvalidFileFolderChars=function(e,n){return void 0===n&&(n=!1),n?t.InvalidFileFolderNameCharsOnPremiseRegex.test(e):t.InvalidFileFolderNameCharsOnlineRegex.test(e)},t.prototype.stripInvalidFileFolderChars=function(e,n,r){return void 0===n&&(n=""),void 0===r&&(r=!1),r?e.replace(t.InvalidFileFolderNameCharsOnPremiseRegex,n):e.replace(t.InvalidFileFolderNameCharsOnlineRegex,n)},t.InvalidFileFolderNameCharsOnlineRegex=/["*:<>?/\\|\x00-\x1f\x7f-\x9f]/g,t.InvalidFileFolderNameCharsOnPremiseRegex=/["#%*:<>?/\\|\x00-\x1f\x7f-\x9f]/g,t}(w),nn=function(){function e(e,t){void 0===e&&(e={}),void 0===t&&(t=""),this._options=e,this._baseUrl=t}return e.prototype.configure=function(t,n){return void 0===n&&(n=""),new e(t,n)},e.prototype.setup=function(e){!function(e){r.RuntimeConfig.extend(e)}(e)},e.prototype.searchSuggest=function(e){var t;return t="string"==typeof e?{querytext:e}:e,this.create(Bt).execute(t)},e.prototype.search=function(e){return this.create(Mt).execute(e)},e.prototype.searchWithCaching=function(e,t){return this.create(Mt).usingCaching(t).execute(e)},Object.defineProperty(e.prototype,"site",{get:function(){return this.create(zt)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"web",{get:function(){return this.create(Kt)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"profiles",{get:function(){return this.create($t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"social",{get:function(){return this.create(Yt)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"navigation",{get:function(){return new _t},enumerable:!0,configurable:!0}),e.prototype.createBatch=function(){return this.web.createBatch()},Object.defineProperty(e.prototype,"utility",{get:function(){return this.create(tn,"")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"siteScripts",{get:function(){return this.create(Zt,"")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"siteDesigns",{get:function(){return this.create(en,"")},enumerable:!0,configurable:!0}),e.prototype.create=function(e,t){return new e(this._baseUrl,t).configure(this._options)},e}(),rn=new nn}.call(this,n(5))},function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){!function(e){e.ID="ID",e.TITLE="Title",e.NAME="Name",e.ENCODED_ABS_URL="EncodedAbsUrl",e.CANVAS_CONTENT_1="CanvasContent1",e.CONTENT_TYPE_ID="ContentTypeId",e.AUTHOR="Author",e.CREATED="Created",e.BANNERIMAGEURL="BannerImageUrl",e.LAYOUTWEBPARTSCONTENT="LayoutWebpartsContent",e.SHARE_ORGANIZATIONS="ShareOrganizations",function(e){e.CAMPAIGN_URL="ShareUrlText",e.ARCHIVED="ShareArchived"}(e.Campaigns||(e.Campaigns={})),function(e){e.MYLINK_URL="ShareUrlText",e.MYLINK_ORDER="ShareMyLinkOrder"}(e.MyLinks||(e.MyLinks={})),function(e){e.URL="ShareSiteURL",e.ACCESS_LEVEL="ShareAccessLevel"}(e.CollaborationSites||(e.CollaborationSites={})),function(e){e.ID_FOR_TERM="IdForTerm"}(e.TaxonomyList||(e.TaxonomyList={}))}(e.ColumnNames||(e.ColumnNames={})),function(e){e.CAMPAIGNS="ShareCampaigns",e.SITE_PAGES="SitePages",e.MYLINKS="ShareMyLinks",e.SITE_ASSETS="SiteAssets",e.COLLABORATION_SITES="Sites",e.TAXONOMY_LIST="TaxonomyHiddenList",e.LOCALSITES_SITECATALOG_LISTITLE="Local Site Requests"}(e.ListInternalNames||(e.ListInternalNames={})),function(e){e.STARTPAGE_CAMPAIGNS="ShareStartpageCampaigns",e.STARTPAGE_NEWS_CORPORATENEWS="ShareStartpageNewsWebPartCorporateNews",e.STARTPAGE_NEWS_MYNEWS="ShareStartpageNewsWebPartMyNews",e.STARTPAGE_NEWS_LOCATION_TERMS="ShareStartpageNewsWebPartLocationTerms",e.STARTPAGE_NEWS_ORGANIZATION_TERMS="ShareStartpageNewsWebPartOrganizationTerms",e.STARTPAGE_MYLINKS="ShareStartpageMyLinks",e.STARTPAGE_MYLINKSLOCKCACHE="ShareStartpageMyLinksLockCache",e.STARTPAGE_MYLINKS_VIEWS_VIEW="ShareStartpageMyLinksViewsView",e.STARTPAGE_MYLINKS_VIEWS_MANAGE="ShareStartpageMyLinksViewsManage",e.USER_PROPERTIES="ShareUserProperties",e.NEWSPORTAL_NEWS_TOPSTORIES="ShareNewsPortalNewsWebPartTopStories",e.NEWSPORTAL_ALLNEWS_LIST="ShareNewsPortalNewsWebPartAllNewsList",e.NEWSPORTAL_MYNEWS_LIST="ShareNewsPortalNewsWebPartMyNewsList",e.NEWSPORTAL_NEWS_PUBLISHED="ShareNewsPortalNewsWebPartPublishedNews",e.TERM_ID_SITE_COLLECTION="ShareTermIDSiteCollection",e.COLLABORATION_MY_ORGANIZATION_COLLABORATION_SITES="ShareCollaborationMyOrganizationCollaborationSites",e.PORTABLE_NEWS_LOCAL="SharePortableNewsWebPart",e.STARTPAGEQA_INSTRUMENTATIONKEY="ShareStartPageWebpartsQA_InstrumentationKey",e.STARTPAGEUAT_INSTRUMENTATIONKEY="ShareStartPageWebpartsUAT_InstrumentationKey",e.STARTPAGE_INSTRUMENTATIONKEY="ShareStartPageWebparts_InstrumentationKey",e.SHARE_NAME="Share",e.PUBLIC_CDN_STANDARD_URL="https://publiccdn.sharepointonline.com",e.CDN_SITE_URL="sites/cdn",e.ALERTS="ShareAlerts"}(e.CacheKeys||(e.CacheKeys={})),function(e){e.SHARE_LOCATIONS="owstaxIdShareLocations",e.SHARE_ORGANIZATIONS="owstaxIdShareOrganizations",e.SHARE_CATEGORIES="owstaxIdShareCategories",e.TITLE="Title",e.PATH="Path",e.LAST_MODIFIED_TIME="LastModifiedTime",e.PICTURE_THUMBNAIL_URL="PictureThumbnailURL",e.VIEWS_LIFE_TIME="ViewsLifeTime",e.DESCRIPTION="Description",e.CONTENT_TYPE_ID="ContentTypeId",e.PUBLISHING_START="RefinableDateSingle00",e.PUBLISHING_END="RefinableDateSingle01",e.LIST_ITEM_ID="ListItemID",e.CREATED_BY="CreatedBy",e.WEB_URL="SPWebUrl"}(e.ManagedProperties||(e.ManagedProperties={})),function(e){e.SHARE_CORPORATE_NEWS="Share Corporate News",e.SHARE_NEWS="Share News",e.SHARE_ALL_NEWS="Share All News",e.SHARE_SCHEDULED_NEWS="Share Scheduled News"}(e.ResultSources||(e.ResultSources={})),function(e){!function(e){e.ORGANIZATIONS="3fe02a12-17b0-4ff8-88e0-b407eadc6fdd",e.LOCATIONS="039fc1a5-7f07-40fe-87d8-5685169d16f0",e.CATEGORIES="a04735e8-4973-4469-a8c8-5e6fa81594ac",e.CHANNELS="39f04728-d576-4a10-bf58-6bee422f92ff"}(e.TermSetGUIDs||(e.TermSetGUIDs={})),function(e){e.ORGANIZATIONS="Organizations",e.LOCATIONS="Locations",e.TOPICS="Categories"}(e.TermSetName||(e.TermSetName={})),function(e){e.ID="Id",e.NAME="Name",e.PATH_OF_TERM="PathOfTerm"}(e.TermProperties||(e.TermProperties={})),function(e){e.QUERY_EXACT_TERM_PREFIX="GP0|#0"}(e.TermsGeneral||(e.TermsGeneral={}))}(e.Terms||(e.Terms={})),function(e){e.SHARE_ORGANIZATION="ShareOrganization",e.SHARE_ORGANIZATION_ID="ShareOrganizationID",e.SHARE_LOCATION="ShareLocation",e.SHARE_LOCATION_ID="ShareLocationID",e.SHARE_TOPICS="ShareTopics",e.SHARE_TOPICS_IDS="ShareTopicsIDs",e.SHARE_MYLINKS_LOCATION="ShareMyLinksLocation"}(e.UserProfileProperties||(e.UserProfileProperties={})),function(e){!function(e){e.CORPORATE_NEWS="Corporate News",e.NEWS="News",e.CORPORATE_NEWS_TEMPLATES="Corporate News Templates",e.NEWS_TEMPLATES="News Templates",e.NEWS_TEMPLATES_ALL="Templates"}(e.NewsSitePages||(e.NewsSitePages={})),function(e){e.NEWS_TEMPLATES="News Template"}(e.NewsSiteAssets||(e.NewsSiteAssets={}))}(e.FolderNames||(e.FolderNames={})),function(e){e.SHARE_NEWS_TITLE="Title",e.SHARE_PUBLISHING_START_DATE="SharePublishingStartDate",e.SHARE_PUBLISHING_END_DATE="SharePublishingEndDate",e.SHARE_ORGANIZATIONS="ac4ca612b48c45b899985d601cd7e7e8",e.SHARE_LOCATIONS="b3eebddcc52c44a1806bfaf5e975dc3b",e.SHARE_CATEGORIES="d1da478974a1451395ba47f5d994f760",e.SHARE_CONTENTTYPEID="ContentTypeId",e.SHARE_NEWS_TEMPLATE_TYPE="ShareNewsTemplateType"}(e.NewsFields||(e.NewsFields={})),function(e){e.ACCOUNT_NAME_PREFIX="i:0#.f|membership|",e.DD_GENERAL="General",e.DD_ORGNIZATION_NEWS="Organization News",e.NEWS_TEMPLATE="NewsTemplate.aspx",e.CORPORATE_NEWS_TEMPLATE="CorporateNewsTemplate.aspx",e.ORGANIZATION_NEWS_TEMPLATE="OrganizationNewsTemplate.aspx"}(e.General||(e.General={})),function(e){!function(e){e.NEWS_DEFAULT_IMAGE="AL_News_Empty.PNG"}(e.NewsSiteAssets||(e.NewsSiteAssets={})),function(e){e.NewsPortalPage="NewsPortal.aspx",e.StartPage="Home.aspx"}(e.SitePages||(e.SitePages={}))}(e.FileNames||(e.FileNames={})),function(e){e.CT_CorporateNews="0x0101009D1CB255DA76424F860D91F20E6C411800DB0A9B958B76B247A41A42489872F79D",e.CT_News="0x0101009D1CB255DA76424F860D91F20E6C4118001D97D517C2F6D844A59632814F3E9EA3",e.CT_ToolSite="0x01001D62806226164646A58494222AC4A93F",e.CT_ToolLink="0x01001D62806226164646A58494222AC4A94F"}(e.ContentTypes||(e.ContentTypes={})),function(e){e.TEAMS_SITE_COLLECTION_URL_PREFIX="CollTeams",e.PROJECTS_SITE_COLLECTION_URL_PREFIX="CollProjects"}(e.Collaboration||(e.Collaboration={})),function(e){e.TOOLSITE_HUBSITE="toolsitelanding"}(e.ToolSites||(e.ToolSites={}))}(t.Constants||(t.Constants={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){var t=function(){return function(){}}();e.Term=t;var n=function(){return function(){}}();e.UserProperties=n;var r=function(){return function(){}}();e.CorpNewsItem=r;var o=function(){return function(){}}();e.NewsItem=o;var i=function(){return function(){}}();e.TermGuidWithParentLevelsToRetrieve=i;var a=function(){return function(){}}();e.FollowedSPObject=a;var s=function(){return function(){}}();e.SiteInfo=s}(t.models||(t.models={}))},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(a,s)}u((r=r.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=function(){function e(){}return e.getOrPutPromiseAsGlobalVariable=function(e,t){return r(this,void 0,void 0,function(){return o(this,function(n){try{return null==window[e]&&(window[e]=t()),[2,window[e]]}catch(e){return console.error(e),[2,null]}return[2]})})},e.getOrPutPromiseValueInStorage=function(e,t,n,a){return r(this,void 0,void 0,function(){var r,s=this;return o(this,function(o){try{switch(r=new i.PnPClientStorage,t){case"local":return[2,r.local.getOrPut(e,function(){return s.getOrPutPromiseAsGlobalVariable(e,n)},a)];case"session":return[2,r.session.getOrPut(e,function(){return s.getOrPutPromiseAsGlobalVariable(e,n)},a)];default:return[2,null]}}catch(e){return console.error(e),[2,null]}return[2]})})},e.clearKeyFromLocalStorage=function(e){return r(this,void 0,void 0,function(){var t;return o(this,function(n){t=new i.PnPClientStorage;try{t.local.delete(e)}catch(e){console.error("clearKeyFromLocalStorage: "+e)}return[2]})})},e}();t.storage=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=n(6),i=function(){function e(){}return e.randomNoRepeats=function(e){var t=e.slice(0);return function(){t.length<1&&(t=e.slice(0));var n=Math.floor(Math.random()*t.length),r=t[n];return t.splice(n,1),r}},e.formatShortDate=function(e){var t=this.dateAddLeadZero(e.getDate()),n=this.dateAddLeadZero(e.getMonth()+1);return e.getFullYear()+"-"+n+"-"+t},e.getLocaleDateString=function(e){var t={"af-ZA":"yyyy/MM/dd","sq-AL":"dd.M.yyyy","gsw-FR":"dd/MM/yyyy","am-ET":"dd/M/yyyy","ar-DZ":"yyyy-MM-dd","ar-BH":"dd/MM/yyyy","ar-EG":"dd/MM/yyyy","ar-IQ":"dd/MM/yyyy","ar-JO":"dd/MM/yyyy","ar-KW":"dd/MM/yyyy","ar-LB":"dd/MM/yyyy","ar-LY":"dd/MM/yyyy","ar-MA":"dd/MM/yyyy","ar-OM":"dd/MM/yyyy","ar-QA":"dd/MM/yyyy","ar-SA":"dd/MM/yy","ar-SY":"dd/MM/yyyy","ar-TN":"dd/MM/yyyy","ar-AE":"dd/MM/yyyy","ar-YE":"dd/MM/yyyy","hy-AM":"dd.MM.yyyy","as-IN":"dd-MM-yyyy","az-Cyrl-AZ":"dd.MM.yyyy","az-Latn-AZ":"dd.MM.yyyy","ba-RU":"dd.MM.yy","eu-ES":"yyyy/MM/dd","be-BY":"dd.MM.yy","bn-BD":"dd-MM-yy","bn-IN":"dd-MM-yy","bs-Cyrl-BA":"d.M.yyyy","bs-Latn-BA":"d.M.yyyy","br-FR":"dd/MM/yyyy","bg-BG":"d.M.yyyy г.","ca-ES":"dd/MM/yyyy","zh-HK":"d/M/yyyy","zh-MO":"d/M/yyyy","zh-CN":"yyyy.M.d","zh-SG":"d/M/yyyy","zh-TW":"yyyy/M/d","co-FR":"dd/MM/yyyy","hr-BA":"d.M.yyyy","hr-HR":"d.M.yyyy","cs-CZ":"d.M.yyyy","da-DK":"dd-MM-yyyy","prs-AF":"yyyy/M/d","dv-MV":"dd/MM/yy","nl-BE":"d/MM/yyyy","nl-NL":"d-M-yyyy","en-AU":"d/MM/yyyy","en-BZ":"dd/MM/yyyy","en-CA":"yyyy-MM-dd","en-029":"dd/MM/yyyy","en-IN":"dd-MM-yyyy","en-IE":"dd/MM/yyyy","en-JM":"dd/MM/yyyy","en-MY":"d/M/yyyy","en-NZ":"d/MM/yyyy","en-PH":"d/M/yyyy","en-SG":"d/M/yyyy","en-ZA":"yyyy-MM-dd","en-TT":"dd/MM/yyyy","en-GB":"dd/MM/yyyy","en-US":"M/d/yyyy","en-ZW":"dd/MM/yyyy","et-EE":"d.MM.yyyy","fo-FO":"dd-MM-yyyy","fil-PH":"M/d/yyyy","fi-FI":"d.M.yyyy","fr-BE":"dd-MM-yy","fr-CA":"yyyy-MM-dd","fr-FR":"dd/MM/yyyy","fr-LU":"dd/MM/yyyy","fr-MC":"dd/MM/yyyy","fr-CH":"dd.MM.yyyy","fy-NL":"d-M-yyyy","gl-ES":"dd/MM/yyyy","ka-GE":"dd.MM.yyyy","de-AT":"dd.MM.yyyy","de-DE":"dd.MM.yyyy","de-LI":"dd.MM.yyyy","de-LU":"dd.MM.yyyy","de-CH":"dd.MM.yyyy","el-GR":"d/M/yyyy","kl-GL":"dd-MM-yyyy","gu-IN":"dd-MM-yy","ha-Latn-NG":"d/M/yyyy","he-IL":"dd/MM/yyyy","hi-IN":"dd-MM-yyyy","hu-HU":"yyyy.MM.dd","is-IS":"d.M.yyyy","ig-NG":"d/M/yyyy","smn-FI":"d.M.yyyy","id-ID":"dd/MM/yyyy","iu-Latn-CA":"d/MM/yyyy","iu-Cans-CA":"d/M/yyyy","ga-IE":"dd/MM/yyyy","xh-ZA":"yyyy/MM/dd","zu-ZA":"dd-MM-yyyy","it-IT":"dd/MM/yyyy","it-CH":"dd.MM.yyyy","ja-JP":"yyyy/MM/dd","kn-IN":"dd-MM-yy","kk-KZ":"d-MM-yy","km-KH":"dd/MM/yy","qut-GT":"dd/MM/yyyy","rw-RW":"d/MM/yyyy","sw-KE":"M/d/yyyy","kok-IN":"dd-MM-yyyy","ko-KR":"yyyy-MM-dd","ky-KG":"d-MM yy","lo-LA":"dd/MM/yyyy","lv-LV":"dd.MM.yyyy","lt-LT":"yyyy-MM-dd","dsb-DE":"d.M.yyyy","smj-NO":"dd.MM.yyyy","smj-SE":"yyyy-MM-dd","lb-LU":"dd.MM.yy","mk-MK":"dd.MM.yyyy","ms-MY":"dd/MM/yyyy","ms-BN":"dd/MM/yyyy","ml-IN":"dd-MM-yy","mt-MT":"dd/MM/yyyy","mi-NZ":"dd/MM/yyyy","arn-CL":"dd-MM-yyyy","mr-IN":"dd-MM-yyyy","moh-CA":"M/d/yyyy","mn-MN":"yyyy-MM-dd","mn-Mong-CN":"yyyy/M/d","ne-NP":"M/d/yyyy","se-FI":"d.M.yyyy","se-NO":"dd.MM.yyyy","se-SE":"yyyy-MM-dd","nb-NO":"dd.MM.yyyy","nn-NO":"dd.MM.yyyy","oc-FR":"dd/MM/yyyy","or-IN":"dd-MM-yy","ps-AF":"dd/MM/yy","fa-IR":"dd/MM/yyyy","pl-PL":"yyyy-MM-dd","pt-BR":"dd/MM/yyyy","pt-PT":"dd/MM/yyyy","pa-IN":"dd-MM-yy","quz-BO":"dd/MM/yyyy","quz-EC":"dd/MM/yyyy","quz-PE":"dd/MM/yyyy","ro-RO":"dd.MM.yyyy","rm-CH":"dd-MM-yyyy","ru-RU":"dd.MM.yyyy","sah-RU":"dd.MM.yyyy","sa-IN":"dd-MM-yyyy","sr-Cyrl-BA":"d.M.yyyy","sr-Cyrl-ME":"d.M.yyyy","sr-Cyrl-RS":"d.M.yyyy","sr-Latn-BA":"d.M.yyyy","sr-Latn-ME":"d.M.yyyy","sr-Latn-RS":"d.M.yyyy","nso-ZA":"dd/MM/yy","tn-ZA":"dd/MM/yy","gd-GB":"dd/MM/yyyy","si-LK":"yyyy-MM-dd","sms-FI":"d.M.yyyy","sk-SK":"d.M.yyyy","sl-SI":"d.M.yyyy","sma-NO":"dd.MM.yyyy","sma-SE":"yyyy-MM-dd","es-AR":"dd/MM/yyyy","es-BO":"dd/MM/yyyy","es-CL":"dd-MM-yyyy","es-CO":"dd/MM/yyyy","es-CR":"dd/MM/yyyy","es-DO":"d/M/yy","es-EC":"dd/MM/yyyy","es-SV":"dd/MM/yyyy","es-GT":"dd/MM/yyyy","es-HN":"dd/MM/yyyy","es-MX":"dd/MM/yyyy","es-NI":"dd/MM/yyyy","es-PA":"d/M/yy","es-PY":"dd/MM/yyyy","es-PE":"dd/MM/yyyy","es-PR":"dd/MM/yyyy","es-ES_tradnl":"dd/MM/yyyy","es-ES":"dd/MM/yyyy","es-US":"M/d/yyyy","es-UY":"dd/MM/yyyy","es-VE":"dd-MM-yyyy","sv-SE":"yyyy-MM-dd","sv-FI":"d.M.yyyy","syr-SY":"dd/MM/yyyy","tg-Cyrl-TJ":"dd.MM.yyyy","tzm-Latn-DZ":"dd/MM/yyyy","ta-IN":"dd-MM-yyyy","tt-RU":"dd.MM.yyyy","te-IN":"dd-MM-yy","th-TH":"d/M/yyyy","bo-CN":"yyyy/M/d","tr-TR":"d.M.yyyy","tk-TM":"dd.MM.yy ý.","uk-UA":"dd.MM.yyyy","hsb-DE":"d.M.yyyy","ur-PK":"dd/MM/yyyy","ug-CN":"yyyy-M-d","uz-Cyrl-UZ":"dd.MM.yyyy","uz-Latn-UZ":"dd.MM.yyyy","vi-VN":"dd/MM/yyyy","cy-GB":"dd/MM/yy","wo-SN":"dd/MM/yyyy","ii-CN":"yyyy/M/d","yo-NG":"d/M/yyyy"};return r.stringIsNullOrEmpty(t[e])?"dd/MM/yyyy":t[e]},e.dateAddLeadZero=function(e){return e<10?"0"+e:e.toString()},e.formatDate=function(e,t){var n=["January","February","March","April","May","June","July","August","September","October","November","December"],o=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],i=e.getFullYear(),a=e.getMonth(),s=e.getDay(),u=e.getDate(),c=e.getHours(),l=e.getMinutes(),p=e.getSeconds();r.stringIsNullOrEmpty(t)&&(t="M/dd/yyyy"),(t=t.replace("yyyy","{0}").replace("yy","{1}").replace("y","{2}").replace("MMMM","{3}").replace("MMM","{4}").replace("MM","{5}").replace("M","{6}").replace("dddd","{7}").replace("ddd","{8}").replace("dd","{9}").replace("d","{10}").replace("hh","{11}").replace("h","{12}").replace("HH","{13}").replace("H","{14}").replace("mm","{15}").replace("m","{16}").replace("ss","{17}").replace("s","{18}").replace("tt","{19}").replace("t","{20}")).indexOf("{0}")>-1&&(t=t.replace("{0}",i.toString())),t.indexOf("{1}")>-1&&(t=t.replace("{1}",i.toString().substr(2,2))),t.indexOf("{2}")>-1&&(t=t.replace("{2}",parseInt(i.toString().substr(2,2)).toString())),t.indexOf("{3}")>-1&&(t=t.replace("{3}",n[a])),t.indexOf("{4}")>-1&&(t=t.replace("{4}",n[a].substr(0,3))),t.indexOf("{5}")>-1&&(t=t.replace("{5}",this.dateAddLeadZero(a+1))),t.indexOf("{6}")>-1&&(t=t.replace("{6}",(a+1).toString())),t.indexOf("{7}")>-1&&(t=t.replace("{7}",o[s])),t.indexOf("{8}")>-1&&(t=t.replace("{8}",o[s].substr(0,3))),t.indexOf("{9}")>-1&&(t=t.replace("{9}",this.dateAddLeadZero(u))),t.indexOf("{10}")>-1&&(t=t.replace("{10}",u.toString()));var d=0;return t.indexOf("{11}")>-1&&(d=c,c>12&&(d-=12),0==c&&(d=12),t=t.replace("{11}",this.dateAddLeadZero(d))),t.indexOf("{12}")>-1&&(d=c,c>12&&(d-=12),0==c&&(d=12),t=t.replace("{12}",d.toString())),t.indexOf("{13}")>-1&&(t=t.replace("{13}",this.dateAddLeadZero(c))),t.indexOf("{14}")>-1&&(t=t.replace("{14}",c.toString())),t.indexOf("{15}")>-1&&(t=t.replace("{15}",this.dateAddLeadZero(l))),t.indexOf("{16}")>-1&&(t=t.replace("{16}",l.toString())),t.indexOf("{17}")>-1&&(t=t.replace("{17}",this.dateAddLeadZero(p))),t.indexOf("{18}")>-1&&(t=t.replace("{18}",p.toString())),t.indexOf("{19}")>-1&&(t=c>11?t.replace("{19}","PM"):t.replace("{19}","AM")),t.indexOf("{20}")>-1&&(t=c>11?t.replace("{20}","P"):t=t.replace("{20}","A")),t},e.getShortUserName=function(e){var t=e;try{t=e.substring(e.lastIndexOf("|")+1)}catch(t){console.error("Can't get clear login name for user "+e+"!")}return t},e.getClaimsUserName=function(e){return this.startsWith(e,o.Constants.General.ACCOUNT_NAME_PREFIX)?e:o.Constants.General.ACCOUNT_NAME_PREFIX+e},e.addResolutionParamToURL=function(e,t,n){return void 0===t&&(t=0),void 0===n&&(n=""),r.stringIsNullOrEmpty(e)?"":e.toUpperCase().indexOf("/getpreview.ashx?".toUpperCase())>0?e+"&resolution="+t.toString():e.toUpperCase().indexOf("/_api/".toUpperCase())>0?e:e.toUpperCase().indexOf("_layouts/15/images/sitepagethumbnail.png".toUpperCase())>0?"":n+"/_layouts/15/getpreview.ashx?resolution="+t.toString()+"&path="+encodeURI(e)},e.startsWith=function(e,t){return e.length>=t.length&&e.substr(0,t.length)===t},e.endsWith=function(e,t){return e.length>=t.length&&e.substr(e.length-t.length)===t},e.ensureURLEndsWithSlash=function(e){return this.endsWith(e,"/")?e:e+"/"},e.getEnvironmentFromWebPartAlias=function(e){var t="";try{if(!r.stringIsNullOrEmpty(e)){var n=e.match(/-(dev|qa|uat)$/i);null!=n&&(t=n[1])}}catch(e){console.error(e)}return t},e.arraysEqual=function(e,t){if(null==e&&null==t)return!0;if(null==e&&null!=t)return!1;if(null!=e&&null==t)return!1;if(e.length!==t.length)return!1;for(var n=e.length;n>=0;n--)if(e[n]!==t[n])return!1;return!0},e.removeDuplicatesFromArray=function(e,t){var n=[],r={};for(var o in e)r[e[o][t]]=e[o];for(var o in r)n.push(r[o]);return n},e.GetEnvironmentPostfix=function(e){var t="prod";return e.manifest.alias.lastIndexOf("-")>0&&(t=e.manifest.alias.substring(e.manifest.alias.lastIndexOf("-")+1)),t},e}();t.util=i},function(e,t){
/*! adal-angular v1.0.17 2018-02-27 */
var n=function(){"use strict";return n=function(e){if(this.REQUEST_TYPE={LOGIN:"LOGIN",RENEW_TOKEN:"RENEW_TOKEN",UNKNOWN:"UNKNOWN"},this.RESPONSE_TYPE={ID_TOKEN_TOKEN:"id_token token",TOKEN:"token"},this.CONSTANTS={ACCESS_TOKEN:"access_token",EXPIRES_IN:"expires_in",ID_TOKEN:"id_token",ERROR_DESCRIPTION:"error_description",SESSION_STATE:"session_state",ERROR:"error",STORAGE:{TOKEN_KEYS:"adal.token.keys",ACCESS_TOKEN_KEY:"adal.access.token.key",EXPIRATION_KEY:"adal.expiration.key",STATE_LOGIN:"adal.state.login",STATE_RENEW:"adal.state.renew",NONCE_IDTOKEN:"adal.nonce.idtoken",SESSION_STATE:"adal.session.state",USERNAME:"adal.username",IDTOKEN:"adal.idtoken",ERROR:"adal.error",ERROR_DESCRIPTION:"adal.error.description",LOGIN_REQUEST:"adal.login.request",LOGIN_ERROR:"adal.login.error",RENEW_STATUS:"adal.token.renew.status",ANGULAR_LOGIN_REQUEST:"adal.angular.login.request"},RESOURCE_DELIMETER:"|",CACHE_DELIMETER:"||",LOADFRAME_TIMEOUT:6e3,TOKEN_RENEW_STATUS_CANCELED:"Canceled",TOKEN_RENEW_STATUS_COMPLETED:"Completed",TOKEN_RENEW_STATUS_IN_PROGRESS:"In Progress",LOGGING_LEVEL:{ERROR:0,WARN:1,INFO:2,VERBOSE:3},LEVEL_STRING_MAP:{0:"ERROR:",1:"WARNING:",2:"INFO:",3:"VERBOSE:"},POPUP_WIDTH:483,POPUP_HEIGHT:600},n.prototype._singletonInstance)return n.prototype._singletonInstance;if(n.prototype._singletonInstance=this,this.instance="https://login.microsoftonline.com/",this.config={},this.callback=null,this.popUp=!1,this.isAngular=!1,this._user=null,this._activeRenewals={},this._loginInProgress=!1,this._acquireTokenInProgress=!1,this._renewStates=[],this._callBackMappedToRenewStates={},this._callBacksMappedToRenewStates={},this._openedWindows=[],this._requestType=this.REQUEST_TYPE.LOGIN,window._adalInstance=this,e.displayCall&&"function"!=typeof e.displayCall)throw new Error("displayCall is not a function");if(!e.clientId)throw new Error("clientId is required");this.config=this._cloneConfig(e),void 0===this.config.navigateToLoginRequestUrl&&(this.config.navigateToLoginRequestUrl=!0),this.config.popUp&&(this.popUp=!0),this.config.callback&&"function"==typeof this.config.callback&&(this.callback=this.config.callback),this.config.instance&&(this.instance=this.config.instance),this.config.loginResource||(this.config.loginResource=this.config.clientId),this.config.redirectUri||(this.config.redirectUri=window.location.href.split("?")[0].split("#")[0]),this.config.postLogoutRedirectUri||(this.config.postLogoutRedirectUri=window.location.href.split("?")[0].split("#")[0]),this.config.anonymousEndpoints||(this.config.anonymousEndpoints=[]),this.config.isAngular&&(this.isAngular=this.config.isAngular),this.config.loadFrameTimeout&&(this.CONSTANTS.LOADFRAME_TIMEOUT=this.config.loadFrameTimeout)},"undefined"!=typeof window&&(window.Logging={piiLoggingEnabled:!1,level:0,log:function(e){}}),n.prototype.login=function(){if(this._loginInProgress)this.info("Login in progress");else{this._loginInProgress=!0;var e=this._guid();this.config.state=e,this._idTokenNonce=this._guid();var t=this._getItem(this.CONSTANTS.STORAGE.ANGULAR_LOGIN_REQUEST);t&&""!==t?this._saveItem(this.CONSTANTS.STORAGE.ANGULAR_LOGIN_REQUEST,""):t=window.location.href,this.verbose("Expected state: "+e+" startPage:"+t),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_REQUEST,t),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.STATE_LOGIN,e,!0),this._saveItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN,this._idTokenNonce,!0),this._saveItem(this.CONSTANTS.STORAGE.ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,"");var n=this._getNavigateUrl("id_token",null)+"&nonce="+encodeURIComponent(this._idTokenNonce);this.config.displayCall?this.config.displayCall(n):this.popUp?(this._saveItem(this.CONSTANTS.STORAGE.STATE_LOGIN,""),this._renewStates.push(e),this.registerCallback(e,this.config.clientId,this.callback),this._loginPopup(n)):this.promptUser(n)}},n.prototype._openPopup=function(e,t,n,r){try{var o=window.screenLeft?window.screenLeft:window.screenX,i=window.screenTop?window.screenTop:window.screenY,a=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,s=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,u=a/2-n/2+o,c=s/2-r/2+i,l=window.open(e,t,"width="+n+", height="+r+", top="+c+", left="+u);return l.focus&&l.focus(),l}catch(e){return this.warn("Error opening popup, "+e.message),this._loginInProgress=!1,this._acquireTokenInProgress=!1,null}},n.prototype._handlePopupError=function(e,t,n,r,o){this.warn(r),this._saveItem(this.CONSTANTS.STORAGE.ERROR,n),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,r),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,o),t&&this._activeRenewals[t]&&(this._activeRenewals[t]=null),this._loginInProgress=!1,this._acquireTokenInProgress=!1,e&&e(r,null,n)},n.prototype._loginPopup=function(e,t,n){var r=this._openPopup(e,"login",this.CONSTANTS.POPUP_WIDTH,this.CONSTANTS.POPUP_HEIGHT),o=n||this.callback;if(null!=r){if(this._openedWindows.push(r),-1!=this.config.redirectUri.indexOf("#"))var i=this.config.redirectUri.split("#")[0];else i=this.config.redirectUri;var a=this,s=window.setInterval(function(){if(!r||r.closed||void 0===r.closed){var e="Popup Window closed",n="Popup Window closed by UI action/ Popup Window handle destroyed due to cross zone navigation in IE/Edge";return a.isAngular&&a._broadcast("adal:popUpClosed",n+a.CONSTANTS.RESOURCE_DELIMETER+e),a._handlePopupError(o,t,e,n,n),void window.clearInterval(s)}try{var u=r.location;if(-1!=encodeURI(u.href).indexOf(encodeURI(i)))return a.isAngular?a._broadcast("adal:popUpHashChanged",u.hash):a.handleWindowCallback(u.hash),window.clearInterval(s),a._loginInProgress=!1,a._acquireTokenInProgress=!1,a.info("Closing popup window"),a._openedWindows=[],void r.close()}catch(e){}},1)}else{var u="Popup Window is null. This can happen if you are using IE";this._handlePopupError(o,t,"Error opening popup",u,u)}},n.prototype._broadcast=function(e,t){!function(){function e(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var n=document.createEvent("CustomEvent");return n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),n}if("function"==typeof window.CustomEvent)return!1;e.prototype=window.Event.prototype,window.CustomEvent=e}();var n=new CustomEvent(e,{detail:t});window.dispatchEvent(n)},n.prototype.loginInProgress=function(){return this._loginInProgress},n.prototype._hasResource=function(e){var t=this._getItem(this.CONSTANTS.STORAGE.TOKEN_KEYS);return t&&!this._isEmpty(t)&&t.indexOf(e+this.CONSTANTS.RESOURCE_DELIMETER)>-1},n.prototype.getCachedToken=function(e){if(!this._hasResource(e))return null;var t=this._getItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+e),n=this._getItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+e),r=this.config.expireOffsetSeconds||300;return n&&n>this._now()+r?t:(this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+e,""),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+e,0),null)},n.prototype.getCachedUser=function(){if(this._user)return this._user;var e=this._getItem(this.CONSTANTS.STORAGE.IDTOKEN);return this._user=this._createUser(e),this._user},n.prototype.registerCallback=function(e,t,n){this._activeRenewals[t]=e,this._callBacksMappedToRenewStates[e]||(this._callBacksMappedToRenewStates[e]=[]);var r=this;this._callBacksMappedToRenewStates[e].push(n),this._callBackMappedToRenewStates[e]||(this._callBackMappedToRenewStates[e]=function(n,o,i,a){r._activeRenewals[t]=null;for(var s=0;s<r._callBacksMappedToRenewStates[e].length;++s)try{r._callBacksMappedToRenewStates[e][s](n,o,i,a)}catch(i){r.warn(i)}r._callBacksMappedToRenewStates[e]=null,r._callBackMappedToRenewStates[e]=null})},n.prototype._renewToken=function(e,t,n){this.info("renewToken is called for resource:"+e);var r=this._addAdalFrame("adalRenewFrame"+e),o=this._guid()+"|"+e;this.config.state=o,this._renewStates.push(o),this.verbose("Renew token Expected state: "+o),n=n||"token";var i=this._urlRemoveQueryStringParameter(this._getNavigateUrl(n,e),"prompt");n===this.RESPONSE_TYPE.ID_TOKEN_TOKEN&&(this._idTokenNonce=this._guid(),this._saveItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN,this._idTokenNonce,!0),i+="&nonce="+encodeURIComponent(this._idTokenNonce)),i+="&prompt=none",i=this._addHintParameters(i),this.registerCallback(o,e,t),this.verbosePii("Navigate to:"+i),r.src="about:blank",this._loadFrameTimeout(i,"adalRenewFrame"+e,e)},n.prototype._renewIdToken=function(e,t){this.info("renewIdToken is called");var n=this._addAdalFrame("adalIdTokenFrame"),r=this._guid()+"|"+this.config.clientId;this._idTokenNonce=this._guid(),this._saveItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN,this._idTokenNonce,!0),this.config.state=r,this._renewStates.push(r),this.verbose("Renew Idtoken Expected state: "+r);var o=null===t||void 0===t?null:this.config.clientId,i=(t=t||"id_token",this._urlRemoveQueryStringParameter(this._getNavigateUrl(t,o),"prompt"));i+="&prompt=none",i=this._addHintParameters(i),i+="&nonce="+encodeURIComponent(this._idTokenNonce),this.registerCallback(r,this.config.clientId,e),this.verbosePii("Navigate to:"+i),n.src="about:blank",this._loadFrameTimeout(i,"adalIdTokenFrame",this.config.clientId)},n.prototype._urlContainsQueryStringParameter=function(e,t){return new RegExp("[\\?&]"+e+"=").test(t)},n.prototype._urlRemoveQueryStringParameter=function(e,t){var n=new RegExp("(\\&"+t+"=)[^&]+");return e=e.replace(n,""),n=new RegExp("("+t+"=)[^&]+&"),e=e.replace(n,""),n=new RegExp("("+t+"=)[^&]+"),e.replace(n,"")},n.prototype._loadFrameTimeout=function(e,t,n){this.verbose("Set loading state to pending for: "+n),this._saveItem(this.CONSTANTS.STORAGE.RENEW_STATUS+n,this.CONSTANTS.TOKEN_RENEW_STATUS_IN_PROGRESS),this._loadFrame(e,t);var r=this;setTimeout(function(){if(r._getItem(r.CONSTANTS.STORAGE.RENEW_STATUS+n)===r.CONSTANTS.TOKEN_RENEW_STATUS_IN_PROGRESS){r.verbose("Loading frame has timed out after: "+r.CONSTANTS.LOADFRAME_TIMEOUT/1e3+" seconds for resource "+n);var e=r._activeRenewals[n];e&&r._callBackMappedToRenewStates[e]&&r._callBackMappedToRenewStates[e]("Token renewal operation failed due to timeout",null,"Token Renewal Failed"),r._saveItem(r.CONSTANTS.STORAGE.RENEW_STATUS+n,r.CONSTANTS.TOKEN_RENEW_STATUS_CANCELED)}},r.CONSTANTS.LOADFRAME_TIMEOUT)},n.prototype._loadFrame=function(e,t){var n=this;n.info("LoadFrame: "+t);var r=t;setTimeout(function(){var t=n._addAdalFrame(r);""!==t.src&&"about:blank"!==t.src||(t.src=e,n._loadFrame(e,r))},500)},n.prototype.acquireToken=function(e,t){if(this._isEmpty(e))return this.warn("resource is required"),void t("resource is required",null,"resource is required");var n=this.getCachedToken(e);return n?(this.info("Token is already in cache for resource:"+e),void t(null,n,null)):this._user||this.config.extraQueryParameter&&-1!==this.config.extraQueryParameter.indexOf("login_hint")?void(this._activeRenewals[e]?this.registerCallback(this._activeRenewals[e],e,t):(this._requestType=this.REQUEST_TYPE.RENEW_TOKEN,e===this.config.clientId?this._user?(this.verbose("renewing idtoken"),this._renewIdToken(t)):(this.verbose("renewing idtoken and access_token"),this._renewIdToken(t,this.RESPONSE_TYPE.ID_TOKEN_TOKEN)):this._user?(this.verbose("renewing access_token"),this._renewToken(e,t)):(this.verbose("renewing idtoken and access_token"),this._renewToken(e,t,this.RESPONSE_TYPE.ID_TOKEN_TOKEN)))):(this.warn("User login is required"),void t("User login is required",null,"login required"))},n.prototype.acquireTokenPopup=function(e,t,n,r){if(this._isEmpty(e))return this.warn("resource is required"),void r("resource is required",null,"resource is required");if(!this._user)return this.warn("User login is required"),void r("User login is required",null,"login required");if(this._acquireTokenInProgress)return this.warn("Acquire token interactive is already in progress"),void r("Acquire token interactive is already in progress",null,"Acquire token interactive is already in progress");var o=this._guid()+"|"+e;this.config.state=o,this._renewStates.push(o),this._requestType=this.REQUEST_TYPE.RENEW_TOKEN,this.verbose("Renew token Expected state: "+o);var i=this._urlRemoveQueryStringParameter(this._getNavigateUrl("token",e),"prompt");if(i+="&prompt=select_account",t&&(i+=t),n&&-1===i.indexOf("&claims"))i+="&claims="+encodeURIComponent(n);else if(n&&-1!==i.indexOf("&claims"))throw new Error("Claims cannot be passed as an extraQueryParameter");i=this._addHintParameters(i),this._acquireTokenInProgress=!0,this.info("acquireToken interactive is called for the resource "+e),this.registerCallback(o,e,r),this._loginPopup(i,e,r)},n.prototype.acquireTokenRedirect=function(e,t,n){if(this._isEmpty(e))return this.warn("resource is required"),void r("resource is required",null,"resource is required");var r=this.callback;if(!this._user)return this.warn("User login is required"),void r("User login is required",null,"login required");if(this._acquireTokenInProgress)return this.warn("Acquire token interactive is already in progress"),void r("Acquire token interactive is already in progress",null,"Acquire token interactive is already in progress");var o=this._guid()+"|"+e;this.config.state=o,this.verbose("Renew token Expected state: "+o);var i=this._urlRemoveQueryStringParameter(this._getNavigateUrl("token",e),"prompt");if(i+="&prompt=select_account",t&&(i+=t),n&&-1===i.indexOf("&claims"))i+="&claims="+encodeURIComponent(n);else if(n&&-1!==i.indexOf("&claims"))throw new Error("Claims cannot be passed as an extraQueryParameter");i=this._addHintParameters(i),this._acquireTokenInProgress=!0,this.info("acquireToken interactive is called for the resource "+e),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_REQUEST,window.location.href),this._saveItem(this.CONSTANTS.STORAGE.STATE_RENEW,o,!0),this.promptUser(i)},n.prototype.promptUser=function(e){e?(this.infoPii("Navigate to:"+e),window.location.replace(e)):this.info("Navigate url is empty")},n.prototype.clearCache=function(){this._saveItem(this.CONSTANTS.STORAGE.LOGIN_REQUEST,""),this._saveItem(this.CONSTANTS.STORAGE.ANGULAR_LOGIN_REQUEST,""),this._saveItem(this.CONSTANTS.STORAGE.SESSION_STATE,""),this._saveItem(this.CONSTANTS.STORAGE.STATE_LOGIN,""),this._saveItem(this.CONSTANTS.STORAGE.STATE_RENEW,""),this._renewStates=[],this._saveItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN,""),this._saveItem(this.CONSTANTS.STORAGE.IDTOKEN,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,""),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,"");var e=this._getItem(this.CONSTANTS.STORAGE.TOKEN_KEYS);if(!this._isEmpty(e)){e=e.split(this.CONSTANTS.RESOURCE_DELIMETER);for(var t=0;t<e.length&&""!==e[t];t++)this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+e[t],""),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+e[t],0)}this._saveItem(this.CONSTANTS.STORAGE.TOKEN_KEYS,"")},n.prototype.clearCacheForResource=function(e){this._saveItem(this.CONSTANTS.STORAGE.STATE_RENEW,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,""),this._hasResource(e)&&(this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+e,""),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+e,0))},n.prototype.logOut=function(){var e;if(this.clearCache(),this._user=null,this.config.logOutUri)e=this.config.logOutUri;else{var t="common",n="";this.config.tenant&&(t=this.config.tenant),this.config.postLogoutRedirectUri&&(n="post_logout_redirect_uri="+encodeURIComponent(this.config.postLogoutRedirectUri)),e=this.instance+t+"/oauth2/logout?"+n}this.infoPii("Logout navigate to: "+e),this.promptUser(e)},n.prototype._isEmpty=function(e){return void 0===e||!e||0===e.length},n.prototype.getUser=function(e){if("function"!=typeof e)throw new Error("callback is not a function");if(this._user)e(null,this._user);else{var t=this._getItem(this.CONSTANTS.STORAGE.IDTOKEN);this._isEmpty(t)?(this.warn("User information is not available"),e("User information is not available",null)):(this.info("User exists in cache: "),this._user=this._createUser(t),e(null,this._user))}},n.prototype._addHintParameters=function(e){if(this._user&&this._user.profile)if(this._user.profile.sid&&-1!==e.indexOf("&prompt=none"))this._urlContainsQueryStringParameter("sid",e)||(e+="&sid="+encodeURIComponent(this._user.profile.sid));else if(this._user.profile.upn&&(this._urlContainsQueryStringParameter("login_hint",e)||(e+="&login_hint="+encodeURIComponent(this._user.profile.upn)),!this._urlContainsQueryStringParameter("domain_hint",e)&&this._user.profile.upn.indexOf("@")>-1)){var t=this._user.profile.upn.split("@");e+="&domain_hint="+encodeURIComponent(t[t.length-1])}return e},n.prototype._createUser=function(e){var t=null,n=this._extractIdToken(e);return n&&n.hasOwnProperty("aud")&&(n.aud.toLowerCase()===this.config.clientId.toLowerCase()?(t={userName:"",profile:n},n.hasOwnProperty("upn")?t.userName=n.upn:n.hasOwnProperty("email")&&(t.userName=n.email)):this.warn("IdToken has invalid aud field")),t},n.prototype._getHash=function(e){return e.indexOf("#/")>-1?e=e.substring(e.indexOf("#/")+2):e.indexOf("#")>-1&&(e=e.substring(1)),e},n.prototype.isCallback=function(e){e=this._getHash(e);var t=this._deserialize(e);return t.hasOwnProperty(this.CONSTANTS.ERROR_DESCRIPTION)||t.hasOwnProperty(this.CONSTANTS.ACCESS_TOKEN)||t.hasOwnProperty(this.CONSTANTS.ID_TOKEN)},n.prototype.getLoginError=function(){return this._getItem(this.CONSTANTS.STORAGE.LOGIN_ERROR)},n.prototype.getRequestInfo=function(e){e=this._getHash(e);var t=this._deserialize(e),n={valid:!1,parameters:{},stateMatch:!1,stateResponse:"",requestType:this.REQUEST_TYPE.UNKNOWN};if(t&&(n.parameters=t,t.hasOwnProperty(this.CONSTANTS.ERROR_DESCRIPTION)||t.hasOwnProperty(this.CONSTANTS.ACCESS_TOKEN)||t.hasOwnProperty(this.CONSTANTS.ID_TOKEN))){n.valid=!0;var r;if(!t.hasOwnProperty("state"))return this.warn("No state returned"),n;if(this.verbose("State: "+t.state),r=t.state,n.stateResponse=r,this._matchState(n))return n;if(!n.stateMatch&&window.parent){n.requestType=this._requestType;for(var o=this._renewStates,i=0;i<o.length;i++)if(o[i]===n.stateResponse){n.stateMatch=!0;break}}}return n},n.prototype._matchNonce=function(e){var t=this._getItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN);if(t){t=t.split(this.CONSTANTS.CACHE_DELIMETER);for(var n=0;n<t.length;n++)if(t[n]===e.profile.nonce)return!0}return!1},n.prototype._matchState=function(e){var t=this._getItem(this.CONSTANTS.STORAGE.STATE_LOGIN);if(t){t=t.split(this.CONSTANTS.CACHE_DELIMETER);for(var n=0;n<t.length;n++)if(t[n]===e.stateResponse)return e.requestType=this.REQUEST_TYPE.LOGIN,e.stateMatch=!0,!0}var r=this._getItem(this.CONSTANTS.STORAGE.STATE_RENEW);if(r){r=r.split(this.CONSTANTS.CACHE_DELIMETER);for(n=0;n<r.length;n++)if(r[n]===e.stateResponse)return e.requestType=this.REQUEST_TYPE.RENEW_TOKEN,e.stateMatch=!0,!0}return!1},n.prototype._getResourceFromState=function(e){if(e){var t=e.indexOf("|");if(t>-1&&t+1<e.length)return e.substring(t+1)}return""},n.prototype.saveTokenFromHash=function(e){this.info("State status:"+e.stateMatch+"; Request type:"+e.requestType),this._saveItem(this.CONSTANTS.STORAGE.ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,"");var t=this._getResourceFromState(e.stateResponse);if(e.parameters.hasOwnProperty(this.CONSTANTS.ERROR_DESCRIPTION))this.infoPii("Error :"+e.parameters.error+"; Error description:"+e.parameters[this.CONSTANTS.ERROR_DESCRIPTION]),this._saveItem(this.CONSTANTS.STORAGE.ERROR,e.parameters.error),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,e.parameters[this.CONSTANTS.ERROR_DESCRIPTION]),e.requestType===this.REQUEST_TYPE.LOGIN&&(this._loginInProgress=!1,this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,e.parameters.error_description));else if(e.stateMatch){var n;this.info("State is right"),e.parameters.hasOwnProperty(this.CONSTANTS.SESSION_STATE)&&this._saveItem(this.CONSTANTS.STORAGE.SESSION_STATE,e.parameters[this.CONSTANTS.SESSION_STATE]),e.parameters.hasOwnProperty(this.CONSTANTS.ACCESS_TOKEN)&&(this.info("Fragment has access token"),this._hasResource(t)||(n=this._getItem(this.CONSTANTS.STORAGE.TOKEN_KEYS)||"",this._saveItem(this.CONSTANTS.STORAGE.TOKEN_KEYS,n+t+this.CONSTANTS.RESOURCE_DELIMETER)),this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+t,e.parameters[this.CONSTANTS.ACCESS_TOKEN]),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+t,this._expiresIn(e.parameters[this.CONSTANTS.EXPIRES_IN]))),e.parameters.hasOwnProperty(this.CONSTANTS.ID_TOKEN)&&(this.info("Fragment has id token"),this._loginInProgress=!1,this._user=this._createUser(e.parameters[this.CONSTANTS.ID_TOKEN]),this._user&&this._user.profile?this._matchNonce(this._user)?(this._saveItem(this.CONSTANTS.STORAGE.IDTOKEN,e.parameters[this.CONSTANTS.ID_TOKEN]),t=this.config.loginResource?this.config.loginResource:this.config.clientId,this._hasResource(t)||(n=this._getItem(this.CONSTANTS.STORAGE.TOKEN_KEYS)||"",this._saveItem(this.CONSTANTS.STORAGE.TOKEN_KEYS,n+t+this.CONSTANTS.RESOURCE_DELIMETER)),this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+t,e.parameters[this.CONSTANTS.ID_TOKEN]),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+t,this._user.profile.exp)):(this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,"Nonce received: "+this._user.profile.nonce+" is not same as requested: "+this._getItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN)),this._user=null):(e.parameters.error="invalid id_token",e.parameters.error_description="Invalid id_token. id_token: "+e.parameters[this.CONSTANTS.ID_TOKEN],this._saveItem(this.CONSTANTS.STORAGE.ERROR,"invalid id_token"),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,"Invalid id_token. id_token: "+e.parameters[this.CONSTANTS.ID_TOKEN])))}else e.parameters.error="Invalid_state",e.parameters.error_description="Invalid_state. state: "+e.stateResponse,this._saveItem(this.CONSTANTS.STORAGE.ERROR,"Invalid_state"),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,"Invalid_state. state: "+e.stateResponse);this._saveItem(this.CONSTANTS.STORAGE.RENEW_STATUS+t,this.CONSTANTS.TOKEN_RENEW_STATUS_COMPLETED)},n.prototype.getResourceForEndpoint=function(e){if(this.config&&this.config.anonymousEndpoints)for(var t=0;t<this.config.anonymousEndpoints.length;t++)if(e.indexOf(this.config.anonymousEndpoints[t])>-1)return null;if(this.config&&this.config.endpoints)for(var n in this.config.endpoints)if(e.indexOf(n)>-1)return this.config.endpoints[n];return e.indexOf("http://")>-1||e.indexOf("https://")>-1?this._getHostFromUri(e)===this._getHostFromUri(this.config.redirectUri)?this.config.loginResource:null:this.config.loginResource},n.prototype._getHostFromUri=function(e){var t=String(e).replace(/^(https?:)\/\//,"");return t.split("/")[0]},n.prototype.handleWindowCallback=function(e){if(null==e&&(e=window.location.hash),this.isCallback(e)){var t=null,n=!1;this._openedWindows.length>0&&this._openedWindows[this._openedWindows.length-1].opener&&this._openedWindows[this._openedWindows.length-1].opener._adalInstance?(t=this._openedWindows[this._openedWindows.length-1].opener._adalInstance,n=!0):window.parent&&window.parent._adalInstance&&(t=window.parent._adalInstance);var r,o,i=t.getRequestInfo(e),a=null;o=n||window.parent!==window?t._callBackMappedToRenewStates[i.stateResponse]:t.callback,t.info("Returned from redirect url"),t.saveTokenFromHash(i),i.requestType===this.REQUEST_TYPE.RENEW_TOKEN&&window.parent?(window.parent!==window?t.verbose("Window is in iframe, acquiring token silently"):t.verbose("acquiring token interactive in progress"),r=i.parameters[t.CONSTANTS.ACCESS_TOKEN]||i.parameters[t.CONSTANTS.ID_TOKEN],a=t.CONSTANTS.ACCESS_TOKEN):i.requestType===this.REQUEST_TYPE.LOGIN&&(r=i.parameters[t.CONSTANTS.ID_TOKEN],a=t.CONSTANTS.ID_TOKEN);var s=i.parameters[t.CONSTANTS.ERROR_DESCRIPTION],u=i.parameters[t.CONSTANTS.ERROR];try{o&&o(s,r,u,a)}catch(e){t.error("Error occurred in user defined callback function: "+e)}window.parent!==window||n||(t.config.navigateToLoginRequestUrl?window.location.href=t._getItem(t.CONSTANTS.STORAGE.LOGIN_REQUEST):window.location.hash="")}},n.prototype._getNavigateUrl=function(e,t){var n="common";this.config.tenant&&(n=this.config.tenant);var r=this.instance+n+"/oauth2/authorize"+this._serialize(e,this.config,t)+this._addLibMetadata();return this.info("Navigate url:"+r),r},n.prototype._extractIdToken=function(e){var t=this._decodeJwt(e);if(!t)return null;try{var n=t.JWSPayload,r=this._base64DecodeStringUrlSafe(n);return r?JSON.parse(r):(this.info("The returned id_token could not be base64 url safe decoded."),null)}catch(e){this.error("The returned id_token could not be decoded",e)}return null},n.prototype._base64DecodeStringUrlSafe=function(e){return e=e.replace(/-/g,"+").replace(/_/g,"/"),window.atob?decodeURIComponent(escape(window.atob(e))):decodeURIComponent(escape(this._decode(e)))},n.prototype._decode=function(e){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",n=(e=String(e).replace(/=+$/,"")).length;if(n%4==1)throw new Error("The token to be decoded is not correctly encoded.");for(var r,o,i,a,s,u,c,l,p="",d=0;d<n;d+=4){if(r=t.indexOf(e.charAt(d)),o=t.indexOf(e.charAt(d+1)),i=t.indexOf(e.charAt(d+2)),a=t.indexOf(e.charAt(d+3)),d+2===n-1){u=(s=r<<18|o<<12|i<<6)>>16&255,c=s>>8&255,p+=String.fromCharCode(u,c);break}if(d+1===n-1){u=(s=r<<18|o<<12)>>16&255,p+=String.fromCharCode(u);break}u=(s=r<<18|o<<12|i<<6|a)>>16&255,c=s>>8&255,l=255&s,p+=String.fromCharCode(u,c,l)}return p},n.prototype._decodeJwt=function(e){if(this._isEmpty(e))return null;var t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(e);return!t||t.length<4?(this.warn("The returned id_token is not parseable."),null):{header:t[1],JWSPayload:t[2],JWSSig:t[3]}},n.prototype._convertUrlSafeToRegularBase64EncodedString=function(e){return e.replace("-","+").replace("_","/")},n.prototype._serialize=function(e,t,n){var r=[];if(null!==t){r.push("?response_type="+e),r.push("client_id="+encodeURIComponent(t.clientId)),n&&r.push("resource="+encodeURIComponent(n)),r.push("redirect_uri="+encodeURIComponent(t.redirectUri)),r.push("state="+encodeURIComponent(t.state)),t.hasOwnProperty("slice")&&r.push("slice="+encodeURIComponent(t.slice)),t.hasOwnProperty("extraQueryParameter")&&r.push(t.extraQueryParameter);var o=t.correlationId?t.correlationId:this._guid();r.push("client-request-id="+encodeURIComponent(o))}return r.join("&")},n.prototype._deserialize=function(e){var t,n=/\+/g,r=/([^&=]+)=([^&]*)/g,o=function(e){return decodeURIComponent(e.replace(n," "))},i={};for(t=r.exec(e);t;)i[o(t[1])]=o(t[2]),t=r.exec(e);return i},n.prototype._decimalToHex=function(e){for(var t=e.toString(16);t.length<2;)t="0"+t;return t},n.prototype._guid=function(){var e=window.crypto||window.msCrypto;if(e&&e.getRandomValues){var t=new Uint8Array(16);return e.getRandomValues(t),t[6]|=64,t[6]&=79,t[8]|=128,t[8]&=191,this._decimalToHex(t[0])+this._decimalToHex(t[1])+this._decimalToHex(t[2])+this._decimalToHex(t[3])+"-"+this._decimalToHex(t[4])+this._decimalToHex(t[5])+"-"+this._decimalToHex(t[6])+this._decimalToHex(t[7])+"-"+this._decimalToHex(t[8])+this._decimalToHex(t[9])+"-"+this._decimalToHex(t[10])+this._decimalToHex(t[11])+this._decimalToHex(t[12])+this._decimalToHex(t[13])+this._decimalToHex(t[14])+this._decimalToHex(t[15])}for(var n="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",r="0123456789abcdef",o=0,i="",a=0;a<36;a++)"-"!==n[a]&&"4"!==n[a]&&(o=16*Math.random()|0),"x"===n[a]?i+=r[o]:"y"===n[a]?(o&=3,i+=r[o|=8]):i+=n[a];return i},n.prototype._expiresIn=function(e){return e||(e=3599),this._now()+parseInt(e,10)},n.prototype._now=function(){return Math.round((new Date).getTime()/1e3)},n.prototype._addAdalFrame=function(e){if(void 0!==e){this.info("Add adal frame to document:"+e);var t=document.getElementById(e);if(!t){if(document.createElement&&document.documentElement&&(window.opera||-1===window.navigator.userAgent.indexOf("MSIE 5.0"))){var n=document.createElement("iframe");n.setAttribute("id",e),n.setAttribute("aria-hidden","true"),n.style.visibility="hidden",n.style.position="absolute",n.style.width=n.style.height=n.borderWidth="0px",t=document.getElementsByTagName("body")[0].appendChild(n)}else document.body&&document.body.insertAdjacentHTML&&document.body.insertAdjacentHTML("beforeEnd",'<iframe name="'+e+'" id="'+e+'" style="display:none"></iframe>');window.frames&&window.frames[e]&&(t=window.frames[e])}return t}},n.prototype._saveItem=function(e,t,n){if(this.config&&this.config.cacheLocation&&"localStorage"===this.config.cacheLocation){if(!this._supportsLocalStorage())return this.info("Local storage is not supported"),!1;if(n){var r=this._getItem(e)||"";localStorage.setItem(e,r+t+this.CONSTANTS.CACHE_DELIMETER)}else localStorage.setItem(e,t);return!0}return this._supportsSessionStorage()?(sessionStorage.setItem(e,t),!0):(this.info("Session storage is not supported"),!1)},n.prototype._getItem=function(e){return this.config&&this.config.cacheLocation&&"localStorage"===this.config.cacheLocation?this._supportsLocalStorage()?localStorage.getItem(e):(this.info("Local storage is not supported"),null):this._supportsSessionStorage()?sessionStorage.getItem(e):(this.info("Session storage is not supported"),null)},n.prototype._supportsLocalStorage=function(){try{return!!window.localStorage&&(window.localStorage.setItem("storageTest","A"),"A"==window.localStorage.getItem("storageTest")&&(window.localStorage.removeItem("storageTest"),!window.localStorage.getItem("storageTest")))}catch(e){return!1}},n.prototype._supportsSessionStorage=function(){try{return!!window.sessionStorage&&(window.sessionStorage.setItem("storageTest","A"),"A"==window.sessionStorage.getItem("storageTest")&&(window.sessionStorage.removeItem("storageTest"),!window.sessionStorage.getItem("storageTest")))}catch(e){return!1}},n.prototype._cloneConfig=function(e){if(null===e||"object"!=typeof e)return e;var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t},n.prototype._addLibMetadata=function(){return"&x-client-SKU=Js&x-client-Ver="+this._libVersion()},n.prototype.log=function(e,t,n,r){if(e<=Logging.level){if(!Logging.piiLoggingEnabled&&r)return;var o=(new Date).toUTCString(),i="";i=this.config.correlationId?o+":"+this.config.correlationId+"-"+this._libVersion()+"-"+this.CONSTANTS.LEVEL_STRING_MAP[e]+" "+t:o+":"+this._libVersion()+"-"+this.CONSTANTS.LEVEL_STRING_MAP[e]+" "+t,n&&(i+="\nstack:\n"+n.stack),Logging.log(i)}},n.prototype.error=function(e,t){this.log(this.CONSTANTS.LOGGING_LEVEL.ERROR,e,t)},n.prototype.warn=function(e){this.log(this.CONSTANTS.LOGGING_LEVEL.WARN,e,null)},n.prototype.info=function(e){this.log(this.CONSTANTS.LOGGING_LEVEL.INFO,e,null)},n.prototype.verbose=function(e){this.log(this.CONSTANTS.LOGGING_LEVEL.VERBOSE,e,null)},n.prototype.errorPii=function(e,t){this.log(this.CONSTANTS.LOGGING_LEVEL.ERROR,e,t,!0)},n.prototype.warnPii=function(e){this.log(this.CONSTANTS.LOGGING_LEVEL.WARN,e,null,!0)},n.prototype.infoPii=function(e){this.log(this.CONSTANTS.LOGGING_LEVEL.INFO,e,null,!0)},n.prototype.verbosePii=function(e){this.log(this.CONSTANTS.LOGGING_LEVEL.VERBOSE,e,null,!0)},n.prototype._libVersion=function(){return"1.0.17"},void 0!==e&&e.exports&&(e.exports=n,e.exports.inject=function(e){return new n(e)}),n}()},,function(e,t,n){"use strict";function r(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),r(n(13)),r(n(9)),r(n(6)),r(n(8)),r(n(7)),r(n(15))},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(a,s)}u((r=r.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=n(4),s=n(7),u=n(8),c=n(6),l=n(9),p=n(0),d=n(17);n(14);var f=function(){function e(){}return e.getTermFromSearchSingleTaxonomyField=function(e){var t=null;try{if(i.stringIsNullOrEmpty(e))console.error('getTermFromSearchSingleTaxonomyField: "taxFieldValue" is empty');else{var n=e.match(/(;|\n\n)L0\|#0(.*?)\|(.*?)(;|\n\n)GTSet\|#/i);if(null!=n){var r=new s.models.Term;r.ID=n[2],r.Name=n[3],t=r}else console.error('getTermFromSearchSingleTaxonomyField: no regular expression matches found in "'+e+'"')}}catch(t){console.error('getTermFromSearchSingleTaxonomyField: error has occured when processing "'+e+'": '+t)}return t},e.getTermsFromSearchMultiTaxonomyField=function(e){var t=this,n=[];try{if(i.stringIsNullOrEmpty(e))console.error('getTermsFromSearchMultiTaxonomyField: "taxFieldValue" is empty');else{var r=e.match(/GP0\|#.*?(;|\n\n).*?(?=(;|\n\n)GP0\|#|$)/gi);null!=r?r.forEach(function(e){if(!i.stringIsNullOrEmpty(e)){var r=t.getTermFromSearchSingleTaxonomyField(e);null!=r&&n.push(r)}}):console.error('getTermsFromSearchMultiTaxonomyField: no regular expression matches found in "'+e+'"')}}catch(t){console.error('getTermsFromSearchMultiTaxonomyField: error has occured when processing "'+e+'": '+t)}return n},e.getTermsFromMultiTaxonomyField=function(e){var t=[];try{if(i.stringIsNullOrEmpty(e))console.error('getTermsFromMultiTaxonomyField: "taxFieldValue" is empty');else{var n=e.split(";");n.length>0?n.forEach(function(e){if(!i.stringIsNullOrEmpty(e)){var n=e.split("|"),r=new s.models.Term;r.ID=n[1],r.Name=n[0],r.PathOfTerm="",t.push(r)}}):console.error('getTermsFromMultiTaxonomyField: no regular expression matches found in "'+e+'"')}}catch(t){console.error('getTermsFromMultiTaxonomyField: error has occured when processing "'+e+'": '+t)}return t},e.configurePnP=function(e){a.sp.setup({spfxContext:e,sp:{headers:{Accept:"application/json; odata=nometadata"}}}),d.taxonomy.setup({spfxContext:e})},e.getUserProperties=function(e,t){return r(this,void 0,void 0,function(){var n,r,u,p,d,f,h,y,g,m,v,b,S,_,T,I;return o(this,function(o){switch(o.label){case 0:(n=new s.models.UserProperties).LocationGUID="",n.Location="",n.OrganizationGUID="",n.Organization="",n.TopicsGUIDs=[],n.Topics=[],n.MyLinksLocation="",n.IsDataLoaded=!1,o.label=1;case 1:return o.trys.push([1,3,,4]),this.configurePnP(t),r=l.util.getClaimsUserName(e),[4,a.sp.profiles.getPropertiesFor(r)];case 2:for(u=o.sent(),p=u.UserProfileProperties,d=!1,f=!1,h=!1,y=!1,g=!1,m=!1,v=!1,b=0;b<p.length;b++){switch((S=p[b]).Key){case c.Constants.UserProfileProperties.SHARE_LOCATION_ID:n.LocationGUID=S.Value,d=!0;break;case c.Constants.UserProfileProperties.SHARE_LOCATION:n.Location=S.Value,f=!0;break;case c.Constants.UserProfileProperties.SHARE_ORGANIZATION_ID:n.OrganizationGUID=S.Value,h=!0;break;case c.Constants.UserProfileProperties.SHARE_ORGANIZATION:n.Organization=S.Value,y=!0;break;case c.Constants.UserProfileProperties.SHARE_TOPICS_IDS:i.stringIsNullOrEmpty(S.Value)||(_=S.Value.split("|")).length>0&&_.forEach(function(e){i.stringIsNullOrEmpty(e)||n.TopicsGUIDs.push(e)}),g=!0;break;case c.Constants.UserProfileProperties.SHARE_TOPICS:i.stringIsNullOrEmpty(S.Value)||(T=S.Value.split("|")).length>0&&T.forEach(function(e){i.stringIsNullOrEmpty(e)||n.Topics.push(e)}),m=!0;break;case c.Constants.UserProfileProperties.SHARE_MYLINKS_LOCATION:n.MyLinksLocation=S.Value,v=!0}if(d&&f&&h&&y&&g&&m&&v)break}return n.IsDataLoaded=!0,[3,4];case 3:return I=o.sent(),console.error('getUserProperties: error has occured when processing "'+e+'": '+I),[3,4];case 4:return[2,n]}})})},e.getCachedUserProperties=function(e,t){return r(this,void 0,void 0,function(){var n,r,a,s=this;return o(this,function(o){switch(o.label){case 0:n=null,o.label=1;case 1:return o.trys.push([1,3,,4]),r=l.util.getClaimsUserName(e),[4,(n=u.storage.getOrPutPromiseValueInStorage(c.Constants.CacheKeys.USER_PROPERTIES+"_"+r,"local",function(){return s.getUserProperties(r,t)},i.dateAdd(new Date,"minute",60))).then(function(t){if(!t.IsDataLoaded){var n=l.util.getClaimsUserName(e);u.storage.clearKeyFromLocalStorage(c.Constants.CacheKeys.USER_PROPERTIES+"_"+n)}return t.IsDataLoaded})];case 2:return o.sent()||(n=null),[3,4];case 3:return a=o.sent(),console.error('getCachedUserProperties: error has occured when processing "'+e+'": '+a),[3,4];case 4:return[2,n]}})})},e.clearCachedUserProperties=function(e){var t=l.util.getClaimsUserName(e);window[c.Constants.CacheKeys.USER_PROPERTIES+"_"+t]=null,(new p.PnPClientStorage).local.delete(c.Constants.CacheKeys.USER_PROPERTIES+"_"+t)},e.getTermsByIDs=function(e,t){return r(this,void 0,void 0,function(){var n,r,a,u,c,l,p,f,h;return o(this,function(o){switch(o.label){case 0:return o.trys.push([0,8,,9]),[4,d.taxonomy.termStores.get()];case 1:return n=o.sent(),[4,n[0].getTermSetById(t).get()];case 2:r=o.sent(),a=[],u=0,c=e,o.label=3;case 3:return u<c.length?(l=c[u],i.stringIsNullOrEmpty(l)?[3,5]:[4,r.getTermById(l).get()]):[3,7];case 4:return p=o.sent(),f=new s.models.Term,void 0!=p.Id?(f.ID=p.Id.replace("/Guid(","").replace(")/",""),f.Name=p.Name,f.PathOfTerm=p.PathOfTerm,a.push(f)):a.push(null),[3,6];case 5:a.push(null),o.label=6;case 6:return u++,[3,3];case 7:return[2,a];case 8:throw h=o.sent(),console.error(h),h;case 9:return[2]}})})},e.getChildTerms=function(e,t){return r(this,void 0,void 0,function(){var n,r,a,u,c;return o(this,function(o){switch(o.label){case 0:return[4,d.taxonomy.termStores.get()];case 1:return r=o.sent(),[4,(a=r[0]).getTermSetById(t).get()];case 2:return u=o.sent(),c=[],i.stringIsNullOrEmpty(e)?[4,u.terms.get()]:[3,4];case 3:return n=o.sent(),[3,7];case 4:return[4,a.getTermSetById(e).get()];case 5:return[4,o.sent().terms.get()];case 6:n=o.sent(),o.label=7;case 7:return[4,n.forEach(function(e){var t=new s.models.Term;0==e.IsDeprecated&&(t.ID=e.Id.replace("/Guid(","").replace(")/",""),t.Name=e.Name,t.PathOfTerm=e.PathOfTerm,c.push(t))})];case 8:return o.sent(),[2,c]}})})},e.getParentTermsByID=function(e,t){return r(this,void 0,void 0,function(){var n,i,a,u,c=this;return o(this,function(l){switch(l.label){case 0:return[4,d.taxonomy.termStores.get()];case 1:return n=l.sent(),[4,n[0].getTermSetById(t).get()];case 2:return i=l.sent(),[],a=!1,[4,Promise.all(e.map(function(e){return r(c,void 0,void 0,function(){var t,n,r,s;return o(this,function(o){switch(o.label){case 0:return t=[],null!=e&&e.ParentLevelsToRetrieve>0?(a=!0,[4,i.getTermById(e.TermGUID).get()]):[3,5];case 1:n=o.sent(),r=n,s=0,o.label=2;case 2:return s<e.ParentLevelsToRetrieve?[4,r.parent.get()]:[3,5];case 3:r=o.sent(),t.push(r),o.label=4;case 4:return s++,[3,2];case 5:return[2,t]}})})}))];case 3:return u=l.sent(),a?[4,u.map(function(e){var t=[];return e.forEach(function(e){var n=new s.models.Term;n.ID=e.Id.replace("/Guid(","").replace(")/",""),n.Name=e.Name,t.push(n)}),t})]:[3,5];case 4:return[2,l.sent()];case 5:return[2,u.map(function(){return[]})]}})})},e.getViewIdFromUrl=function(e,t){return r(this,void 0,void 0,function(){var n,r,i;return o(this,function(o){switch(o.label){case 0:n=null,o.label=1;case 1:return o.trys.push([1,3,,4]),[4,a.sp.site.rootWeb.getList(e).views.select("Id").filter("ServerRelativeUrl eq '"+e+"/"+t+"'").get()];case 2:return 1===(r=o.sent()).length&&(n=r[0].Id),[3,4];case 3:return i=o.sent(),console.error('getViewIdFromUrl: error has occured when getting view "'+t+'" from list "'+e+'": '+i),[3,4];case 4:return[2,n]}})})},e.updateUserProfileProperty=function(e,t,n,i,a){return r(this,void 0,void 0,function(){var r,s,u,c,p;return o(this,function(o){switch(o.label){case 0:return o.trys.push([0,4,,5]),r=i.pageContext.site.absoluteUrl+"/_api/SP.UserProfiles.PeopleManager/SetSingleValueProfileProperty",s={headers:{"Content-Type":"application/json;odata=nometadata",accept:"application/json; odata=nometadata"},body:JSON.stringify({accountName:l.util.getClaimsUserName(e),propertyName:t,propertyValue:n})},[4,i.spHttpClient.post(r,a,s)];case 1:return(u=o.sent()).ok?[3,3]:[4,u.json()];case 2:c=o.sent(),console.error('updateUserProfileProperty: error has occured when updating User Profile Property "'+t+'" to "'+n+'" for the user "'+e+'": '+c.error.code+" - "+c.error.message),o.label=3;case 3:return[3,5];case 4:return p=o.sent(),console.error('updateUserProfileProperty: error has occured when updating User Profile Property "'+t+'" to "'+n+'" for the user "'+e+'": '+p),[3,5];case 5:return[2]}})})},e.updateMultiValueUserProfileProperty=function(e,t,n,i,a){return r(this,void 0,void 0,function(){var r,s,u,c,p;return o(this,function(o){switch(o.label){case 0:return o.trys.push([0,4,,5]),r=i.pageContext.site.absoluteUrl+"/_api/SP.UserProfiles.PeopleManager/SetMultiValuedProfileProperty",s={headers:{"Content-Type":"application/json;odata=nometadata",accept:"application/json; odata=nometadata"},body:JSON.stringify({accountName:l.util.getClaimsUserName(e),propertyName:t,propertyValues:n})},[4,i.spHttpClient.post(r,a,s)];case 1:return(u=o.sent()).ok?[3,3]:[4,u.json()];case 2:return c=o.sent(),console.error('updateUserProfileProperty: error has occured when updating User Profile Property "'+t+'" to "'+n+'" for the user "'+e+'": '+c.error.code+" - "+c.error.message),[2,!1];case 3:return[3,5];case 4:return p=o.sent(),console.error('updateUserProfileProperty: error has occured when updating User Profile Property "'+t+'" to "'+n+'" for the user "'+e+'": '+p),[2,!1];case 5:return[2,!0]}})})},e.get=function(e,t,n){return r(this,void 0,void 0,function(){var r,i,a;return o(this,function(o){switch(o.label){case 0:return r={headers:{accept:"application/json;odata.metadata=none"}},[4,t.spHttpClient.get(e,n,r)];case 1:return(i=o.sent()).ok?[2,i.json()]:[3,2];case 2:return a='get: error in response of "'+e+'": ',[4,i.text()];case 3:throw a+o.sent()}})})},e.post=function(e,t,n,i,a){return r(this,void 0,void 0,function(){var r,s,u;return o(this,function(o){switch(o.label){case 0:switch(r={body:JSON.stringify(t)},a){case"3.0":r.headers={"odata-version":a,accept:"application/json;odata=nometadata"};break;default:r.headers={accept:"application/json;odata.metadata=none"}}return[4,n.spHttpClient.post(e,i,r)];case 1:return(s=o.sent()).ok?[2,s.json()]:[3,2];case 2:return u='post: error in response of "'+e+'": ',[4,s.text()];case 3:throw u+o.sent()}})})},e.getMyFollowedSPObjects=function(e,t,n){return r(this,void 0,void 0,function(){var r,i;return o(this,function(o){switch(o.label){case 0:r=[],o.label=1;case 1:return o.trys.push([1,4,,5]),null!=e&&e>0?[4,this.get(t.pageContext.site.absoluteUrl+"/_api/social.following/my/followed(types="+e.toString()+")",t,n)]:[3,3];case 2:r=o.sent().value,o.label=3;case 3:return[3,5];case 4:throw i=o.sent(),console.error(i),i;case 5:return[2,r]}})})},e.getTermSiteCollectionIdFromGuid=function(e,t){return r(this,void 0,void 0,function(){var n,r,s;return o(this,function(o){switch(o.label){case 0:n=null,o.label=1;case 1:return o.trys.push([1,4,,5]),i.stringIsNullOrEmpty(e)?[3,3]:(this.configurePnP(t),[4,a.sp.site.rootWeb.getList(l.util.ensureURLEndsWithSlash(t.pageContext.site.serverRelativeUrl)+"Lists/"+c.Constants.ListInternalNames.TAXONOMY_LIST).items.select(c.Constants.ColumnNames.ID).filter(c.Constants.ColumnNames.TaxonomyList.ID_FOR_TERM+" eq '"+e+"'").usingCaching({key:c.Constants.CacheKeys.TERM_ID_SITE_COLLECTION+"_"+e+"_"+t.pageContext.site.id.toString(),storeName:"local",expiration:i.dateAdd(new Date,"day",1)}).get()]);case 2:null!=(r=o.sent())&&1===r.length&&(n=r[0][c.Constants.ColumnNames.ID]),o.label=3;case 3:return[3,5];case 4:return s=o.sent(),console.error('getTermSiteCollectionIdFromGuid: error has occured when getting Term ID for "'+e+'" in the site collection "'+t.pageContext.site.serverAbsoluteUrl+'": '+s),[3,5];case 5:return[2,n]}})})},e.prototype.asyncForEach=function(e,t){return r(this,void 0,void 0,function(){var n;return o(this,function(r){switch(r.label){case 0:n=0,r.label=1;case 1:return n<e.length?[4,t(e[n],n,e)]:[3,4];case 2:r.sent(),r.label=3;case 3:return n++,[3,1];case 4:return[2]}})})},e.getCurrentUserEmail=function(e){return r(this,void 0,void 0,function(){return o(this,function(t){switch(t.label){case 0:return this.configurePnP(e),[4,a.sp.web.currentUser.get()];case 1:return[2,t.sent().Email.toString()]}})})},e.getTenantProperty=function(e,t){return r(this,void 0,void 0,function(){var n;return o(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),this.configurePnP(e),[4,a.sp.web.getStorageEntity(t)];case 1:return[2,r.sent().Value];case 2:return n=r.sent(),[2,Promise.reject(n.message)];case 3:return[2]}})})},e}();t.sp=f},function(e,t,n){window,e.exports=function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=60)}([function(e,t){var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(e,t,n){var r=n(35)("wks"),o=n(22),i=n(0).Symbol,a="function"==typeof i;(e.exports=function(e){return r[e]||(r[e]=a&&i[e]||(a?i:o)("Symbol."+e))}).store=r},function(e,t,n){"use strict";var r=n(7);e.exports=function(e){if(!r(e))throw new TypeError("Cannot use null or undefined");return e}},function(e,t,n){"use strict";e.exports=function(e){if("function"!=typeof e)throw new TypeError(e+" is not a function");return e}},function(e,t,n){"use strict";e.exports=n(108)()?Symbol:n(109)},function(e,t,n){var r=n(12);e.exports=function(e){if(!r(e))throw TypeError(e+" is not an object!");return e}},function(e,t,n){"use strict";var r=n(31),o=n(57),i=n(104),a=n(58);(e.exports=function(e,t){var n,i,s,u,c;return arguments.length<2||"string"!=typeof e?(u=t,t=e,e=null):u=arguments[2],null==e?(n=s=!0,i=!1):(n=a.call(e,"c"),i=a.call(e,"e"),s=a.call(e,"w")),c={value:t,configurable:n,enumerable:i,writable:s},u?r(o(u),c):c}).gs=function(e,t,n){var s,u,c,l;return"string"!=typeof e?(c=n,n=t,t=e,e=null):c=arguments[3],null==t?t=void 0:i(t)?null==n?n=void 0:i(n)||(c=n,n=void 0):(c=t,t=n=void 0),null==e?(s=!0,u=!1):(s=a.call(e,"c"),u=a.call(e,"e")),l={get:t,set:n,configurable:s,enumerable:u},c?r(o(c),l):l}},function(e,t,n){"use strict";var r=n(53)();e.exports=function(e){return e!==r&&null!==e}},function(e,t,n){var r=n(14);e.exports=function(e,t,n){if(r(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,o){return e.call(t,n,r,o)}}return function(){return e.apply(t,arguments)}}},function(e,t){var n=e.exports={version:"2.5.7"};"number"==typeof __e&&(__e=n)},function(e,t,n){var r=n(11),o=n(25);e.exports=n(13)?function(e,t,n){return r.f(e,t,o(1,n))}:function(e,t,n){return e[t]=n,e}},function(e,t,n){var r=n(5),o=n(61),i=n(62),a=Object.defineProperty;t.f=n(13)?Object.defineProperty:function(e,t,n){if(r(e),t=i(t,!0),r(n),o)try{return a(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t,n){e.exports=!n(36)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},function(e,t){e.exports={}},function(e,t,n){"use strict";e.exports=n(55)()?Object.setPrototypeOf:n(56)},function(e,t,n){"use strict";var r=Object.prototype.toString,o=r.call(function(){return arguments}());e.exports=function(e){return r.call(e)===o}},function(e,t,n){"use strict";var r=Object.prototype.toString,o=r.call("");e.exports=function(e){return"string"==typeof e||e&&"object"==typeof e&&(e instanceof String||r.call(e)===o)||!1}},function(e,t){e.exports=!1},function(e,t){var n=0,r=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++n+r).toString(36))}},function(e,t,n){var r=n(0),o=n(9),i=n(10),a=n(26),s=n(8),u=function(e,t,n){var c,l,p,d,f=e&u.F,h=e&u.G,y=e&u.S,g=e&u.P,m=e&u.B,v=h?r:y?r[t]||(r[t]={}):(r[t]||{}).prototype,b=h?o:o[t]||(o[t]={}),S=b.prototype||(b.prototype={});for(c in h&&(n=t),n)p=((l=!f&&v&&void 0!==v[c])?v:n)[c],d=m&&l?s(p,r):g&&"function"==typeof p?s(Function.call,p):p,v&&a(v,c,p,e&u.U),b[c]!=p&&i(b,c,d),g&&S[c]!=p&&(S[c]=p)};r.core=o,u.F=1,u.G=2,u.S=4,u.P=8,u.B=16,u.W=32,u.U=64,u.R=128,e.exports=u},function(e,t,n){var r=n(12),o=n(0).document,i=r(o)&&r(o.createElement);e.exports=function(e){return i?o.createElement(e):{}}},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t,n){var r=n(0),o=n(10),i=n(16),a=n(22)("src"),s=Function.toString,u=(""+s).split("toString");n(9).inspectSource=function(e){return s.call(e)},(e.exports=function(e,t,n,s){var c="function"==typeof n;c&&(i(n,"name")||o(n,"name",t)),e[t]!==n&&(c&&(i(n,a)||o(n,a,e[t]?""+e[t]:u.join(String(t)))),e===r?e[t]=n:s?e[t]?e[t]=n:o(e,t,n):(delete e[t],o(e,t,n)))})(Function.prototype,"toString",function(){return"function"==typeof this&&this[a]||s.call(this)})},function(e,t,n){var r=n(39),o=Math.min;e.exports=function(e){return e>0?o(r(e),9007199254740991):0}},function(e,t,n){var r=n(11).f,o=n(16),i=n(1)("toStringTag");e.exports=function(e,t,n){e&&!o(e=n?e:e.prototype,i)&&r(e,i,{configurable:!0,value:t})}},function(e,t,n){var r=n(75),o=n(46);e.exports=function(e){return r(o(e))}},function(e,t,n){var r=n(35)("keys"),o=n(22);e.exports=function(e){return r[e]||(r[e]=o(e))}},function(e,t,n){"use strict";e.exports=n(99)()?Object.assign:n(100)},function(e,t,n){"use strict";var r,o=n(52),i=n(31),a=n(3),s=n(2),u=n(6),c=n(116),l=n(4),p=Object.defineProperty,d=Object.defineProperties;e.exports=r=function(e,t){if(!(this instanceof r))throw new TypeError("Constructor requires 'new'");d(this,{__list__:u("w",s(e)),__context__:u("w",t),__nextIndex__:u("w",0)}),t&&(a(t.on),t.on("_add",this._onAdd),t.on("_delete",this._onDelete),t.on("_clear",this._onClear))},delete r.prototype.constructor,d(r.prototype,i({_next:u(function(){var e;if(this.__list__)return this.__redo__&&void 0!==(e=this.__redo__.shift())?e:this.__nextIndex__<this.__list__.length?this.__nextIndex__++:void this._unBind()}),next:u(function(){return this._createResult(this._next())}),_createResult:u(function(e){return void 0===e?{done:!0,value:void 0}:{done:!1,value:this._resolve(e)}}),_resolve:u(function(e){return this.__list__[e]}),_unBind:u(function(){this.__list__=null,delete this.__redo__,this.__context__&&(this.__context__.off("_add",this._onAdd),this.__context__.off("_delete",this._onDelete),this.__context__.off("_clear",this._onClear),this.__context__=null)}),toString:u(function(){return"[object "+(this[l.toStringTag]||"Object")+"]"})},c({_onAdd:u(function(e){e>=this.__nextIndex__||(++this.__nextIndex__,this.__redo__?(this.__redo__.forEach(function(t,n){t>=e&&(this.__redo__[n]=++t)},this),this.__redo__.push(e)):p(this,"__redo__",u("c",[e])))}),_onDelete:u(function(e){var t;e>=this.__nextIndex__||(--this.__nextIndex__,this.__redo__&&(-1!==(t=this.__redo__.indexOf(e))&&this.__redo__.splice(t,1),this.__redo__.forEach(function(t,n){t>e&&(this.__redo__[n]=--t)},this)))}),_onClear:u(function(){this.__redo__&&o.call(this.__redo__),this.__nextIndex__=0})}))),p(r.prototype,l.iterator,u(function(){return this}))},function(e,t,n){"use strict";var r,o,i,a,s=n(21),u=n(0),c=n(8),l=n(34),p=n(23),d=n(12),f=n(14),h=n(63),y=n(64),g=n(65),m=n(41).set,v=n(67)(),b=n(43),S=n(68),_=n(69),T=n(70),I=u.TypeError,C=u.process,w=C&&C.versions,O=w&&w.v8||"",P=u.Promise,E="process"==l(C),x=function(){},N=o=b.f,A=!!function(){try{var e=P.resolve(1),t=(e.constructor={})[n(1)("species")]=function(e){e(x,x)};return(E||"function"==typeof PromiseRejectionEvent)&&e.then(x)instanceof t&&0!==O.indexOf("6.6")&&-1===_.indexOf("Chrome/66")}catch(e){}}(),R=function(e){var t;return!(!d(e)||"function"!=typeof(t=e.then))&&t},M=function(e,t){if(!e._n){e._n=!0;var n=e._c;v(function(){for(var r=e._v,o=1==e._s,i=0,a=function(t){var n,i,a,s=o?t.ok:t.fail,u=t.resolve,c=t.reject,l=t.domain;try{s?(o||(2==e._h&&L(e),e._h=1),!0===s?n=r:(l&&l.enter(),n=s(r),l&&(l.exit(),a=!0)),n===t.promise?c(I("Promise-chain cycle")):(i=R(n))?i.call(n,u,c):u(n)):c(r)}catch(e){l&&!a&&l.exit(),c(e)}};n.length>i;)a(n[i++]);e._c=[],e._n=!1,t&&!e._h&&j(e)})}},j=function(e){m.call(u,function(){var t,n,r,o=e._v,i=D(e);if(i&&(t=S(function(){E?C.emit("unhandledRejection",o,e):(n=u.onunhandledrejection)?n({promise:e,reason:o}):(r=u.console)&&r.error&&r.error("Unhandled promise rejection",o)}),e._h=E||D(e)?2:1),e._a=void 0,i&&t.e)throw t.v})},D=function(e){return 1!==e._h&&0===(e._a||e._c).length},L=function(e){m.call(u,function(){var t;E?C.emit("rejectionHandled",e):(t=u.onrejectionhandled)&&t({promise:e,reason:e._v})})},k=function(e){var t=this;t._d||(t._d=!0,(t=t._w||t)._v=e,t._s=2,t._a||(t._a=t._c.slice()),M(t,!0))},U=function(e){var t,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===e)throw I("Promise can't be resolved itself");(t=R(e))?v(function(){var r={_w:n,_d:!1};try{t.call(e,c(U,r,1),c(k,r,1))}catch(e){k.call(r,e)}}):(n._v=e,n._s=1,M(n,!1))}catch(e){k.call({_w:n,_d:!1},e)}}};A||(P=function(e){h(this,P,"Promise","_h"),f(e),r.call(this);try{e(c(U,this,1),c(k,this,1))}catch(e){k.call(this,e)}},(r=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=n(71)(P.prototype,{then:function(e,t){var n=N(g(this,P));return n.ok="function"!=typeof e||e,n.fail="function"==typeof t&&t,n.domain=E?C.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&M(this,!1),n.promise},catch:function(e){return this.then(void 0,e)}}),i=function(){var e=new r;this.promise=e,this.resolve=c(U,e,1),this.reject=c(k,e,1)},b.f=N=function(e){return e===P||e===a?new i(e):o(e)}),p(p.G+p.W+p.F*!A,{Promise:P}),n(28)(P,"Promise"),n(72)("Promise"),a=n(9).Promise,p(p.S+p.F*!A,"Promise",{reject:function(e){var t=N(this);return(0,t.reject)(e),t.promise}}),p(p.S+p.F*(s||!A),"Promise",{resolve:function(e){return T(s&&this===a?P:this,e)}}),p(p.S+p.F*!(A&&n(44)(function(e){P.all(e).catch(x)})),"Promise",{all:function(e){var t=this,n=N(t),r=n.resolve,o=n.reject,i=S(function(){var n=[],i=0,a=1;y(e,!1,function(e){var s=i++,u=!1;n.push(void 0),a++,t.resolve(e).then(function(e){u||(u=!0,n[s]=e,--a||r(n))},o)}),--a||r(n)});return i.e&&o(i.v),n.promise},race:function(e){var t=this,n=N(t),r=n.reject,o=S(function(){y(e,!1,function(e){t.resolve(e).then(n.resolve,r)})});return o.e&&r(o.v),n.promise}})},function(e,t,n){var r=n(15),o=n(1)("toStringTag"),i="Arguments"==r(function(){return arguments}());e.exports=function(e){var t,n,a;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),o))?n:i?r(t):"Object"==(a=r(t))&&"function"==typeof t.callee?"Arguments":a}},function(e,t,n){var r=n(9),o=n(0),i=o["__core-js_shared__"]||(o["__core-js_shared__"]={});(e.exports=function(e,t){return i[e]||(i[e]=void 0!==t?t:{})})("versions",[]).push({version:r.version,mode:n(21)?"pure":"global",copyright:"© 2018 Denis Pushkarev (zloirock.ru)"})},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t,n){var r=n(5);e.exports=function(e,t,n,o){try{return o?t(r(n)[0],n[1]):t(n)}catch(t){var i=e.return;throw void 0!==i&&r(i.call(e)),t}}},function(e,t,n){var r=n(17),o=n(1)("iterator"),i=Array.prototype;e.exports=function(e){return void 0!==e&&(r.Array===e||i[o]===e)}},function(e,t){var n=Math.ceil,r=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?r:n)(e)}},function(e,t,n){var r=n(34),o=n(1)("iterator"),i=n(17);e.exports=n(9).getIteratorMethod=function(e){if(void 0!=e)return e[o]||e["@@iterator"]||i[r(e)]}},function(e,t,n){var r,o,i,a=n(8),s=n(66),u=n(42),c=n(24),l=n(0),p=l.process,d=l.setImmediate,f=l.clearImmediate,h=l.MessageChannel,y=l.Dispatch,g=0,m={},v=function(){var e=+this;if(m.hasOwnProperty(e)){var t=m[e];delete m[e],t()}},b=function(e){v.call(e.data)};d&&f||(d=function(e){for(var t=[],n=1;arguments.length>n;)t.push(arguments[n++]);return m[++g]=function(){s("function"==typeof e?e:Function(e),t)},r(g),g},f=function(e){delete m[e]},"process"==n(15)(p)?r=function(e){p.nextTick(a(v,e,1))}:y&&y.now?r=function(e){y.now(a(v,e,1))}:h?(i=(o=new h).port2,o.port1.onmessage=b,r=a(i.postMessage,i,1)):l.addEventListener&&"function"==typeof postMessage&&!l.importScripts?(r=function(e){l.postMessage(e+"","*")},l.addEventListener("message",b,!1)):r="onreadystatechange"in c("script")?function(e){u.appendChild(c("script")).onreadystatechange=function(){u.removeChild(this),v.call(e)}}:function(e){setTimeout(a(v,e,1),0)}),e.exports={set:d,clear:f}},function(e,t,n){var r=n(0).document;e.exports=r&&r.documentElement},function(e,t,n){"use strict";var r=n(14);e.exports.f=function(e){return new function(e){var t,n;this.promise=new e(function(e,r){if(void 0!==t||void 0!==n)throw TypeError("Bad Promise constructor");t=e,n=r}),this.resolve=r(t),this.reject=r(n)}(e)}},function(e,t,n){var r=n(1)("iterator"),o=!1;try{var i=[7][r]();i.return=function(){o=!0},Array.from(i,function(){throw 2})}catch(e){}e.exports=function(e,t){if(!t&&!o)return!1;var n=!1;try{var i=[7],a=i[r]();a.next=function(){return{done:n=!0}},i[r]=function(){return a},e(i)}catch(e){}return n}},function(e,t,n){"use strict";var r=n(73),o=n(74),i=n(17),a=n(29);e.exports=n(76)(Array,"Array",function(e,t){this._t=a(e),this._i=0,this._k=t},function(){var e=this._t,t=this._k,n=this._i++;return!e||n>=e.length?(this._t=void 0,o(1)):o(0,"keys"==t?n:"values"==t?e[n]:[n,e[n]])},"values"),i.Arguments=i.Array,r("keys"),r("values"),r("entries")},function(e,t){e.exports=function(e){if(void 0==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(e,t,n){var r=n(46);e.exports=function(e){return Object(r(e))}},function(e,t,n){"use strict";var r=n(8),o=n(23),i=n(48),a=n(37),s=n(38),u=n(27),c=n(85),l=n(40);o(o.S+o.F*!n(44)(function(e){Array.from(e)}),"Array",{from:function(e){var t,n,o,p,d=i(e),f="function"==typeof this?this:Array,h=arguments.length,y=h>1?arguments[1]:void 0,g=void 0!==y,m=0,v=l(d);if(g&&(y=r(y,h>2?arguments[2]:void 0,2)),void 0==v||f==Array&&s(v))for(n=new f(t=u(d.length));t>m;m++)c(n,m,g?y(d[m],m):d[m]);else for(p=v.call(d),n=new f;!(o=p.next()).done;m++)c(n,m,g?a(p,y,[o.value,m],!0):o.value);return n.length=m,n}})},function(e,t,n){"use strict";n.d(t,"b",function(){return c}),n.d(t,"c",function(){return g}),n.d(t,"d",function(){return v}),n.d(t,"a",function(){return S}),n.d(t,"e",function(){return _});var r={searchParams:"URLSearchParams"in self,iterable:"Symbol"in self&&"iterator"in Symbol,blob:"FileReader"in self&&"Blob"in self&&function(){try{return new Blob,!0}catch(e){return!1}}(),formData:"FormData"in self,arrayBuffer:"ArrayBuffer"in self};if(r.arrayBuffer)var o=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],i=ArrayBuffer.isView||function(e){return e&&o.indexOf(Object.prototype.toString.call(e))>-1};function a(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function s(e){return"string"!=typeof e&&(e=String(e)),e}function u(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return r.iterable&&(t[Symbol.iterator]=function(){return t}),t}function c(e){this.map={},e instanceof c?e.forEach(function(e,t){this.append(t,e)},this):Array.isArray(e)?e.forEach(function(e){this.append(e[0],e[1])},this):e&&Object.getOwnPropertyNames(e).forEach(function(t){this.append(t,e[t])},this)}function l(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function p(e){return new Promise(function(t,n){e.onload=function(){t(e.result)},e.onerror=function(){n(e.error)}})}function d(e){var t=new FileReader,n=p(t);return t.readAsArrayBuffer(e),n}function f(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function h(){return this.bodyUsed=!1,this._initBody=function(e){this._bodyInit=e,e?"string"==typeof e?this._bodyText=e:r.blob&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:r.formData&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:r.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():r.arrayBuffer&&r.blob&&function(e){return e&&DataView.prototype.isPrototypeOf(e)}(e)?(this._bodyArrayBuffer=f(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):r.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(e)||i(e))?this._bodyArrayBuffer=f(e):this._bodyText=e=Object.prototype.toString.call(e):this._bodyText="",this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):r.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},r.blob&&(this.blob=function(){var e=l(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?l(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(d)}),this.text=function(){var e=l(this);if(e)return e;if(this._bodyBlob)return function(e){var t=new FileReader,n=p(t);return t.readAsText(e),n}(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),n=new Array(t.length),r=0;r<t.length;r++)n[r]=String.fromCharCode(t[r]);return n.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},r.formData&&(this.formData=function(){return this.text().then(m)}),this.json=function(){return this.text().then(JSON.parse)},this}c.prototype.append=function(e,t){e=a(e),t=s(t);var n=this.map[e];this.map[e]=n?n+", "+t:t},c.prototype.delete=function(e){delete this.map[a(e)]},c.prototype.get=function(e){return e=a(e),this.has(e)?this.map[e]:null},c.prototype.has=function(e){return this.map.hasOwnProperty(a(e))},c.prototype.set=function(e,t){this.map[a(e)]=s(t)},c.prototype.forEach=function(e,t){for(var n in this.map)this.map.hasOwnProperty(n)&&e.call(t,this.map[n],n,this)},c.prototype.keys=function(){var e=[];return this.forEach(function(t,n){e.push(n)}),u(e)},c.prototype.values=function(){var e=[];return this.forEach(function(t){e.push(t)}),u(e)},c.prototype.entries=function(){var e=[];return this.forEach(function(t,n){e.push([n,t])}),u(e)},r.iterable&&(c.prototype[Symbol.iterator]=c.prototype.entries);var y=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function g(e,t){var n=(t=t||{}).body;if(e instanceof g){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new c(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,n||null==e._bodyInit||(n=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"same-origin",!t.headers&&this.headers||(this.headers=new c(t.headers)),this.method=function(e){var t=e.toUpperCase();return y.indexOf(t)>-1?t:e}(t.method||this.method||"GET"),this.mode=t.mode||this.mode||null,this.signal=t.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&n)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(n)}function m(e){var t=new FormData;return e.trim().split("&").forEach(function(e){if(e){var n=e.split("="),r=n.shift().replace(/\+/g," "),o=n.join("=").replace(/\+/g," ");t.append(decodeURIComponent(r),decodeURIComponent(o))}}),t}function v(e,t){t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new c(t.headers),this.url=t.url||"",this._initBody(e)}g.prototype.clone=function(){return new g(this,{body:this._bodyInit})},h.call(g.prototype),h.call(v.prototype),v.prototype.clone=function(){return new v(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new c(this.headers),url:this.url})},v.error=function(){var e=new v(null,{status:0,statusText:""});return e.type="error",e};var b=[301,302,303,307,308];v.redirect=function(e,t){if(-1===b.indexOf(t))throw new RangeError("Invalid status code");return new v(null,{status:t,headers:{location:e}})};var S=self.DOMException;try{new S}catch(e){(S=function(e,t){this.message=e,this.name=t;var n=Error(e);this.stack=n.stack}).prototype=Object.create(Error.prototype),S.prototype.constructor=S}function _(e,t){return new Promise(function(n,o){var i=new g(e,t);if(i.signal&&i.signal.aborted)return o(new S("Aborted","AbortError"));var a=new XMLHttpRequest;function s(){a.abort()}a.onload=function(){var e={status:a.status,statusText:a.statusText,headers:function(e){var t=new c;return e.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach(function(e){var n=e.split(":"),r=n.shift().trim();if(r){var o=n.join(":").trim();t.append(r,o)}}),t}(a.getAllResponseHeaders()||"")};e.url="responseURL"in a?a.responseURL:e.headers.get("X-Request-URL");var t="response"in a?a.response:a.responseText;n(new v(t,e))},a.onerror=function(){o(new TypeError("Network request failed"))},a.ontimeout=function(){o(new TypeError("Network request failed"))},a.onabort=function(){o(new S("Aborted","AbortError"))},a.open(i.method,i.url,!0),"include"===i.credentials?a.withCredentials=!0:"omit"===i.credentials&&(a.withCredentials=!1),"responseType"in a&&r.blob&&(a.responseType="blob"),i.headers.forEach(function(e,t){a.setRequestHeader(t,e)}),i.signal&&(i.signal.addEventListener("abort",s),a.onreadystatechange=function(){4===a.readyState&&i.signal.removeEventListener("abort",s)}),a.send(void 0===i._bodyInit?null:i._bodyInit)})}_.polyfill=!0,self.fetch||(self.fetch=_,self.Headers=c,self.Request=g,self.Response=v)},function(e,t,n){"use strict";n(86)()||Object.defineProperty(n(87),"Map",{value:n(88),configurable:!0,enumerable:!1,writable:!0})},function(e,t,n){"use strict";var r=n(2);e.exports=function(){return r(this).length=0,this}},function(e,t,n){"use strict";e.exports=function(){}},function(e,t,n){"use strict";var r=n(93),o=Math.max;e.exports=function(e){return o(0,r(e))}},function(e,t,n){"use strict";var r=Object.create,o=Object.getPrototypeOf,i={};e.exports=function(){var e=Object.setPrototypeOf,t=arguments[0]||r;return"function"==typeof e&&o(e(t(null),i))===i}},function(e,t,n){"use strict";var r,o=n(97),i=n(2),a=Object.prototype.isPrototypeOf,s=Object.defineProperty,u={configurable:!0,enumerable:!1,writable:!0,value:void 0};r=function(e,t){if(i(e),null===t||o(t))return e;throw new TypeError("Prototype must be null or an object")},e.exports=function(e){var t,n;return e?(2===e.level?e.set?(n=e.set,t=function(e,t){return n.call(r(e,t),t),e}):t=function(e,t){return r(e,t).__proto__=t,e}:t=function e(t,n){var o;return r(t,n),(o=a.call(e.nullPolyfill,t))&&delete e.nullPolyfill.__proto__,null===n&&(n=e.nullPolyfill),t.__proto__=n,o&&s(e.nullPolyfill,"__proto__",u),t},Object.defineProperty(t,"level",{configurable:!1,enumerable:!1,writable:!1,value:e.level})):null}(function(){var e,t=Object.create(null),n={},r=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__");if(r){try{(e=r.set).call(t,n)}catch(e){}if(Object.getPrototypeOf(t)===n)return{set:e,level:2}}return t.__proto__=n,Object.getPrototypeOf(t)===n?{level:2}:((t={}).__proto__=n,Object.getPrototypeOf(t)===n&&{level:1})}()),n(98)},function(e,t,n){"use strict";var r=n(7),o=Array.prototype.forEach,i=Object.create;e.exports=function(e){var t=i(null);return o.call(arguments,function(e){r(e)&&function(e,t){var n;for(n in e)t[n]=e[n]}(Object(e),t)}),t}},function(e,t,n){"use strict";e.exports=n(105)()?String.prototype.contains:n(106)},function(e,t,n){"use strict";var r=n(112);e.exports=function(e){if(!r(e))throw new TypeError(e+" is not iterable");return e}},function(e,t,n){"use strict";n.r(t);var r=n(33);for(var o in r)"default"!==o&&function(e){n.d(t,e,function(){return r[e]})}(o);var i=n(45);for(var o in i)"default"!==o&&function(e){n.d(t,e,function(){return i[e]})}(o);var a=n(49);for(var o in a)"default"!==o&&function(e){n.d(t,e,function(){return a[e]})}(o);var s=n(50);n.d(t,"Headers",function(){return s.b}),n.d(t,"Request",function(){return s.c}),n.d(t,"Response",function(){return s.d}),n.d(t,"DOMException",function(){return s.a}),n.d(t,"fetch",function(){return s.e});var u=n(51);for(var o in u)["Headers","Request","Response","DOMException","fetch","default"].indexOf(o)<0&&function(e){n.d(t,e,function(){return u[e]})}(o)},function(e,t,n){e.exports=!n(13)&&!n(36)(function(){return 7!=Object.defineProperty(n(24)("div"),"a",{get:function(){return 7}}).a})},function(e,t,n){var r=n(12);e.exports=function(e,t){if(!r(e))return e;var n,o;if(t&&"function"==typeof(n=e.toString)&&!r(o=n.call(e)))return o;if("function"==typeof(n=e.valueOf)&&!r(o=n.call(e)))return o;if(!t&&"function"==typeof(n=e.toString)&&!r(o=n.call(e)))return o;throw TypeError("Can't convert object to primitive value")}},function(e,t){e.exports=function(e,t,n,r){if(!(e instanceof t)||void 0!==r&&r in e)throw TypeError(n+": incorrect invocation!");return e}},function(e,t,n){var r=n(8),o=n(37),i=n(38),a=n(5),s=n(27),u=n(40),c={},l={};(t=e.exports=function(e,t,n,p,d){var f,h,y,g,m=d?function(){return e}:u(e),v=r(n,p,t?2:1),b=0;if("function"!=typeof m)throw TypeError(e+" is not iterable!");if(i(m)){for(f=s(e.length);f>b;b++)if((g=t?v(a(h=e[b])[0],h[1]):v(e[b]))===c||g===l)return g}else for(y=m.call(e);!(h=y.next()).done;)if((g=o(y,v,h.value,t))===c||g===l)return g}).BREAK=c,t.RETURN=l},function(e,t,n){var r=n(5),o=n(14),i=n(1)("species");e.exports=function(e,t){var n,a=r(e).constructor;return void 0===a||void 0==(n=r(a)[i])?t:o(n)}},function(e,t){e.exports=function(e,t,n){var r=void 0===n;switch(t.length){case 0:return r?e():e.call(n);case 1:return r?e(t[0]):e.call(n,t[0]);case 2:return r?e(t[0],t[1]):e.call(n,t[0],t[1]);case 3:return r?e(t[0],t[1],t[2]):e.call(n,t[0],t[1],t[2]);case 4:return r?e(t[0],t[1],t[2],t[3]):e.call(n,t[0],t[1],t[2],t[3])}return e.apply(n,t)}},function(e,t,n){var r=n(0),o=n(41).set,i=r.MutationObserver||r.WebKitMutationObserver,a=r.process,s=r.Promise,u="process"==n(15)(a);e.exports=function(){var e,t,n,c=function(){var r,o;for(u&&(r=a.domain)&&r.exit();e;){o=e.fn,e=e.next;try{o()}catch(r){throw e?n():t=void 0,r}}t=void 0,r&&r.enter()};if(u)n=function(){a.nextTick(c)};else if(!i||r.navigator&&r.navigator.standalone)if(s&&s.resolve){var l=s.resolve(void 0);n=function(){l.then(c)}}else n=function(){o.call(r,c)};else{var p=!0,d=document.createTextNode("");new i(c).observe(d,{characterData:!0}),n=function(){d.data=p=!p}}return function(r){var o={fn:r,next:void 0};t&&(t.next=o),e||(e=o,n()),t=o}}},function(e,t){e.exports=function(e){try{return{e:!1,v:e()}}catch(e){return{e:!0,v:e}}}},function(e,t,n){var r=n(0).navigator;e.exports=r&&r.userAgent||""},function(e,t,n){var r=n(5),o=n(12),i=n(43);e.exports=function(e,t){if(r(e),o(t)&&t.constructor===e)return t;var n=i.f(e);return(0,n.resolve)(t),n.promise}},function(e,t,n){var r=n(26);e.exports=function(e,t,n){for(var o in t)r(e,o,t[o],n);return e}},function(e,t,n){"use strict";var r=n(0),o=n(11),i=n(13),a=n(1)("species");e.exports=function(e){var t=r[e];i&&t&&!t[a]&&o.f(t,a,{configurable:!0,get:function(){return this}})}},function(e,t,n){var r=n(1)("unscopables"),o=Array.prototype;void 0==o[r]&&n(10)(o,r,{}),e.exports=function(e){o[r][e]=!0}},function(e,t){e.exports=function(e,t){return{value:t,done:!!e}}},function(e,t,n){var r=n(15);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==r(e)?e.split(""):Object(e)}},function(e,t,n){"use strict";var r=n(21),o=n(23),i=n(26),a=n(10),s=n(17),u=n(77),c=n(28),l=n(84),p=n(1)("iterator"),d=!([].keys&&"next"in[].keys()),f=function(){return this};e.exports=function(e,t,n,h,y,g,m){u(n,t,h);var v,b,S,_=function(e){if(!d&&e in w)return w[e];switch(e){case"keys":case"values":return function(){return new n(this,e)}}return function(){return new n(this,e)}},T=t+" Iterator",I="values"==y,C=!1,w=e.prototype,O=w[p]||w["@@iterator"]||y&&w[y],P=O||_(y),E=y?I?_("entries"):P:void 0,x="Array"==t&&w.entries||O;if(x&&(S=l(x.call(new e)))!==Object.prototype&&S.next&&(c(S,T,!0),r||"function"==typeof S[p]||a(S,p,f)),I&&O&&"values"!==O.name&&(C=!0,P=function(){return O.call(this)}),r&&!m||!d&&!C&&w[p]||a(w,p,P),s[t]=P,s[T]=f,y)if(v={values:I?P:_("values"),keys:g?P:_("keys"),entries:E},m)for(b in v)b in w||i(w,b,v[b]);else o(o.P+o.F*(d||C),t,v);return v}},function(e,t,n){"use strict";var r=n(78),o=n(25),i=n(28),a={};n(10)(a,n(1)("iterator"),function(){return this}),e.exports=function(e,t,n){e.prototype=r(a,{next:o(1,n)}),i(e,t+" Iterator")}},function(e,t,n){var r=n(5),o=n(79),i=n(47),a=n(30)("IE_PROTO"),s=function(){},u=function(){var e,t=n(24)("iframe"),r=i.length;for(t.style.display="none",n(42).appendChild(t),t.src="javascript:",(e=t.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),u=e.F;r--;)delete u.prototype[i[r]];return u()};e.exports=Object.create||function(e,t){var n;return null!==e?(s.prototype=r(e),n=new s,s.prototype=null,n[a]=e):n=u(),void 0===t?n:o(n,t)}},function(e,t,n){var r=n(11),o=n(5),i=n(80);e.exports=n(13)?Object.defineProperties:function(e,t){o(e);for(var n,a=i(t),s=a.length,u=0;s>u;)r.f(e,n=a[u++],t[n]);return e}},function(e,t,n){var r=n(81),o=n(47);e.exports=Object.keys||function(e){return r(e,o)}},function(e,t,n){var r=n(16),o=n(29),i=n(82)(!1),a=n(30)("IE_PROTO");e.exports=function(e,t){var n,s=o(e),u=0,c=[];for(n in s)n!=a&&r(s,n)&&c.push(n);for(;t.length>u;)r(s,n=t[u++])&&(~i(c,n)||c.push(n));return c}},function(e,t,n){var r=n(29),o=n(27),i=n(83);e.exports=function(e){return function(t,n,a){var s,u=r(t),c=o(u.length),l=i(a,c);if(e&&n!=n){for(;c>l;)if((s=u[l++])!=s)return!0}else for(;c>l;l++)if((e||l in u)&&u[l]===n)return e||l||0;return!e&&-1}}},function(e,t,n){var r=n(39),o=Math.max,i=Math.min;e.exports=function(e,t){return(e=r(e))<0?o(e+t,0):i(e,t)}},function(e,t,n){var r=n(16),o=n(48),i=n(30)("IE_PROTO"),a=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=o(e),r(e,i)?e[i]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?a:null}},function(e,t,n){"use strict";var r=n(11),o=n(25);e.exports=function(e,t,n){t in e?r.f(e,t,o(0,n)):e[t]=n}},function(e,t,n){"use strict";e.exports=function(){var e,t;if("function"!=typeof Map)return!1;try{e=new Map([["raz","one"],["dwa","two"],["trzy","three"]])}catch(e){return!1}return"[object Map]"===String(e)&&3===e.size&&"function"==typeof e.clear&&"function"==typeof e.delete&&"function"==typeof e.entries&&"function"==typeof e.forEach&&"function"==typeof e.get&&"function"==typeof e.has&&"function"==typeof e.keys&&"function"==typeof e.set&&"function"==typeof e.values&&!1===(t=e.entries().next()).done&&!!t.value&&"raz"===t.value[0]&&"one"===t.value[1]}},function(e,t){e.exports=function(){return this}()},function(e,t,n){"use strict";var r,o=n(52),i=n(89),a=n(18),s=n(3),u=n(2),c=n(6),l=n(107),p=n(4),d=n(59),f=n(113),h=n(126),y=n(129),g=Function.prototype.call,m=Object.defineProperties,v=Object.getPrototypeOf;e.exports=r=function(){var e,t,n,o=arguments[0];if(!(this instanceof r))throw new TypeError("Constructor requires 'new'");return n=y&&a&&Map!==r?a(new Map,v(this)):this,null!=o&&d(o),m(n,{__mapKeysData__:c("c",e=[]),__mapValuesData__:c("c",t=[])}),o?(f(o,function(n){var r=u(n)[0];n=n[1],-1===i.call(e,r)&&(e.push(r),t.push(n))},n),n):n},y&&(a&&a(r,Map),r.prototype=Object.create(Map.prototype,{constructor:c(r)})),l(m(r.prototype,{clear:c(function(){this.__mapKeysData__.length&&(o.call(this.__mapKeysData__),o.call(this.__mapValuesData__),this.emit("_clear"))}),delete:c(function(e){var t=i.call(this.__mapKeysData__,e);return-1!==t&&(this.__mapKeysData__.splice(t,1),this.__mapValuesData__.splice(t,1),this.emit("_delete",t,e),!0)}),entries:c(function(){return new h(this,"key+value")}),forEach:c(function(e){var t,n,r=arguments[1];for(s(e),n=(t=this.entries())._next();void 0!==n;)g.call(e,r,this.__mapValuesData__[n],this.__mapKeysData__[n],this),n=t._next()}),get:c(function(e){var t=i.call(this.__mapKeysData__,e);if(-1!==t)return this.__mapValuesData__[t]}),has:c(function(e){return-1!==i.call(this.__mapKeysData__,e)}),keys:c(function(){return new h(this,"key")}),set:c(function(e,t){var n,r=i.call(this.__mapKeysData__,e);return-1===r&&(r=this.__mapKeysData__.push(e)-1,n=!0),this.__mapValuesData__[r]=t,n&&this.emit("_add",r,e),this}),size:c.gs(function(){return this.__mapKeysData__.length}),values:c(function(){return new h(this,"value")}),toString:c(function(){return"[object Map]"})})),Object.defineProperty(r.prototype,p.iterator,c(function(){return this.entries()})),Object.defineProperty(r.prototype,p.toStringTag,c("c","Map"))},function(e,t,n){"use strict";var r=n(90),o=n(54),i=n(2),a=Array.prototype.indexOf,s=Object.prototype.hasOwnProperty,u=Math.abs,c=Math.floor;e.exports=function(e){var t,n,l,p;if(!r(e))return a.apply(this,arguments);for(n=o(i(this).length),l=arguments[1],t=l=isNaN(l)?0:l>=0?c(l):o(this.length)-c(u(l));t<n;++t)if(s.call(this,t)&&(p=this[t],r(p)))return t;return-1}},function(e,t,n){"use strict";e.exports=n(91)()?Number.isNaN:n(92)},function(e,t,n){"use strict";e.exports=function(){var e=Number.isNaN;return"function"==typeof e&&!e({})&&e(NaN)&&!e(34)}},function(e,t,n){"use strict";e.exports=function(e){return e!=e}},function(e,t,n){"use strict";var r=n(94),o=Math.abs,i=Math.floor;e.exports=function(e){return isNaN(e)?0:0!==(e=Number(e))&&isFinite(e)?r(e)*i(o(e)):e}},function(e,t,n){"use strict";e.exports=n(95)()?Math.sign:n(96)},function(e,t,n){"use strict";e.exports=function(){var e=Math.sign;return"function"==typeof e&&1===e(10)&&-1===e(-20)}},function(e,t,n){"use strict";e.exports=function(e){return e=Number(e),isNaN(e)||0===e?e:e>0?1:-1}},function(e,t,n){"use strict";var r=n(7),o={function:!0,object:!0};e.exports=function(e){return r(e)&&o[typeof e]||!1}},function(e,t,n){"use strict";var r,o=Object.create;n(55)()||(r=n(56)),e.exports=function(){var e,t,n;return r?1!==r.level?o:(e={},t={},n={configurable:!1,enumerable:!1,writable:!0,value:void 0},Object.getOwnPropertyNames(Object.prototype).forEach(function(e){t[e]="__proto__"!==e?n:{configurable:!0,enumerable:!1,writable:!0,value:void 0}}),Object.defineProperties(e,t),Object.defineProperty(r,"nullPolyfill",{configurable:!1,enumerable:!1,writable:!1,value:e}),function(t,n){return o(null===t?e:t,n)}):o}()},function(e,t,n){"use strict";e.exports=function(){var e,t=Object.assign;return"function"==typeof t&&(t(e={foo:"raz"},{bar:"dwa"},{trzy:"trzy"}),e.foo+e.bar+e.trzy==="razdwatrzy")}},function(e,t,n){"use strict";var r=n(101),o=n(2),i=Math.max;e.exports=function(e,t){var n,a,s,u=i(arguments.length,2);for(e=Object(o(e)),s=function(r){try{e[r]=t[r]}catch(e){n||(n=e)}},a=1;a<u;++a)t=arguments[a],r(t).forEach(s);if(void 0!==n)throw n;return e}},function(e,t,n){"use strict";e.exports=n(102)()?Object.keys:n(103)},function(e,t,n){"use strict";e.exports=function(){try{return Object.keys("primitive"),!0}catch(e){return!1}}},function(e,t,n){"use strict";var r=n(7),o=Object.keys;e.exports=function(e){return o(r(e)?Object(e):e)}},function(e,t,n){"use strict";e.exports=function(e){return"function"==typeof e}},function(e,t,n){"use strict";var r="razdwatrzy";e.exports=function(){return"function"==typeof r.contains&&!0===r.contains("dwa")&&!1===r.contains("foo")}},function(e,t,n){"use strict";var r=String.prototype.indexOf;e.exports=function(e){return r.call(this,e,arguments[1])>-1}},function(e,t,n){"use strict";var r,o,i,a,s,u,c,l=n(6),p=n(3),d=Function.prototype.apply,f=Function.prototype.call,h=Object.create,y=Object.defineProperty,g=Object.defineProperties,m=Object.prototype.hasOwnProperty,v={configurable:!0,enumerable:!1,writable:!0};s={on:r=function(e,t){var n;return p(t),m.call(this,"__ee__")?n=this.__ee__:(n=v.value=h(null),y(this,"__ee__",v),v.value=null),n[e]?"object"==typeof n[e]?n[e].push(t):n[e]=[n[e],t]:n[e]=t,this},once:o=function(e,t){var n,o;return p(t),o=this,r.call(this,e,n=function(){i.call(o,e,n),d.call(t,this,arguments)}),n.__eeOnceListener__=t,this},off:i=function(e,t){var n,r,o,i;if(p(t),!m.call(this,"__ee__"))return this;if(!(n=this.__ee__)[e])return this;if("object"==typeof(r=n[e]))for(i=0;o=r[i];++i)o!==t&&o.__eeOnceListener__!==t||(2===r.length?n[e]=r[i?0:1]:r.splice(i,1));else r!==t&&r.__eeOnceListener__!==t||delete n[e];return this},emit:a=function(e){var t,n,r,o,i;if(m.call(this,"__ee__")&&(o=this.__ee__[e]))if("object"==typeof o){for(n=arguments.length,i=new Array(n-1),t=1;t<n;++t)i[t-1]=arguments[t];for(o=o.slice(),t=0;r=o[t];++t)d.call(r,this,i)}else switch(arguments.length){case 1:f.call(o,this);break;case 2:f.call(o,this,arguments[1]);break;case 3:f.call(o,this,arguments[1],arguments[2]);break;default:for(n=arguments.length,i=new Array(n-1),t=1;t<n;++t)i[t-1]=arguments[t];d.call(o,this,i)}}},u={on:l(r),once:l(o),off:l(i),emit:l(a)},c=g({},u),e.exports=t=function(e){return null==e?h(c):g(Object(e),u)},t.methods=s},function(e,t,n){"use strict";var r={object:!0,symbol:!0};e.exports=function(){var e;if("function"!=typeof Symbol)return!1;e=Symbol("test symbol");try{String(e)}catch(e){return!1}return!!r[typeof Symbol.iterator]&&!!r[typeof Symbol.toPrimitive]&&!!r[typeof Symbol.toStringTag]}},function(e,t,n){"use strict";var r,o,i,a,s=n(6),u=n(110),c=Object.create,l=Object.defineProperties,p=Object.defineProperty,d=Object.prototype,f=c(null);if("function"==typeof Symbol){r=Symbol;try{String(r()),a=!0}catch(e){}}var h=function(){var e=c(null);return function(t){for(var n,r,o=0;e[t+(o||"")];)++o;return e[t+=o||""]=!0,p(d,n="@@"+t,s.gs(null,function(e){r||(r=!0,p(this,n,s(e)),r=!1)})),n}}();i=function(e){if(this instanceof i)throw new TypeError("Symbol is not a constructor");return o(e)},e.exports=o=function e(t){var n;if(this instanceof e)throw new TypeError("Symbol is not a constructor");return a?r(t):(n=c(i.prototype),t=void 0===t?"":String(t),l(n,{__description__:s("",t),__name__:s("",h(t))}))},l(o,{for:s(function(e){return f[e]?f[e]:f[e]=o(String(e))}),keyFor:s(function(e){var t;for(t in u(e),f)if(f[t]===e)return t}),hasInstance:s("",r&&r.hasInstance||o("hasInstance")),isConcatSpreadable:s("",r&&r.isConcatSpreadable||o("isConcatSpreadable")),iterator:s("",r&&r.iterator||o("iterator")),match:s("",r&&r.match||o("match")),replace:s("",r&&r.replace||o("replace")),search:s("",r&&r.search||o("search")),species:s("",r&&r.species||o("species")),split:s("",r&&r.split||o("split")),toPrimitive:s("",r&&r.toPrimitive||o("toPrimitive")),toStringTag:s("",r&&r.toStringTag||o("toStringTag")),unscopables:s("",r&&r.unscopables||o("unscopables"))}),l(i.prototype,{constructor:s(o),toString:s("",function(){return this.__name__})}),l(o.prototype,{toString:s(function(){return"Symbol ("+u(this).__description__+")"}),valueOf:s(function(){return u(this)})}),p(o.prototype,o.toPrimitive,s("",function(){var e=u(this);return"symbol"==typeof e?e:e.toString()})),p(o.prototype,o.toStringTag,s("c","Symbol")),p(i.prototype,o.toStringTag,s("c",o.prototype[o.toStringTag])),p(i.prototype,o.toPrimitive,s("c",o.prototype[o.toPrimitive]))},function(e,t,n){"use strict";var r=n(111);e.exports=function(e){if(!r(e))throw new TypeError(e+" is not a symbol");return e}},function(e,t,n){"use strict";e.exports=function(e){return!!e&&("symbol"==typeof e||!!e.constructor&&"Symbol"===e.constructor.name&&"Symbol"===e[e.constructor.toStringTag])}},function(e,t,n){"use strict";var r=n(19),o=n(7),i=n(20),a=n(4).iterator,s=Array.isArray;e.exports=function(e){return!(!o(e)||!s(e)&&!i(e)&&!r(e)&&"function"!=typeof e[a])}},function(e,t,n){"use strict";var r=n(19),o=n(3),i=n(20),a=n(114),s=Array.isArray,u=Function.prototype.call,c=Array.prototype.some;e.exports=function(e,t){var n,l,p,d,f,h,y,g,m=arguments[2];if(s(e)||r(e)?n="array":i(e)?n="string":e=a(e),o(t),p=function(){d=!0},"array"!==n)if("string"!==n)for(l=e.next();!l.done;){if(u.call(t,m,l.value,p),d)return;l=e.next()}else for(h=e.length,f=0;f<h&&(y=e[f],f+1<h&&(g=y.charCodeAt(0))>=55296&&g<=56319&&(y+=e[++f]),u.call(t,m,y,p),!d);++f);else c.call(e,function(e){return u.call(t,m,e,p),d})}},function(e,t,n){"use strict";var r=n(19),o=n(20),i=n(115),a=n(125),s=n(59),u=n(4).iterator;e.exports=function(e){return"function"==typeof s(e)[u]?e[u]():r(e)?new i(e):o(e)?new a(e):new i(e)}},function(e,t,n){"use strict";var r,o=n(18),i=n(58),a=n(6),s=n(4),u=n(32),c=Object.defineProperty;r=e.exports=function(e,t){if(!(this instanceof r))throw new TypeError("Constructor requires 'new'");u.call(this,e),t=t?i.call(t,"key+value")?"key+value":i.call(t,"key")?"key":"value":"value",c(this,"__kind__",a("",t))},o&&o(r,u),delete r.prototype.constructor,r.prototype=Object.create(u.prototype,{_resolve:a(function(e){return"value"===this.__kind__?this.__list__[e]:"key+value"===this.__kind__?[e,this.__list__[e]]:e})}),c(r.prototype,s.toStringTag,a("c","Array Iterator"))},function(e,t,n){"use strict";var r,o=n(117),i=n(57),a=n(3),s=n(122),u=n(3),c=n(2),l=Function.prototype.bind,p=Object.defineProperty,d=Object.prototype.hasOwnProperty;r=function(e,t,n){var r,i=c(t)&&u(t.value);return delete(r=o(t)).writable,delete r.value,r.get=function(){return!n.overwriteDefinition&&d.call(this,e)?i:(t.value=l.call(i,n.resolveContext?n.resolveContext(this):this),p(this,e,t),this[e])},r},e.exports=function(e){var t=i(arguments[1]);return null!=t.resolveContext&&a(t.resolveContext),s(e,function(e,n){return r(n,e,t)})}},function(e,t,n){"use strict";var r=n(118),o=n(31),i=n(2);e.exports=function(e){var t=Object(i(e)),n=arguments[1],a=Object(arguments[2]);if(t!==e&&!n)return t;var s={};return n?r(n,function(t){(a.ensure||t in e)&&(s[t]=e[t])}):o(s,e),s}},function(e,t,n){"use strict";e.exports=n(119)()?Array.from:n(120)},function(e,t,n){"use strict";e.exports=function(){var e,t,n=Array.from;return"function"==typeof n&&(t=n(e=["raz","dwa"]),Boolean(t&&t!==e&&"dwa"===t[1]))}},function(e,t,n){"use strict";var r=n(4).iterator,o=n(19),i=n(121),a=n(54),s=n(3),u=n(2),c=n(7),l=n(20),p=Array.isArray,d=Function.prototype.call,f={configurable:!0,enumerable:!0,writable:!0,value:null},h=Object.defineProperty;e.exports=function(e){var t,n,y,g,m,v,b,S,_,T,I=arguments[1],C=arguments[2];if(e=Object(u(e)),c(I)&&s(I),this&&this!==Array&&i(this))t=this;else{if(!I){if(o(e))return 1!==(m=e.length)?Array.apply(null,e):((g=new Array(1))[0]=e[0],g);if(p(e)){for(g=new Array(m=e.length),n=0;n<m;++n)g[n]=e[n];return g}}g=[]}if(!p(e))if(void 0!==(_=e[r])){for(b=s(_).call(e),t&&(g=new t),S=b.next(),n=0;!S.done;)T=I?d.call(I,C,S.value,n):S.value,t?(f.value=T,h(g,n,f)):g[n]=T,S=b.next(),++n;m=n}else if(l(e)){for(m=e.length,t&&(g=new t),n=0,y=0;n<m;++n)T=e[n],n+1<m&&(v=T.charCodeAt(0))>=55296&&v<=56319&&(T+=e[++n]),T=I?d.call(I,C,T,y):T,t?(f.value=T,h(g,y,f)):g[y]=T,++y;m=y}if(void 0===m)for(m=a(e.length),t&&(g=new t(m)),n=0;n<m;++n)T=I?d.call(I,C,e[n],n):e[n],t?(f.value=T,h(g,n,f)):g[n]=T;return t&&(f.value=null,g.length=m),g}},function(e,t,n){"use strict";var r=Object.prototype.toString,o=r.call(n(53));e.exports=function(e){return"function"==typeof e&&r.call(e)===o}},function(e,t,n){"use strict";var r=n(3),o=n(123),i=Function.prototype.call;e.exports=function(e,t){var n={},a=arguments[2];return r(t),o(e,function(e,r,o,s){n[r]=i.call(t,a,e,r,o,s)}),n}},function(e,t,n){"use strict";e.exports=n(124)("forEach")},function(e,t,n){"use strict";var r=n(3),o=n(2),i=Function.prototype.bind,a=Function.prototype.call,s=Object.keys,u=Object.prototype.propertyIsEnumerable;e.exports=function(e,t){return function(n,c){var l,p=arguments[2],d=arguments[3];return n=Object(o(n)),r(c),l=s(n),d&&l.sort("function"==typeof d?i.call(d,n):void 0),"function"!=typeof e&&(e=l[e]),a.call(e,l,function(e,r){return u.call(n,e)?a.call(c,p,n[e],e,n,r):t})}}},function(e,t,n){"use strict";var r,o=n(18),i=n(6),a=n(4),s=n(32),u=Object.defineProperty;r=e.exports=function(e){if(!(this instanceof r))throw new TypeError("Constructor requires 'new'");e=String(e),s.call(this,e),u(this,"__length__",i("",e.length))},o&&o(r,s),delete r.prototype.constructor,r.prototype=Object.create(s.prototype,{_next:i(function(){if(this.__list__)return this.__nextIndex__<this.__length__?this.__nextIndex__++:void this._unBind()}),_resolve:i(function(e){var t,n=this.__list__[e];return this.__nextIndex__===this.__length__?n:(t=n.charCodeAt(0))>=55296&&t<=56319?n+this.__list__[this.__nextIndex__++]:n})}),u(r.prototype,a.toStringTag,i("c","String Iterator"))},function(e,t,n){"use strict";var r,o=n(18),i=n(6),a=n(32),s=n(4).toStringTag,u=n(127),c=Object.defineProperties,l=a.prototype._unBind;r=e.exports=function(e,t){if(!(this instanceof r))return new r(e,t);a.call(this,e.__mapKeysData__,e),t&&u[t]||(t="key+value"),c(this,{__kind__:i("",t),__values__:i("w",e.__mapValuesData__)})},o&&o(r,a),r.prototype=Object.create(a.prototype,{constructor:i(r),_resolve:i(function(e){return"value"===this.__kind__?this.__values__[e]:"key"===this.__kind__?this.__list__[e]:[this.__list__[e],this.__values__[e]]}),_unBind:i(function(){this.__values__=null,l.call(this)}),toString:i(function(){return"[object Map Iterator]"})}),Object.defineProperty(r.prototype,s,i("c","Map Iterator"))},function(e,t,n){"use strict";e.exports=n(128)("key","value","key+value")},function(e,t,n){"use strict";var r=Array.prototype.forEach,o=Object.create;e.exports=function(e){var t=o(null);return r.call(arguments,function(e){t[e]=!0}),t}},function(e,t,n){"use strict";e.exports="undefined"!=typeof Map&&"[object Map]"===Object.prototype.toString.call(new Map)}])},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(16),o=function(){function e(){}return e.getAppInsightsInstance=function(t,n){return e._appInsightsInstance||(e._appInsightsInstance=this.InitializeAI(t,n)),e._appInsightsInstance},e.InitializeAI=function(e,t){var n=new r.ApplicationInsights({config:{instrumentationKey:e,disableFetchTracking:!1,maxBatchInterval:0,enableAutoRouteTracking:!0,namePrefix:"ExtranetAppViewer"}});return n.loadAppInsights(),n.context.application.ver="1.0.1",t&&(console.log("Pre-hashed current user",t),n.setAuthenticatedUserContext(t)),n},e}();t.TelemetryService=o},function(e,t,n){"use strict";n.r(t);var r={};n.r(r),n.d(r,"Util",function(){return Ct}),n.d(r,"CorrelationIdHelper",function(){return Ot}),n.d(r,"UrlHelper",function(){return wt}),n.d(r,"DateTimeUtils",function(){return Et}),n.d(r,"ConnectionStringParser",function(){return jt}),n.d(r,"FieldType",function(){return it}),n.d(r,"RequestHeaders",function(){return bt}),n.d(r,"DisabledPropertyName",function(){return xt}),n.d(r,"ProcessLegacy",function(){return At}),n.d(r,"SampleRate",function(){return Nt}),n.d(r,"HttpMethod",function(){return Rt}),n.d(r,"DEFAULT_BREEZE_ENDPOINT",function(){return Mt}),n.d(r,"AIData",function(){return Lt}),n.d(r,"AIBase",function(){return Dt}),n.d(r,"Envelope",function(){return kt}),n.d(r,"Event",function(){return Bt}),n.d(r,"Exception",function(){return Kt}),n.d(r,"Metric",function(){return Jt}),n.d(r,"PageView",function(){return en}),n.d(r,"PageViewData",function(){return Zt}),n.d(r,"RemoteDependencyData",function(){return tn}),n.d(r,"Trace",function(){return nn}),n.d(r,"PageViewPerformance",function(){return rn}),n.d(r,"Data",function(){return on}),n.d(r,"SeverityLevel",function(){return Xt}),n.d(r,"ConfigurationManager",function(){return an}),n.d(r,"ContextTagKeys",function(){return sn}),n.d(r,"DataSanitizer",function(){return St}),n.d(r,"TelemetryItemCreator",function(){return un}),n.d(r,"CtxTagKeys",function(){return ln}),n.d(r,"Extensions",function(){return cn}),n.d(r,"DistributedTracingModes",function(){return at}),n.d(r,"PropertiesPluginIdentifier",function(){return pn}),n.d(r,"BreezeChannelIdentifier",function(){return dn}),n.d(r,"AnalyticsPluginIdentifier",function(){return fn});var o=n(2),i=o.f,a=o.d,s=o.e,u=o.c,c="window",l="document",p="navigator",d="history",f="location",h="console",y="performance",g="JSON",m="crypto",v="msCrypto",b="ReactNative",S=o.a;function _(e){var t=S();return t&&t[e]?t[e]:e===c&&T()?window:null}function T(){return Boolean(typeof window===a&&window)}function I(){return T()?window:_(c)}function C(){return Boolean(typeof document===a&&document)}function w(){return C()?document:_(l)}function O(){return Boolean(typeof navigator===a&&navigator)?navigator:_(p)}function P(){return Boolean(typeof history===a&&history)?history:_(d)}function E(){return typeof location===a&&location?location:_(f)}function x(){return _(y)}function N(){return Boolean(typeof JSON===a&&JSON||null!==_(g))}function A(){return N()?JSON||_(g):null}o.f;var R="on",M="attachEvent",j="addEventListener",D="detachEvent",L="removeEventListener",k=4294967296,U=4294967295,F=null,B=!1,G=123456789,q=987654321;function H(e){G=123456789+e&U,q=987654321-e&U,B=!0}function V(){H(Math.random()*k^(new Date).getTime())}function W(e,t){return typeof e===t}function K(e){return W(e,o.f)||void 0===e}function z(e){return K(e)||null===e}function $(e,t){return e&&Object[o.e].hasOwnProperty.call(e,t)}function Q(e){return W(e,o.d)}function X(e){return W(e,o.c)}function Y(e,t,n,r){void 0===r&&(r=!1);var o=!1;if(!z(e))try{z(e[j])?z(e[M])||(e[M](R+t,n),o=!0):(e[j](t,n,r),o=!0)}catch(e){}return o}function J(e,t,n,r){if(void 0===r&&(r=!1),!z(e))try{z(e[L])?z(e[D])||e[D](R+t,n):e[L](t,n,r)}catch(e){}}var Z,ee=function(){function e(){}return e.isDate=function(e){return"[object Date]"===Object[o.e].toString.call(e)},e.isArray=function(e){return"[object Array]"===Object[o.e].toString.call(e)},e.isError=function(e){return"[object Error]"===Object[o.e].toString.call(e)},e.isString=function(e){return W(e,"string")},e.isNumber=function(e){return W(e,"number")},e.isBoolean=function(e){return W(e,"boolean")},e.disableCookies=function(){e._canUseCookies=!1},e.newGuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(te,function(t){var n=0|e.randomValue(15);return("x"===t?n:3&n|8).toString(16)})},e.toISOString=function(t){if(e.isDate(t)){var n=function(e){var t=String(e);return 1===t.length&&(t="0"+t),t};return t.getUTCFullYear()+"-"+n(t.getUTCMonth()+1)+"-"+n(t.getUTCDate())+"T"+n(t.getUTCHours())+":"+n(t.getUTCMinutes())+":"+n(t.getUTCSeconds())+"."+String((t.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}},e.arrForEach=function(e,t,n){for(var r=e.length,o=0;o<r;o++)o in e&&t.call(n||e,e[o],o,e)},e.arrIndexOf=function(e,t,n){for(var r=e.length,o=n||0,i=Math.max(o>=0?o:r-Math.abs(o),0);i<r;i++)if(i in e&&e[i]===t)return i;return-1},e.arrMap=function(e,t,n){for(var r=e.length,o=n||e,i=new Array(r),a=0;a<r;a++)a in e&&(i[a]=t.call(o,e[a],e));return i},e.arrReduce=function(e,t,n){var r,o=e.length,i=0;if(arguments.length>=3)r=arguments[2];else{for(;i<o&&!(i in e);)i++;r=e[i++]}for(;i<o;)i in e&&(r=t(r,e[i],i,e)),i++;return r},e.strTrim=function(t){return e.isString(t)?t.replace(/^\s+|\s+$/g,""):t},e.objKeys=function(e){var t=!{toString:null}.propertyIsEnumerable("toString");if(!(X(e)||Q(e)&&null!==e))throw new TypeError("objKeys called on non-object");var n=[];for(var r in e)$(e,r)&&n.push(r);if(t)for(var o=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],i=o.length,a=0;a<i;a++)$(e,o[a])&&n.push(o[a]);return n},e.objDefineAccessors=function(e,t,n,r){var o=Object.defineProperty;if(o)try{var i={enumerable:!0,configurable:!0};return n&&(i.get=n),r&&(i.set=r),o(e,t,i),!0}catch(e){}return!1},e.addEventHandler=function(e,t){var n=!1,r=I();r&&(n=Y(r,e,t),n=Y(r.body,e,t)||n);var o=w();return o&&(n=ne.Attach(o,e,t)||n),n},e.dateNow=function(){var e=Date;return e.now?e.now():(new e).getTime()},e.perfNow=function(){var t=x();return t&&t.now?t.now():e.dateNow()},e.newId=function(t){void 0===t&&(t=22);for(var n=e.random32()>>>0,r=0,o="";o.length<t;)r++,o+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(63&n),n>>>=6,5===r&&(n=(e.random32()<<2&4294967295|3&n)>>>0,r=0);return o},e.isIE=function(){if(null===F){var e=((O()||{}).userAgent||"").toLowerCase();F=-1!==e.indexOf("msie")||-1!==e.indexOf("trident/")}return F},e.randomValue=function(t){return t>0?Math.floor(e.random32()/U*(t+1))>>>0:0},e.random32=function(t){var n,r=_(m)||_(v);return r&&r.getRandomValues?n=r.getRandomValues(new Uint32Array(1))[0]&U:e.isIE()?(B||V(),n=e.mwcRandom32()&U):n=Math.floor(k*Math.random()|0),t||(n>>>=0),n},e.mwcRandomSeed=function(e){e?H(e):V()},e.mwcRandom32=function(e){var t=((q=36969*(65535&q)+(q>>16)&U)<<16)+(65535&(G=18e3*(65535&G)+(G>>16)&U))>>>0&U|0;return e||(t>>>=0),t},e.generateW3CId=function(){for(var t,n=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],r="",o=0;o<4;o++)r+=n[15&(t=e.random32())]+n[t>>4&15]+n[t>>8&15]+n[t>>12&15]+n[t>>16&15]+n[t>>20&15]+n[t>>24&15]+n[t>>28&15];var i=n[8+(3&e.random32())|0];return r.substr(0,8)+r.substr(9,4)+"4"+r.substr(13,3)+i+r.substr(16,3)+r.substr(19,12)},e.isTypeof=W,e.isUndefined=K,e.isNullOrUndefined=z,e.hasOwnProperty=$,e.isFunction=X,e.isObject=Q,e.objCreate=o.b,e}(),te=/[xy]/g,ne=function(){function e(){}return e.Attach=Y,e.AttachEvent=Y,e.Detach=J,e.DetachEvent=J,e}();!function(e){e[e.CRITICAL=1]="CRITICAL",e[e.WARNING=2]="WARNING"}(Z||(Z={}));var re={BrowserDoesNotSupportLocalStorage:0,BrowserCannotReadLocalStorage:1,BrowserCannotReadSessionStorage:2,BrowserCannotWriteLocalStorage:3,BrowserCannotWriteSessionStorage:4,BrowserFailedRemovalFromLocalStorage:5,BrowserFailedRemovalFromSessionStorage:6,CannotSendEmptyTelemetry:7,ClientPerformanceMathError:8,ErrorParsingAISessionCookie:9,ErrorPVCalc:10,ExceptionWhileLoggingError:11,FailedAddingTelemetryToBuffer:12,FailedMonitorAjaxAbort:13,FailedMonitorAjaxDur:14,FailedMonitorAjaxOpen:15,FailedMonitorAjaxRSC:16,FailedMonitorAjaxSend:17,FailedMonitorAjaxGetCorrelationHeader:18,FailedToAddHandlerForOnBeforeUnload:19,FailedToSendQueuedTelemetry:20,FailedToReportDataLoss:21,FlushFailed:22,MessageLimitPerPVExceeded:23,MissingRequiredFieldSpecification:24,NavigationTimingNotSupported:25,OnError:26,SessionRenewalDateIsZero:27,SenderNotInitialized:28,StartTrackEventFailed:29,StopTrackEventFailed:30,StartTrackFailed:31,StopTrackFailed:32,TelemetrySampledAndNotSent:33,TrackEventFailed:34,TrackExceptionFailed:35,TrackMetricFailed:36,TrackPVFailed:37,TrackPVFailedCalc:38,TrackTraceFailed:39,TransmissionFailed:40,FailedToSetStorageBuffer:41,FailedToRestoreStorageBuffer:42,InvalidBackendResponse:43,FailedToFixDepricatedValues:44,InvalidDurationValue:45,TelemetryEnvelopeInvalid:46,CreateEnvelopeError:47,CannotSerializeObject:48,CannotSerializeObjectNonSerializable:49,CircularReferenceDetected:50,ClearAuthContextFailed:51,ExceptionTruncated:52,IllegalCharsInName:53,ItemNotInArray:54,MaxAjaxPerPVExceeded:55,MessageTruncated:56,NameTooLong:57,SampleRateOutOfRange:58,SetAuthContextFailed:59,SetAuthContextFailedAccountName:60,StringValueTooLong:61,StartCalledMoreThanOnce:62,StopCalledWithoutStart:63,TelemetryInitializerFailed:64,TrackArgumentsNotSpecified:65,UrlTooLong:66,SessionStorageBufferFull:67,CannotAccessCookie:68,IdTooLong:69,InvalidEvent:70,FailedMonitorAjaxSetRequestHeader:71,SendBrowserInfoOnUserInit:72,PluginException:73,NotificationException:74,SnippetScriptLoadFailure:99,InvalidInstrumentationKey:100},oe="constructor",ie="prototype",ae="function",se="_dynInstFuncs",ue="_isDynProxy",ce="_dynClass",le="_dynCls$",pe="_dynInstChk",de=pe,fe="_dfOpts",he="_unknown_",ye="__proto__",ge="useBaseInst",me="setInstFuncs",ve=Object.getPrototypeOf,be=0;
/*!
 * Microsoft Dynamic Proto Utility, 1.1.0
 * Copyright (c) Microsoft and contributors. All rights reserved.
 */function Se(e,t){return e&&Object[ie].hasOwnProperty.call(e,t)}function _e(e){return typeof e===ae}function Te(e){return e&&(e===Object[ie]||e===Array[ie])}function Ie(e){return Te(e)||e===Function[ie]}function Ce(e){if(e){if(ve)return ve(e);var t=e[ye]||e[ie]||e[oe];if(t)return t}return null}function we(e,t,n){return t!==oe&&_e(e[t])&&(n||Se(e,t))}function Oe(e){throw new TypeError("DynamicProto: "+e)}function Pe(e,t){for(var n=e.length-1;n>=0;n--)if(e[n]===t)return!0;return!1}function Ee(e,t,n,r,o){function i(e,t){var n=function(){return(function(e,t,n,r){var o=null;if(e&&Se(n,ce)){var i=e[se]||{};if((o=(i[n[ce]]||{})[t])||Oe("Missing ["+t+"] "+ae),!o[pe]&&!1!==i[de]){for(var a=!Se(e,t),s=Ce(e),u=[];a&&s&&!Ie(s)&&!Pe(u,s);){var c=s[t];if(c){a=c===r;break}u.push(s),s=Ce(s)}try{a&&(e[t]=o),o[pe]=1}catch(e){i[de]=!1}}}return o}(this,t,e,n)||function(e,t,n){var r=t[e];return r===n&&(r=Ce(t)[e]),_e(r)||Oe("["+e+"] is not a "+ae),r}(t,e,n)).apply(this,arguments)};return n[ue]=1,n}if(!Te(e)){var a=n[se]=n[se]||{},s=a[t]=a[t]||{};for(var u in!1!==a[de]&&(a[de]=!!o),n)we(n,u,!1)&&n[u]!==r[u]&&(s[u]=n[u],delete n[u],(!Se(e,u)||e[u]&&!e[u][ue])&&(e[u]=i(e,u)))}}function xe(e,t){return Se(e,ie)?e.name||t||he:((e||{})[oe]||{}).name||t||he}function Ne(e,t,n,r){Se(e,ie)||Oe("theClass is an invalid class definition.");var o=e[ie];(function(e,t){for(var n=Ce(t);n&&!Ie(n);){if(n===e)return!0;n=Ce(n)}return!1})(o,t)||Oe("["+xe(e)+"] is not in class hierarchy of ["+xe(t)+"]");var i=null;Se(o,ce)?i=o[ce]:(i=le+xe(e,"_")+"$"+be,be++,o[ce]=i);var a=Ne[fe],s=!!a[ge];s&&r&&void 0!==r[ge]&&(s=!!r[ge]);var u=function(e){var t={};for(var n in e)!t[n]&&we(e,n,!1)&&(t[n]=e[n]);return t}(t);n(t,function(e,t,n,r){function o(e,t,n){var o=t[a];if(o[ue]&&r){var i=e[se]||{};!1!==i[de]&&(o=(i[t[ce]]||{})[n]||o)}return function(){return o.apply(e,arguments)}}var i={};for(var a in n)i[a]=o(t,n,a);for(var s=Ce(e),u=[];s&&!Ie(s)&&!Pe(u,s);){for(var a in s)!i[a]&&we(s,a,!ve)&&(i[a]=o(t,s,a));u.push(s),s=Ce(s)}return i}(o,t,u,s));var c=!!ve&&!!a[me];c&&r&&(c=!!r[me]),Ee(o,i,t,u,!1!==c)}Ne[fe]={setInstFuncs:!0,useBaseInst:!0};var Ae=Ne,Re="AI (Internal): ",Me="AI: ",je="AITR_";function De(e){return e?'"'+e.replace(/\"/g,"")+'"':""}var Le=function(){function e(e,t,n,r){void 0===n&&(n=!1);this.messageId=e,this.message=(n?Me:Re)+e;var o="";N()&&(o=A().stringify(r));var i=(t?" message:"+De(t):"")+(r?" props:"+De(o):"");this.message+=i}return e.dataType="MessageData",e}(),ke=function(){function e(t){this.identifier="DiagnosticLogger",this.queue=[];var n=0,r={};Ae(e,this,function(e){var o=ee.isNullOrUndefined,a=ee.isUndefined,s=ee.isFunction;function u(e,n){var r=t[e];return o(r)?n:r}o(t)&&(t={}),e.consoleLoggingLevel=function(){return u("loggingLevelConsole",0)},e.telemetryLoggingLevel=function(){return u("loggingLevelTelemetry",1)},e.maxInternalMessageLimit=function(){return u("maxMessageLimit",25)},e.enableDebugExceptions=function(){return u("enableDebugExceptions",!1)},e.throwInternal=function(t,n,o,i,s){void 0===s&&(s=!1);var u=new Le(n,o,s,i);if(e.enableDebugExceptions())throw u;if(!a(u)&&u&&!a(u.message)){if(s){var c=+u.messageId;!r[c]&&e.consoleLoggingLevel()>=Z.WARNING&&(e.warnToConsole(u.message),r[c]=!0)}else e.consoleLoggingLevel()>=Z.WARNING&&e.warnToConsole(u.message);e.logInternalMessage(t,u)}},e.warnToConsole=function(e){var t=typeof console!==i?console:_(h);if(t){var n="log";t.warn&&(n="warn"),s(t[n])&&t[n](e)}},e.resetInternalMessageCount=function(){n=0,r={}},e.logInternalMessage=function(t,o){if(!(n>=e.maxInternalMessageLimit())){var i=!0,a=je+o.messageId;if(r[a]?i=!1:r[a]=!0,i&&(t<=e.telemetryLoggingLevel()&&(e.queue.push(o),n++),n===e.maxInternalMessageLimit())){var s="Internal events throttle limit per PageView reached for this app.",u=new Le(re.MessageLimitPerPVExceeded,s,!1);e.queue.push(u),e.warnToConsole(s)}}}})}return e.prototype.enableDebugExceptions=function(){return!1},e.prototype.consoleLoggingLevel=function(){return 0},e.prototype.telemetryLoggingLevel=function(){return 1},e.prototype.maxInternalMessageLimit=function(){return 25},e.prototype.throwInternal=function(e,t,n,r,o){void 0===o&&(o=!1)},e.prototype.warnToConsole=function(e){},e.prototype.resetInternalMessageCount=function(){},e.prototype.logInternalMessage=function(e,t){},e}(),Ue="ctx",Fe=function(){function e(t,n,r){var o,i=this,a=!1;(i.start=ee.dateNow(),i.name=t,i.isAsync=r,i.isChildEvt=function(){return!1},ee.isFunction(n))&&(a=ee.objDefineAccessors(i,"payload",function(){return!o&&ee.isFunction(n)&&(o=n(),n=null),o}));i.getCtx=function(t){return t?t===e.ParentContextKey||t===e.ChildrenContextKey?i[t]:(i[Ue]||{})[t]:null},i.setCtx=function(t,n){if(t)if(t===e.ParentContextKey)i[t]||(i.isChildEvt=function(){return!0}),i[t]=n;else if(t===e.ChildrenContextKey)i[t]=n;else{(i[Ue]=i[Ue]||{})[t]=n}},i.complete=function(){var t=0,r=i.getCtx(e.ChildrenContextKey);if(ee.isArray(r))for(var o=0;o<r.length;o++){var s=r[o];s&&(t+=s.time)}i.time=ee.dateNow()-i.start,i.exTime=i.time-t,i.complete=function(){},!a&&ee.isFunction(n)&&(i.payload=n())}}return e.ParentContextKey="parent",e.ChildrenContextKey="childEvts",e}(),Be=function(){function e(t){this.ctx={},Ae(e,this,function(e){e.create=function(e,t,n){return new Fe(e,t,n)},e.fire=function(e){e&&(e.complete(),t&&t.perfEvent(e))},e.setCtx=function(t,n){t&&((e[Ue]=e[Ue]||{})[t]=n)},e.getCtx=function(t){return(e[Ue]||{})[t]}})}return e.prototype.create=function(e,t,n){return null},e.prototype.fire=function(e){},e.prototype.setCtx=function(e,t){},e.prototype.getCtx=function(e){},e}(),Ge="CoreUtils.doPerf";function qe(e,t,n,r,o){if(e){var i=e;if(i&&ee.isFunction(i.getPerfMgr)&&(i=i.getPerfMgr()),i){var a=void 0,s=i.getCtx(Ge);try{if(a=i.create(t(),r,o)){if(s&&a.setCtx&&(a.setCtx(Fe.ParentContextKey,s),s.getCtx&&s.setCtx)){var u=s.getCtx(Fe.ChildrenContextKey);u||(u=[],s.setCtx(Fe.ChildrenContextKey,u)),u.push(a)}return i.setCtx(Ge,a),n(a)}}catch(e){a&&a.setCtx&&a.setCtx("exception",e)}finally{a&&i.fire(a),i.setCtx(Ge,s)}}}return n()}var He=ee.isFunction,Ve=function(){return function(e,t){var n=this,r=null,o=He(e.processTelemetry),i=He(e.setNextPlugin);n._hasRun=!1,n.getPlugin=function(){return e},n.getNext=function(){return r},n.setNext=function(e){r=e},n.processTelemetry=function(a,s){s||(s=t);var u=e?e.identifier:"TelemetryPluginChain";qe(s?s.core():null,function(){return u+":processTelemetry"},function(){if(e&&o){n._hasRun=!0;try{s.setNext(r),i&&e.setNextPlugin(r),r&&(r._hasRun=!1),e.processTelemetry(a,s)}catch(n){var t=r&&r._hasRun;r&&t||s.diagLog().throwInternal(Z.CRITICAL,re.PluginException,"Plugin ["+e.identifier+"] failed during processTelemetry - "+n),r&&!t&&r.processTelemetry(a,s)}}else r&&(n._hasRun=!0,r.processTelemetry(a,s))},function(){return{item:a}},!a.sync)}}}(),We=ee.isNullOrUndefined;function Ke(e,t){var n=[];if(e&&e.length>0)for(var r=null,o=0;o<e.length;o++){var i=e[o];if(i&&ee.isFunction(i.processTelemetry)){var a=new Ve(i,t);n.push(a),r&&r.setNext(a),r=a}}return n.length>0?n[0]:null}var ze=function(){return function e(t,n,r,o){var i=this,a=null;null!==o&&(t&&ee.isFunction(t.getPlugin)?a=function(e,t,n){var r=[],o=!n;if(e)for(;e;){var i=e.getPlugin();(o||i===n)&&(o=!0,r.push(i)),e=e.getNext()}return o||r.push(n),Ke(r,t)}(t,i,o||t.getPlugin()):o?a=function(e,t,n){var r=e,o=!1;return n&&e&&(r=[],ee.arrForEach(e,function(e){(o||e===n)&&(o=!0,r.push(e))})),n&&!o&&(r||(r=[]),r.push(n)),Ke(r,t)}(t,i,o):ee.isUndefined(o)&&(a=Ke(t,i))),i.core=function(){return r},i.diagLog=function(){var e=(r||{}).logger;return e||(e=new ke(n||{})),e},i.getCfg=function(){return n},i.getExtCfg=function(e,t){var r;if(void 0===t&&(t={}),n){var o=n.extensionConfig;o&&e&&(r=o[e])}return r||t},i.getConfig=function(e,t,r){var o;void 0===r&&(r=!1);var a=i.getExtCfg(e,null);return a&&!We(a[t])?o=a[t]:n&&!We(n[t])&&(o=n[t]),We(o)?r:o},i.hasNext=function(){return null!=a},i.getNext=function(){return a},i.setNext=function(e){a=e},i.processNext=function(e){var t=a;t&&(a=t.getNext(),t.processTelemetry(e,i))},i.createNew=function(t,o){return void 0===t&&(t=null),new e(t||a,n,r,o)}}}(),$e=ee.isFunction,Qe="getPlugin",Xe=function(){function e(){var e=this,t=!1,n=null,r=null;e.core=null,e.diagLog=function(t){return e._getTelCtx(t).diagLog()},e.isInitialized=function(){return t},e.setInitialized=function(e){t=e},e.setNextPlugin=function(e){r=e},e.processNext=function(e,t){t?t.processNext(e):r&&$e(r.processTelemetry)&&r.processTelemetry(e,null)},e._getTelCtx=function(t){void 0===t&&(t=null);var o=t;if(!o){var i=n||new ze(null,{},e.core);o=r&&r[Qe]?i.createNew(null,r[Qe]):i.createNew(null,r)}return o},e._baseTelInit=function(o,i,a,s){o&&(o.extensionConfig=o.extensionConfig||[]),!s&&i&&(s=i.getProcessTelContext().getNext());var u=r;r&&r[Qe]&&(u=r[Qe]()),e.core=i,n=new ze(s,o,i,u),t=!0}}return e.prototype.initialize=function(e,t,n,r){this._baseTelInit(e,t,n,r)},e}(),Ye=ee.isFunction,Je="processTelemetry",Ze="priority",et="setNextPlugin",tt="isInitialized";function nt(e,t){for(var n=[],r=null,o=e.getNext();o;){var i=o.getPlugin();i&&(r&&Ye(r[et])&&Ye(i[Je])&&r[et](i),Ye(i[tt])&&i[tt]()||n.push(i),r=i,o=o.getNext())}ee.arrForEach(n,function(n){n.initialize(e.getCfg(),e.core(),t,e.getNext())})}function rt(e){return e.sort(function(e,t){var n=0,r=Ye(t[Je]);return Ye(e[Je])?n=r?e[Ze]-t[Ze]:1:r&&(n=-1),n})}var ot,it,at,st=500,ut="Channel has invalid priority",ct=ee.objDefineAccessors,lt=function(e){function t(){var n=e.call(this)||this;n.identifier="ChannelControllerPlugin",n.priority=st;var r,o=ee.arrForEach;function i(e){e&&e.length>0&&(function(e){o(e,function(e){if(e.priority<st)throw Error(ut+e.identifier)})}(e=e.sort(function(e,t){return e.priority-t.priority})),r.push(e))}return Ae(t,n,function(e,t){e.setNextPlugin=function(e){},e.processTelemetry=function(e,t){r&&o(r,function(r){r.length>0&&n._getTelCtx(t).createNew(r).processNext(e)})},e.getChannelControls=function(){return r},e.initialize=function(n,a,s){e.isInitialized()||(t.initialize(n,a,s),n.isCookieUseDisabled&&ee.disableCookies(),function(e,t){r=[],e&&o(e,function(e){return i(e)});if(t){var n=[];o(t,function(e){e.priority>st&&n.push(e)}),i(n)}}((n||{}).channels,s),o(r,function(e){return nt(new ze(e,n,a),s)}))}}),n}return __extends(t,e),t.prototype.processTelemetry=function(e,t){},t.prototype.getChannelControls=function(){return null},t.prototype.initialize=function(e,t,n){},t._staticInit=(ct(t.prototype,"ChannelControls",t.prototype.getChannelControls),void ct(t.prototype,"channelQueue",t.prototype.getChannelControls)),t}(Xe),pt="Extensions must provide callback to initialize",dt=ee.arrForEach,ft=ee.isNullOrUndefined,ht="_notificationManager",yt=function(){function e(){var t,n,r,o,i=!1;Ae(e,this,function(e){e._extensions=new Array,n=new lt,t=[],e.isInitialized=function(){return i},e.initialize=function(t,o,a,s){if(e.isInitialized())throw Error("Core should not be initialized more than once");if(!t||ft(t.instrumentationKey))throw Error("Please provide instrumentation key");r=s,e[ht]=s,e.config=t||{},t.extensions=ft(t.extensions)?[]:t.extensions,(t.extensionConfig=ft(t.extensionConfig)?{}:t.extensionConfig).NotificationManager=s,a||(a=ee.objCreate({throwInternal:function(e,t,n,r,o){void 0===o&&(o=!1)},warnToConsole:function(e){},resetInternalMessageCount:function(){}})),e.logger=a;var u=[];u.push.apply(u,o.concat(t.extensions)),u=rt(u);var c=[],l=[],p={};if(dt(u,function(e){if(ft(e)||ft(e.initialize))throw Error(pt);var t=e.priority,r=e.identifier;e&&t&&(ft(p[t])?p[t]=r:a.warnToConsole("Two extensions have same priority #"+t+" - "+p[t]+", "+r)),!t||t<n.priority?c.push(e):l.push(e)}),u.push(n),c.push(n),u=rt(u),e._extensions=u,nt(new ze([n],t,e),u),nt(new ze(c,t,e),u),e._extensions=c,0===e.getTransmissionControls().length)throw new Error("No channels available");i=!0,e.releaseQueue()},e.getTransmissionControls=function(){return n.getChannelControls()},e.track=function(n){n.iKey||(n.iKey=e.config.instrumentationKey),n.time||(n.time=ee.toISOString(new Date)),ft(n.ver)&&(n.ver="4.0"),e.isInitialized()?e.getProcessTelContext().processNext(n):t.push(n)},e.getProcessTelContext=function(){var t=e._extensions,r=t;return t&&0!==t.length||(r=[n]),new ze(r,e.config,e)},e.getNotifyMgr=function(){return r||(r=ee.objCreate({addNotificationListener:function(e){},removeNotificationListener:function(e){},eventsSent:function(e){},eventsDiscarded:function(e,t){},eventsSendRequest:function(e,t){}}),e[ht]=r),r},e.getPerfMgr=function(){return o||e.config&&e.config.enablePerfMgr&&(o=new Be(e.getNotifyMgr())),o},e.setPerfMgr=function(e){o=e},e.eventCnt=function(){return t.length},e.releaseQueue=function(){t.length>0&&(dt(t,function(t){e.getProcessTelContext().processNext(t)}),t=[])}})}return e.prototype.initialize=function(e,t,n,r){},e.prototype.getTransmissionControls=function(){return null},e.prototype.track=function(e){},e.prototype.getProcessTelContext=function(){return null},e.prototype.getNotifyMgr=function(){return null},e.prototype.getPerfMgr=function(){return null},e.prototype.setPerfMgr=function(e){},e.prototype.eventCnt=function(){return 0},e.prototype.releaseQueue=function(){},e}(),gt={Unknown:0,NonRetryableStatus:1,InvalidEvent:2,SizeLimitExceeded:3,KillSwitch:4,QueueFull:5},mt=function(){function e(t){this.listeners=[];var n=ee.arrForEach,r=!!(t||{}).perfEvtsSendAll;Ae(e,this,function(e){e.addNotificationListener=function(t){e.listeners.push(t)},e.removeNotificationListener=function(t){for(var n=ee.arrIndexOf(e.listeners,t);n>-1;)e.listeners.splice(n,1),n=ee.arrIndexOf(e.listeners,t)},e.eventsSent=function(t){n(e.listeners,function(e){e&&e.eventsSent&&setTimeout(function(){return e.eventsSent(t)},0)})},e.eventsDiscarded=function(t,r){n(e.listeners,function(e){e&&e.eventsDiscarded&&setTimeout(function(){return e.eventsDiscarded(t,r)},0)})},e.eventsSendRequest=function(t,r){n(e.listeners,function(e){if(e&&e.eventsSendRequest)if(r)setTimeout(function(){return e.eventsSendRequest(t,r)},0);else try{e.eventsSendRequest(t,r)}catch(e){}})},e.perfEvent=function(t){t&&(!r&&t.isChildEvt()||n(e.listeners,function(e){if(e&&e.perfEvent)if(t.isAsync)setTimeout(function(){return e.perfEvent(t)},0);else try{e.perfEvent(t)}catch(e){}}))}})}return e.prototype.addNotificationListener=function(e){},e.prototype.removeNotificationListener=function(e){},e.prototype.eventsSent=function(e){},e.prototype.eventsDiscarded=function(e,t){},e.prototype.eventsSendRequest=function(e,t){},e}(),vt=function(e){function t(){var n=e.call(this)||this;return Ae(t,n,function(e,t){function n(t){var n=e.getNotifyMgr();n&&n.eventsDiscarded([t],gt.InvalidEvent)}e.initialize=function(e,n,r,o){t.initialize(e,n,r||new ke(e),o||new mt(e))},e.track=function(r){qe(e.getPerfMgr(),function(){return"AppInsightsCore:track"},function(){if(null===r)throw n(r),Error("Invalid telemetry item");!function(e){if(ee.isNullOrUndefined(e.name))throw n(e),Error("telemetry name required")}(r),t.track(r)},function(){return{item:r}},!r.sync)},e.addNotificationListener=function(t){var n=e.getNotifyMgr();n&&n.addNotificationListener(t)},e.removeNotificationListener=function(t){var n=e.getNotifyMgr();n&&n.removeNotificationListener(t)},e.pollInternalLogs=function(t){var n=e.config.diagnosticLogInterval;return n&&n>0||(n=1e4),setInterval(function(){var n=e.logger?e.logger.queue:[];ee.arrForEach(n,function(n){var r={name:t||"InternalMessageId: "+n.messageId,iKey:e.config.instrumentationKey,time:ee.toISOString(new Date),baseType:Le.dataType,baseData:{message:n.message}};e.track(r)}),n.length=0},n)}}),n}return __extends(t,e),t.prototype.initialize=function(e,t,n,r){},t.prototype.track=function(e){},t.prototype.addNotificationListener=function(e){},t.prototype.removeNotificationListener=function(e){},t.prototype.pollInternalLogs=function(e){return 0},t}(yt);!function(e){e[e.LocalStorage=0]="LocalStorage",e[e.SessionStorage=1]="SessionStorage"}(ot||(ot={})),function(e){e[e.Default=0]="Default",e[e.Required=1]="Required",e[e.Array=2]="Array",e[e.Hidden=4]="Hidden"}(it||(it={})),function(e){e[e.AI=0]="AI",e[e.AI_AND_W3C=1]="AI_AND_W3C",e[e.W3C=2]="W3C"}(at||(at={}));var bt=function(){function e(){}return e.requestContextHeader="Request-Context",e.requestContextTargetKey="appId",e.requestContextAppIdFormat="appId=cid-v1:",e.requestIdHeader="Request-Id",e.traceParentHeader="traceparent",e.sdkContextHeader="Sdk-Context",e.sdkContextHeaderAppIdRequest="appId",e.requestContextHeaderLowerCase="request-context",e}(),St=function(){function e(){}return e.sanitizeKeyAndAddUniqueness=function(t,n,r){var o=n.length,i=e.sanitizeKey(t,n);if(i.length!==o){for(var a=0,s=i;void 0!==r[s];)a++,s=i.substring(0,e.MAX_NAME_LENGTH-3)+e.padNumber(a);i=s}return i},e.sanitizeKey=function(t,n){var r;return n&&(n=e.trim(n.toString())).length>e.MAX_NAME_LENGTH&&(r=n.substring(0,e.MAX_NAME_LENGTH),t.throwInternal(Z.WARNING,re.NameTooLong,"name is too long.  It has been truncated to "+e.MAX_NAME_LENGTH+" characters.",{name:n},!0)),r||n},e.sanitizeString=function(t,n,r){var o;return void 0===r&&(r=e.MAX_STRING_LENGTH),n&&(r=r||e.MAX_STRING_LENGTH,(n=e.trim(n)).toString().length>r&&(o=n.toString().substring(0,r),t.throwInternal(Z.WARNING,re.StringValueTooLong,"string value is too long. It has been truncated to "+r+" characters.",{value:n},!0))),o||n},e.sanitizeUrl=function(t,n){return e.sanitizeInput(t,n,e.MAX_URL_LENGTH,re.UrlTooLong)},e.sanitizeMessage=function(t,n){var r;return n&&n.length>e.MAX_MESSAGE_LENGTH&&(r=n.substring(0,e.MAX_MESSAGE_LENGTH),t.throwInternal(Z.WARNING,re.MessageTruncated,"message is too long, it has been truncated to "+e.MAX_MESSAGE_LENGTH+" characters.",{message:n},!0)),r||n},e.sanitizeException=function(t,n){var r;return n&&n.length>e.MAX_EXCEPTION_LENGTH&&(r=n.substring(0,e.MAX_EXCEPTION_LENGTH),t.throwInternal(Z.WARNING,re.ExceptionTruncated,"exception is too long, it has been truncated to "+e.MAX_EXCEPTION_LENGTH+" characters.",{exception:n},!0)),r||n},e.sanitizeProperties=function(t,n){if(n){var r={};for(var o in n){var i=n[o];if(ee.isObject(i)&&N())try{i=A().stringify(i)}catch(e){t.throwInternal(Z.WARNING,re.CannotSerializeObjectNonSerializable,"custom property is not valid",{exception:e},!0)}i=e.sanitizeString(t,i,e.MAX_PROPERTY_LENGTH),r[o=e.sanitizeKeyAndAddUniqueness(t,o,r)]=i}n=r}return n},e.sanitizeMeasurements=function(t,n){if(n){var r={};for(var o in n){var i=n[o];r[o=e.sanitizeKeyAndAddUniqueness(t,o,r)]=i}n=r}return n},e.sanitizeId=function(t,n){return n?e.sanitizeInput(t,n,e.MAX_ID_LENGTH,re.IdTooLong).toString():n},e.sanitizeInput=function(t,n,r,o){var i;return n&&(n=e.trim(n)).length>r&&(i=n.substring(0,r),t.throwInternal(Z.WARNING,o,"input is too long, it has been truncated to "+r+" characters.",{data:n},!0)),i||n},e.padNumber=function(e){var t="00"+e;return t.substr(t.length-3)},e.trim=function(e){return ee.isString(e)?e.replace(/^\s+|\s+$/g,""):e},e.MAX_NAME_LENGTH=150,e.MAX_ID_LENGTH=128,e.MAX_PROPERTY_LENGTH=8192,e.MAX_STRING_LENGTH=1024,e.MAX_URL_LENGTH=2048,e.MAX_MESSAGE_LENGTH=32768,e.MAX_EXCEPTION_LENGTH=32768,e}(),_t=O(),Tt=ee.isString,It=null;var Ct=function(){function e(){}return e.createDomEvent=function(e){var t=null;if(ee.isFunction(Event))t=new Event(e);else{var n=w();n&&n.createEvent&&(t=n.createEvent("Event")).initEvent(e,!0,!0)}return t},e.disableStorage=function(){e._canUseLocalStorage=!1,e._canUseSessionStorage=!1},e._getLocalStorageObject=function(){return e.canUseLocalStorage()?e._getVerifiedStorageObject(ot.LocalStorage):null},e._getVerifiedStorageObject=function(e){var t,n,r=null;try{if(ee.isNullOrUndefined(S()))return null;n=new Date,(r=e===ot.LocalStorage?_("localStorage"):_("sessionStorage")).setItem(n.toString(),n.toString()),t=r.getItem(n.toString())!==n.toString(),r.removeItem(n.toString()),t&&(r=null)}catch(e){r=null}return r},e.isInternalApplicationInsightsEndpoint=function(t){return-1!==e._internalEndpoints.indexOf(t.toLowerCase())},e.canUseLocalStorage=function(){return void 0===e._canUseLocalStorage&&(e._canUseLocalStorage=!!e._getVerifiedStorageObject(ot.LocalStorage)),e._canUseLocalStorage},e.getStorage=function(t,n){var r=e._getLocalStorageObject();if(null!==r)try{return r.getItem(n)}catch(n){e._canUseLocalStorage=!1,t.throwInternal(Z.WARNING,re.BrowserCannotReadLocalStorage,"Browser failed read of local storage. "+e.getExceptionName(n),{exception:e.dump(n)})}return null},e.setStorage=function(t,n,r){var o=e._getLocalStorageObject();if(null!==o)try{return o.setItem(n,r),!0}catch(n){e._canUseLocalStorage=!1,t.throwInternal(Z.WARNING,re.BrowserCannotWriteLocalStorage,"Browser failed write to local storage. "+e.getExceptionName(n),{exception:e.dump(n)})}return!1},e.removeStorage=function(t,n){var r=e._getLocalStorageObject();if(null!==r)try{return r.removeItem(n),!0}catch(n){e._canUseLocalStorage=!1,t.throwInternal(Z.WARNING,re.BrowserFailedRemovalFromLocalStorage,"Browser failed removal of local storage item. "+e.getExceptionName(n),{exception:e.dump(n)})}return!1},e._getSessionStorageObject=function(){return e.canUseSessionStorage()?e._getVerifiedStorageObject(ot.SessionStorage):null},e.canUseSessionStorage=function(){return void 0===e._canUseSessionStorage&&(e._canUseSessionStorage=!!e._getVerifiedStorageObject(ot.SessionStorage)),e._canUseSessionStorage},e.getSessionStorageKeys=function(){var t=[];if(e.canUseSessionStorage())for(var n in _("sessionStorage"))t.push(n);return t},e.getSessionStorage=function(t,n){var r=e._getSessionStorageObject();if(null!==r)try{return r.getItem(n)}catch(n){e._canUseSessionStorage=!1,t.throwInternal(Z.WARNING,re.BrowserCannotReadSessionStorage,"Browser failed read of session storage. "+e.getExceptionName(n),{exception:e.dump(n)})}return null},e.setSessionStorage=function(t,n,r){var o=e._getSessionStorageObject();if(null!==o)try{return o.setItem(n,r),!0}catch(n){e._canUseSessionStorage=!1,t.throwInternal(Z.WARNING,re.BrowserCannotWriteSessionStorage,"Browser failed write to session storage. "+e.getExceptionName(n),{exception:e.dump(n)})}return!1},e.removeSessionStorage=function(t,n){var r=e._getSessionStorageObject();if(null!==r)try{return r.removeItem(n),!0}catch(n){e._canUseSessionStorage=!1,t.throwInternal(Z.WARNING,re.BrowserFailedRemovalFromSessionStorage,"Browser failed removal of session storage item. "+e.getExceptionName(n),{exception:e.dump(n)})}return!1},e.disableCookies=function(){ee.disableCookies()},e.canUseCookies=function(t){if(void 0===ee._canUseCookies){ee._canUseCookies=!1;try{ee._canUseCookies=void 0!==e.document.cookie}catch(n){t.throwInternal(Z.WARNING,re.CannotAccessCookie,"Cannot access document.cookie - "+e.getExceptionName(n),{exception:e.dump(n)})}}return ee._canUseCookies},e.disallowsSameSiteNone=function(e){return!!Tt(e)&&(-1!==e.indexOf("CPU iPhone OS 12")||-1!==e.indexOf("iPad; CPU OS 12")||(-1!==e.indexOf("Macintosh; Intel Mac OS X 10_14")&&-1!==e.indexOf("Version/")&&-1!==e.indexOf("Safari")||(!(-1===e.indexOf("Macintosh; Intel Mac OS X 10_14")||!function(e,t){var n=e.length,r=n-t.length;return e.substring(r>=0?r:0,n)===t}(e,"AppleWebKit/605.1.15 (KHTML, like Gecko)"))||(-1!==e.indexOf("Chrome/5")||-1!==e.indexOf("Chrome/6")||(-1!==e.indexOf("UnrealEngine")&&-1===e.indexOf("Chrome")||(-1!==e.indexOf("UCBrowser/12")||-1!==e.indexOf("UCBrowser/11")))))))},e.setCookie=function(t,n,r,o){if(e.canUseCookies(t)){var i="",a="";o&&(i=";domain="+o);var s=E();s&&"https:"===s.protocol&&(a=";secure",null===It&&(It=e.disallowsSameSiteNone((O()||{}).userAgent)),It||(r+=";SameSite=None")),e.document.cookie=n+"="+r+i+";path=/"+a}},e.stringToBoolOrDefault=function(e,t){return void 0===t&&(t=!1),void 0===e||null===e?t:"true"===e.toString().toLowerCase()},e.getCookie=function(t,n){if(e.canUseCookies(t)){var r="";if(n&&n.length)for(var o=n+"=",i=e.document.cookie.split(";"),a=0;a<i.length;a++){var s=i[a];if((s=e.trim(s))&&0===s.indexOf(o)){r=s.substring(o.length,i[a].length);break}}return r}},e.deleteCookie=function(t,n){e.canUseCookies(t)&&(e.document.cookie=n+"=;path=/;expires=Thu, 01 Jan 1970 00:00:01 GMT;")},e.random32=function(){return ee.random32(!0)},e.getIEVersion=function(e){void 0===e&&(e=null);var t=e?e.toLowerCase():_t?(_t.userAgent||"").toLowerCase():"";if(-1!==t.indexOf("msie"))return parseInt(t.split("msie")[1]);if(t.indexOf("trident/")){var n=parseInt(t.split("trident/")[1]);if(n)return n+4}return null},e.msToTimeSpan=function(e){(isNaN(e)||e<0)&&(e=0);var t=""+(e=Math.round(e))%1e3,n=""+Math.floor(e/1e3)%60,r=""+Math.floor(e/6e4)%60,o=""+Math.floor(e/36e5)%24,i=Math.floor(e/864e5);return t=1===t.length?"00"+t:2===t.length?"0"+t:t,n=n.length<2?"0"+n:n,r=r.length<2?"0"+r:r,o=o.length<2?"0"+o:o,(i>0?i+".":"")+o+":"+r+":"+n+"."+t},e.isCrossOriginError=function(e,t,n,r,o){return("Script error."===e||"Script error"===e)&&!o},e.dump=function(e){var t=Object[s].toString.call(e),n="";return"[object Error]"===t?n="{ stack: '"+e.stack+"', message: '"+e.message+"', name: '"+e.name+"'":N()&&(n=A().stringify(e)),t+n},e.getExceptionName=function(e){return"[object Error]"===Object[s].toString.call(e)?e.name:""},e.addEventHandler=function(e,t){return ne.Attach(I(),e,t)},e.IsBeaconApiSupported=function(){return"sendBeacon"in _t&&_t.sendBeacon},e.getExtension=function(e,t){for(var n=null,r=0;!n&&r<e.length;)e[r]&&e[r].identifier===t&&(n=e[r]),r++;return n},e.document=w()||{},e._canUseLocalStorage=void 0,e._canUseSessionStorage=void 0,e._internalEndpoints=["https://dc.services.visualstudio.com/v2/track","https://breeze.aimon.applicationinsights.io/v2/track","https://dc-int.services.visualstudio.com/v2/track"],e.NotSpecified="not_specified",e.trim=ee.strTrim,e.newId=ee.newId,e.generateW3CId=ee.generateW3CId,e.isArray=ee.isArray,e.isError=ee.isError,e.isDate=ee.isDate,e.toISOStringForIE8=ee.toISOString,e}(),wt=function(){function e(){}return e.parseUrl=function(t){var n=e._htmlAnchorIdx,r=e._htmlAnchorElement,o=r[n];return e.document.createElement?r[n]||(o=r[n]=e.document.createElement("a")):o={host:e.parseHost(t,!0)},o.href=t,++n>=r.length&&(n=0),e._htmlAnchorIdx=n,o},e.getAbsoluteUrl=function(t){var n,r=e.parseUrl(t);return r&&(n=r.href),n},e.getPathName=function(t){var n,r=e.parseUrl(t);return r&&(n=r.pathname),n},e.getCompleteUrl=function(e,t){return e?e.toUpperCase()+" "+t:t},e.parseHost=function(t,n){var r=e.parseFullHost(t,n);if(r){var o=r.match(/(www[0-9]?\.)?(.[^/:]+)(\:[\d]+)?/i);if(null!=o&&o.length>3&&Tt(o[2])&&o[2].length>0)return o[2]+(o[3]||"")}return r},e.parseFullHost=function(e,t){var n=null;if(e){var r=e.match(/(\w*):\/\/(.[^/:]+)(\:[\d]+)?/i);if(null!=r&&r.length>2&&Tt(r[2])&&r[2].length>0&&(n=r[2]||"",t&&r.length>2)){var o=(r[1]||"").toLowerCase(),i=r[3]||"";"http"===o&&":80"===i?i="":"https"===o&&":443"===i&&(i=""),n+=i}}return n},e.document=w()||{},e._htmlAnchorIdx=0,e._htmlAnchorElement=[null,null,null,null,null],e}(),Ot=function(){function e(){}return e.canIncludeCorrelationHeader=function(e,t,n){if(!t||e&&e.disableCorrelationHeaders)return!1;if(e&&e.correlationHeaderExcludePatterns)for(var r=0;r<e.correlationHeaderExcludePatterns.length;r++)if(e.correlationHeaderExcludePatterns[r].test(t))return!1;var o=wt.parseUrl(t).host.toLowerCase();if(!o||-1===o.indexOf(":443")&&-1===o.indexOf(":80")||(o=(wt.parseFullHost(t,!0)||"").toLowerCase()),!(e&&e.enableCorsCorrelation||o===n))return!1;var i,a=e&&e.correlationHeaderDomains;if(a&&(ee.arrForEach(a,function(e){var t=new RegExp(e.toLowerCase().replace(/\./g,".").replace(/\*/g,".*"));i=i||t.test(o)}),!i))return!1;var s=e&&e.correlationHeaderExcludedDomains;if(!s||0===s.length)return!0;for(r=0;r<s.length;r++){if(new RegExp(s[r].toLowerCase().replace(/\./g,".").replace(/\*/g,".*")).test(o))return!1}return o&&o.length>0},e.getCorrelationContext=function(t){if(t){var n=e.getCorrelationContextValue(t,bt.requestContextTargetKey);if(n&&n!==e.correlationIdPrefix)return n}},e.getCorrelationContextValue=function(e,t){if(e)for(var n=e.split(","),r=0;r<n.length;++r){var o=n[r].split("=");if(2===o.length&&o[0]===t)return o[1]}},e.correlationIdPrefix="cid-v1:",e}(),Pt=function(){function e(){}return e.ParseDependencyPath=function(e,t,n,r){var o,i=r,a=r;if(t&&t.length>0){var s=wt.parseUrl(t);if(o=s.host,!i)if(null!=s.pathname){var u=0===s.pathname.length?"/":s.pathname;"/"!==u.charAt(0)&&(u="/"+u),a=s.pathname,i=St.sanitizeString(e,n?n+" "+u:u)}else i=St.sanitizeString(e,t)}else o=r,i=r;return{target:o,name:i,data:a}},e}(),Et=function(){function e(){}return e.Now=function(){var e=x();if(e&&e.now&&e.timing){var t=e.now()+e.timing.navigationStart;if(t>0)return t}return(new Date).getTime()},e.GetDuration=function(e,t){var n=null;return 0===e||0===t||ee.isNullOrUndefined(e)||ee.isNullOrUndefined(t)||(n=t-e),n},e}(),xt="Microsoft_ApplicationInsights_BypassAjaxInstrumentation",Nt="sampleRate",At="ProcessLegacy",Rt="http.method",Mt="https://dc.services.visualstudio.com",jt=function(){function e(){}return e.parse=function(t){if(!t)return{};var n=t.split(e._FIELDS_SEPARATOR),r=ee.arrReduce(n,function(t,n){var r=n.split(e._FIELD_KEY_VALUE_SEPARATOR);if(2===r.length){var o=r[0].toLowerCase(),i=r[1];t[o]=i}return t},{});if(ee.objKeys(r).length>0){if(r.endpointsuffix){var o=r.location?r.location+".":"";r.ingestionendpoint=r.ingestionendpoint||"https://"+o+"dc."+r.endpointsuffix}r.ingestionendpoint=r.ingestionendpoint||Mt}return r},e._FIELDS_SEPARATOR=";",e._FIELD_KEY_VALUE_SEPARATOR="=",e}(),Dt=function(){return function(){}}(),Lt=function(e){function t(){return e.call(this)||this}return __extends(t,e),t}(Dt),kt=function(e){function t(t,n,r){var o=e.call(this)||this;return o.name=St.sanitizeString(t,r)||Ct.NotSpecified,o.data=n,o.time=ee.toISOString(new Date),o.aiDataContract={time:it.Required,iKey:it.Required,name:it.Required,sampleRate:function(){return 100===o.sampleRate?it.Hidden:it.Required},tags:it.Required,data:it.Required},o}return __extends(t,e),t}(function(){return function(){this.ver=1,this.sampleRate=100,this.tags={}}}()),Ut=function(){return function(){}}(),Ft=function(e){function t(){var t=e.call(this)||this;return t.ver=2,t.properties={},t.measurements={},t}return __extends(t,e),t}(Ut),Bt=function(e){function t(t,n,r,o){var i=e.call(this)||this;return i.aiDataContract={ver:it.Required,name:it.Required,properties:it.Default,measurements:it.Default},i.name=St.sanitizeString(t,n)||Ct.NotSpecified,i.properties=St.sanitizeProperties(t,r),i.measurements=St.sanitizeMeasurements(t,o),i}return __extends(t,e),t.envelopeType="Microsoft.ApplicationInsights.{0}.Event",t.dataType="EventData",t}(Ft),Gt=function(){return function(){}}(),qt=function(e){function t(){var t=e.call(this)||this;return t.ver=2,t.exceptions=[],t.properties={},t.measurements={},t}return __extends(t,e),t}(Ut),Ht=function(){return function(){this.hasFullStack=!0,this.parsedStack=[]}}(),Vt="error";var Wt,Kt=function(e){function t(t,n,r,o,i,a){var s=e.call(this)||this;return s.aiDataContract={ver:it.Required,exceptions:it.Required,severityLevel:it.Default,properties:it.Default,measurements:it.Default},!function(e){return"ver"in e&&"exceptions"in e&&"properties"in e}(n)?(s.exceptions=[new zt(t,n)],s.properties=St.sanitizeProperties(t,r)||{},s.measurements=St.sanitizeMeasurements(t,o),i&&(s.severityLevel=i),a&&(s.id=a)):(s.exceptions=n.exceptions,s.properties=n.properties,s.measurements=n.measurements,n.severityLevel&&(s.severityLevel=n.severityLevel),n.id&&(s.id=n.id),n.problemGroup&&(s.problemGroup=n.problemGroup),s.ver=2,ee.isNullOrUndefined(n.isManual)||(s.isManual=n.isManual)),s}return __extends(t,e),t.CreateFromInterface=function(e,n,r,o){var i=n.exceptions&&ee.arrMap(n.exceptions,function(t){return zt.CreateFromInterface(e,t)});return new t(e,__assign({},n,{exceptions:i}),r,o)},t.prototype.toInterface=function(){var e=this,t=e.exceptions,n=e.properties,r=e.measurements,o=e.severityLevel,i=(e.ver,e.problemGroup),a=e.id,s=e.isManual;return{ver:"4.0",exceptions:t instanceof Array&&ee.arrMap(t,function(e){return e.toInterface()})||void 0,severityLevel:o,properties:n,measurements:r,problemGroup:i,id:a,isManual:s}},t.CreateSimpleException=function(e,t,n,r,o,i){return{exceptions:[{hasFullStack:!0,message:e,stack:o,typeName:t}]}},t.envelopeType="Microsoft.ApplicationInsights.{0}.Exception",t.dataType="ExceptionData",t}(qt),zt=function(e){function t(n,r){var o=e.call(this)||this;if(o.aiDataContract={id:it.Default,outerId:it.Default,typeName:it.Required,message:it.Required,hasFullStack:it.Default,stack:it.Default,parsedStack:it.Array},function(e){return"hasFullStack"in e&&"typeName"in e}(r))o.typeName=r.typeName,o.message=r.message,o.stack=r.stack,o.parsedStack=r.parsedStack,o.hasFullStack=r.hasFullStack;else{var i=r;Ct.isError(i)||(i=i[Vt]||i.evt||i),o.typeName=St.sanitizeString(n,function(e){var t="";if(e&&!(t=e.typeName||e.name||""))try{var n=/function (.{1,})\(/.exec(e.constructor.toString());t=n&&n.length>1?n[1]:""}catch(e){}return t}(i))||Ct.NotSpecified,o.message=St.sanitizeMessage(n,r.message)||Ct.NotSpecified;var a=r.stack;o.parsedStack=t.parseStack(a),o.stack=St.sanitizeException(n,a),o.hasFullStack=Ct.isArray(o.parsedStack)&&o.parsedStack.length>0}return o}return __extends(t,e),t.prototype.toInterface=function(){var e=this.parsedStack instanceof Array&&ee.arrMap(this.parsedStack,function(e){return e.toInterface()});return{id:this.id,outerId:this.outerId,typeName:this.typeName,message:this.message,hasFullStack:this.hasFullStack,stack:this.stack,parsedStack:e||void 0}},t.CreateFromInterface=function(e,n){var r=n.parsedStack instanceof Array&&ee.arrMap(n.parsedStack,function(e){return $t.CreateFromInterface(e)})||n.parsedStack;return new t(e,__assign({},n,{parsedStack:r}))},t.parseStack=function(e){var t;if(ee.isString(e)){var n=e.split("\n");t=[];for(var r=0,o=0,i=0;i<=n.length;i++){var a=n[i];if($t.regex.test(a)){var s=new $t(n[i],r++);o+=s.sizeInBytes,t.push(s)}}if(o>32768)for(var u=0,c=t.length-1,l=0,p=u,d=c;u<c;){if((l+=t[u].sizeInBytes+t[c].sizeInBytes)>32768){var f=d-p+1;t.splice(p,f);break}p=u,d=c,u++,c--}}return t},t}(Ht),$t=function(e){function t(n,r){var o=e.call(this)||this;if(o.sizeInBytes=0,o.aiDataContract={level:it.Required,method:it.Required,assembly:it.Default,fileName:it.Default,line:it.Default},"string"==typeof n){var i=n;o.level=r,o.method="<no_method>",o.assembly=Ct.trim(i),o.fileName="",o.line=0;var a=i.match(t.regex);a&&a.length>=5&&(o.method=Ct.trim(a[2])||o.method,o.fileName=Ct.trim(a[4]),o.line=parseInt(a[5])||0)}else o.level=n.level,o.method=n.method,o.assembly=n.assembly,o.fileName=n.fileName,o.line=n.line,o.sizeInBytes=0;return o.sizeInBytes+=o.method.length,o.sizeInBytes+=o.fileName.length,o.sizeInBytes+=o.assembly.length,o.sizeInBytes+=t.baseSize,o.sizeInBytes+=o.level.toString().length,o.sizeInBytes+=o.line.toString().length,o}return __extends(t,e),t.CreateFromInterface=function(e){return new t(e,null)},t.prototype.toInterface=function(){return{level:this.level,method:this.method,assembly:this.assembly,fileName:this.fileName,line:this.line}},t.regex=/^([\s]+at)?(.*?)(\@|\s\(|\s)([^\(\@\n]+):([0-9]+):([0-9]+)(\)?)$/,t.baseSize=58,t}(Gt),Qt=function(e){function t(){var t=e.call(this)||this;return t.ver=2,t.metrics=[],t.properties={},t.measurements={},t}return __extends(t,e),t}(Ut);!function(e){e[e.Measurement=0]="Measurement",e[e.Aggregation=1]="Aggregation"}(Wt||(Wt={}));var Xt,Yt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.aiDataContract={name:it.Required,kind:it.Default,value:it.Required,count:it.Default,min:it.Default,max:it.Default,stdDev:it.Default},t}return __extends(t,e),t}(function(){return function(){this.kind=Wt.Measurement}}()),Jt=function(e){function t(t,n,r,o,i,a,s,u){var c=e.call(this)||this;c.aiDataContract={ver:it.Required,metrics:it.Required,properties:it.Default};var l=new Yt;return l.count=o>0?o:void 0,l.max=isNaN(a)||null===a?void 0:a,l.min=isNaN(i)||null===i?void 0:i,l.name=St.sanitizeString(t,n)||Ct.NotSpecified,l.value=r,c.metrics=[l],c.properties=St.sanitizeProperties(t,s),c.measurements=St.sanitizeMeasurements(t,u),c}return __extends(t,e),t.envelopeType="Microsoft.ApplicationInsights.{0}.Metric",t.dataType="MetricData",t}(Qt),Zt=function(e){function t(){var t=e.call(this)||this;return t.ver=2,t.properties={},t.measurements={},t}return __extends(t,e),t}(Ft),en=function(e){function t(t,n,r,o,i,a,s){var u=e.call(this)||this;return u.aiDataContract={ver:it.Required,name:it.Default,url:it.Default,duration:it.Default,properties:it.Default,measurements:it.Default,id:it.Default},u.id=St.sanitizeId(t,s),u.url=St.sanitizeUrl(t,r),u.name=St.sanitizeString(t,n)||Ct.NotSpecified,isNaN(o)||(u.duration=Ct.msToTimeSpan(o)),u.properties=St.sanitizeProperties(t,i),u.measurements=St.sanitizeMeasurements(t,a),u}return __extends(t,e),t.envelopeType="Microsoft.ApplicationInsights.{0}.Pageview",t.dataType="PageviewData",t}(Zt),tn=function(e){function t(t,n,r,o,i,a,s,u,c,l,p,d){void 0===c&&(c="Ajax");var f=e.call(this)||this;f.aiDataContract={id:it.Required,ver:it.Required,name:it.Default,resultCode:it.Default,duration:it.Default,success:it.Default,data:it.Default,target:it.Default,type:it.Default,properties:it.Default,measurements:it.Default,kind:it.Default,value:it.Default,count:it.Default,min:it.Default,max:it.Default,stdDev:it.Default,dependencyKind:it.Default,dependencySource:it.Default,commandName:it.Default,dependencyTypeName:it.Default},f.id=n,f.duration=Ct.msToTimeSpan(i),f.success=a,f.resultCode=s+"",f.type=St.sanitizeString(t,c);var h=Pt.ParseDependencyPath(t,r,u,o);return f.data=St.sanitizeUrl(t,o)||h.data,f.target=St.sanitizeString(t,h.target),l&&(f.target=f.target+" | "+l),f.name=St.sanitizeString(t,h.name),f.properties=St.sanitizeProperties(t,p),f.measurements=St.sanitizeMeasurements(t,d),f}return __extends(t,e),t.envelopeType="Microsoft.ApplicationInsights.{0}.RemoteDependency",t.dataType="RemoteDependencyData",t}(function(e){function t(){var t=e.call(this)||this;return t.ver=2,t.success=!0,t.properties={},t.measurements={},t}return __extends(t,e),t}(Ut)),nn=function(e){function t(t,n,r,o,i){var a=e.call(this)||this;return a.aiDataContract={ver:it.Required,message:it.Required,severityLevel:it.Default,properties:it.Default},n=n||Ct.NotSpecified,a.message=St.sanitizeMessage(t,n),a.properties=St.sanitizeProperties(t,o),a.measurements=St.sanitizeMeasurements(t,i),r&&(a.severityLevel=r),a}return __extends(t,e),t.envelopeType="Microsoft.ApplicationInsights.{0}.Message",t.dataType="MessageData",t}(function(e){function t(){var t=e.call(this)||this;return t.ver=2,t.properties={},t.measurements={},t}return __extends(t,e),t}(Ut)),rn=function(e){function t(t,n,r,o,i,a,s){var u=e.call(this)||this;return u.aiDataContract={ver:it.Required,name:it.Default,url:it.Default,duration:it.Default,perfTotal:it.Default,networkConnect:it.Default,sentRequest:it.Default,receivedResponse:it.Default,domProcessing:it.Default,properties:it.Default,measurements:it.Default},u.url=St.sanitizeUrl(t,r),u.name=St.sanitizeString(t,n)||Ct.NotSpecified,u.properties=St.sanitizeProperties(t,i),u.measurements=St.sanitizeMeasurements(t,a),s&&(u.domProcessing=s.domProcessing,u.duration=s.duration,u.networkConnect=s.networkConnect,u.perfTotal=s.perfTotal,u.receivedResponse=s.receivedResponse,u.sentRequest=s.sentRequest),u}return __extends(t,e),t.envelopeType="Microsoft.ApplicationInsights.{0}.PageviewPerformance",t.dataType="PageviewPerformanceData",t}(function(e){function t(){var t=e.call(this)||this;return t.ver=2,t.properties={},t.measurements={},t}return __extends(t,e),t}(Zt)),on=function(e){function t(t,n){var r=e.call(this)||this;return r.aiDataContract={baseType:it.Required,baseData:it.Required},r.baseType=t,r.baseData=n,r}return __extends(t,e),t}(Lt);!function(e){e[e.Verbose=0]="Verbose",e[e.Information=1]="Information",e[e.Warning=2]="Warning",e[e.Error=3]="Error",e[e.Critical=4]="Critical"}(Xt||(Xt={}));var an=function(){function e(){}return e.getConfig=function(e,t,n,r){var o;return void 0===r&&(r=!1),o=n&&e.extensionConfig&&e.extensionConfig[n]&&!ee.isNullOrUndefined(e.extensionConfig[n][t])?e.extensionConfig[n][t]:e[t],ee.isNullOrUndefined(o)?r:o},e}(),sn=function(){return function(){this.applicationVersion="ai.application.ver",this.applicationBuild="ai.application.build",this.applicationTypeId="ai.application.typeId",this.applicationId="ai.application.applicationId",this.applicationLayer="ai.application.layer",this.deviceId="ai.device.id",this.deviceIp="ai.device.ip",this.deviceLanguage="ai.device.language",this.deviceLocale="ai.device.locale",this.deviceModel="ai.device.model",this.deviceFriendlyName="ai.device.friendlyName",this.deviceNetwork="ai.device.network",this.deviceNetworkName="ai.device.networkName",this.deviceOEMName="ai.device.oemName",this.deviceOS="ai.device.os",this.deviceOSVersion="ai.device.osVersion",this.deviceRoleInstance="ai.device.roleInstance",this.deviceRoleName="ai.device.roleName",this.deviceScreenResolution="ai.device.screenResolution",this.deviceType="ai.device.type",this.deviceMachineName="ai.device.machineName",this.deviceVMName="ai.device.vmName",this.deviceBrowser="ai.device.browser",this.deviceBrowserVersion="ai.device.browserVersion",this.locationIp="ai.location.ip",this.locationCountry="ai.location.country",this.locationProvince="ai.location.province",this.locationCity="ai.location.city",this.operationId="ai.operation.id",this.operationName="ai.operation.name",this.operationParentId="ai.operation.parentId",this.operationRootId="ai.operation.rootId",this.operationSyntheticSource="ai.operation.syntheticSource",this.operationCorrelationVector="ai.operation.correlationVector",this.sessionId="ai.session.id",this.sessionIsFirst="ai.session.isFirst",this.sessionIsNew="ai.session.isNew",this.userAccountAcquisitionDate="ai.user.accountAcquisitionDate",this.userAccountId="ai.user.accountId",this.userAgent="ai.user.userAgent",this.userId="ai.user.id",this.userStoreRegion="ai.user.storeRegion",this.userAuthUserId="ai.user.authUserId",this.userAnonymousUserAcquisitionDate="ai.user.anonUserAcquisitionDate",this.userAuthenticatedUserAcquisitionDate="ai.user.authUserAcquisitionDate",this.cloudName="ai.cloud.name",this.cloudRole="ai.cloud.role",this.cloudRoleVer="ai.cloud.roleVer",this.cloudRoleInstance="ai.cloud.roleInstance",this.cloudEnvironment="ai.cloud.environment",this.cloudLocation="ai.cloud.location",this.cloudDeploymentUnit="ai.cloud.deploymentUnit",this.internalNodeName="ai.internal.nodeName",this.internalSdkVersion="ai.internal.sdkVersion",this.internalAgentVersion="ai.internal.agentVersion",this.internalSnippet="ai.internal.snippet",this.internalSdkSrc="ai.internal.sdkSrc"}}(),un=function(){function e(){}return e.create=function(e,t,n,r,o,i){if(n=St.sanitizeString(r,n)||Ct.NotSpecified,ee.isNullOrUndefined(e)||ee.isNullOrUndefined(t)||ee.isNullOrUndefined(n))throw Error("Input doesn't contain all required fields");var a={name:n,time:ee.toISOString(new Date),iKey:"",ext:i||{},tags:[],data:{},baseType:t,baseData:e};if(!ee.isNullOrUndefined(o))for(var s in o)o.hasOwnProperty(s)&&(a.data[s]=o[s]);return a},e}(),cn=function(){function e(){}return e.UserExt="user",e.DeviceExt="device",e.TraceExt="trace",e.WebExt="web",e.AppExt="app",e.OSExt="os",e.SessionExt="ses",e.SDKExt="sdk",e}(),ln=new sn,pn="AppInsightsPropertiesPlugin",dn="AppInsightsChannelPlugin",fn="ApplicationInsightsAnalytics",hn=function(){return function e(t,n,r,o){Ae(e,this,function(e){var i,a=ee.arrForEach,s=ee.isNullOrUndefined,u=null,c=[],l=!1;function p(){r&&a(r.getTransmissionControls(),function(e){a(e,function(e){return e.flush(!0)})})}r&&(i=r.logger),e.trackPageView=function(e,r){var d=e.name;if(s(d)||"string"!=typeof d){var f=w();d=e.name=f&&f.title||""}var h=e.uri;if(s(h)||"string"!=typeof h){var y=E();h=e.uri=y&&y.href||""}if(!o.isPerformanceTimingSupported())return t.sendPageViewInternal(e,r),p(),void i.throwInternal(Z.WARNING,re.NavigationTimingNotSupported,"trackPageView: navigation timing API used for calculation of page duration is not supported in this browser. This page view will be collected without duration and timing info.");var g,m,v=!1,b=o.getPerformanceTiming().navigationStart;b>0&&(g=Et.GetDuration(b,+new Date),o.shouldCollectDuration(g)||(g=void 0)),s(r)||s(r.duration)||(m=r.duration),!n&&isNaN(m)||(isNaN(m)&&(r||(r={}),r.duration=g),t.sendPageViewInternal(e,r),p(),v=!0),r||(r={}),function(e){c.push(e),u||(u=setInterval(function(){var e=c.slice(0),t=!1;c=[],a(e,function(e){e()?t=!0:c.push(e)}),0===c.length&&(clearInterval(u),u=null),t&&p()},100))}(function(){var n=!1;try{if(o.isPerformanceTimingDataReady()){n=!0;var a={name:d,uri:h};o.populatePageViewPerformanceEvent(a),a.isValid||v?(v||(r.duration=a.durationMs,t.sendPageViewInternal(e,r)),l||(t.sendPageViewPerformanceInternal(a,r),l=!0)):(r.duration=g,t.sendPageViewInternal(e,r))}else b>0&&Et.GetDuration(b,+new Date)>6e4&&(n=!0,v||(r.duration=6e4,t.sendPageViewInternal(e,r)))}catch(e){i.throwInternal(Z.CRITICAL,re.TrackPVFailedCalc,"trackPageView failed on page load calculation: "+Ct.getExceptionName(e),{exception:Ct.dump(e)})}return n})}})}}(),yn=function(){function e(e,t){this.prevPageVisitDataKeyName="prevPageVisitData",this.pageVisitTimeTrackingHandler=t,this._logger=e}return e.prototype.trackPreviousPageVisit=function(e,t){try{var n=this.restartPageVisitTimer(e,t);n&&this.pageVisitTimeTrackingHandler(n.pageName,n.pageUrl,n.pageVisitTime)}catch(e){this._logger.warnToConsole("Auto track page visit time failed, metric will not be collected: "+Ct.dump(e))}},e.prototype.restartPageVisitTimer=function(e,t){try{var n=this.stopPageVisitTimer();return this.startPageVisitTimer(e,t),n}catch(e){return this._logger.warnToConsole("Call to restart failed: "+Ct.dump(e)),null}},e.prototype.startPageVisitTimer=function(e,t){try{if(Ct.canUseSessionStorage()){if(null!=Ct.getSessionStorage(this._logger,this.prevPageVisitDataKeyName))throw new Error("Cannot call startPageVisit consecutively without first calling stopPageVisit");var n=new gn(e,t),r=A().stringify(n);Ct.setSessionStorage(this._logger,this.prevPageVisitDataKeyName,r)}}catch(e){this._logger.warnToConsole("Call to start failed: "+Ct.dump(e))}},e.prototype.stopPageVisitTimer=function(){try{if(Ct.canUseSessionStorage()){var e=ee.dateNow(),t=Ct.getSessionStorage(this._logger,this.prevPageVisitDataKeyName);if(t&&N()){var n=A().parse(t);return n.pageVisitTime=e-n.pageVisitStartTime,Ct.removeSessionStorage(this._logger,this.prevPageVisitDataKeyName),n}return null}return null}catch(e){return this._logger.warnToConsole("Stop page visit timer failed: "+Ct.dump(e)),null}},e}(),gn=function(){return function(e,t){this.pageVisitStartTime=ee.dateNow(),this.pageName=e,this.pageUrl=t}}(),mn=function(){function e(e){this.MAX_DURATION_ALLOWED=36e5,e&&(this._logger=e.logger)}return e.prototype.populatePageViewPerformanceEvent=function(e){e.isValid=!1;var t=this.getPerformanceNavigationTiming(),n=this.getPerformanceTiming();if(t||n){if(t)var r=t.duration,o=Et.GetDuration(t.startTime,t.connectEnd),i=Et.GetDuration(t.requestStart,t.responseStart),a=Et.GetDuration(t.responseStart,t.responseEnd),s=Et.GetDuration(t.responseEnd,t.loadEventEnd);else r=Et.GetDuration(n.navigationStart,n.loadEventEnd),o=Et.GetDuration(n.navigationStart,n.connectEnd),i=Et.GetDuration(n.requestStart,n.responseStart),a=Et.GetDuration(n.responseStart,n.responseEnd),s=Et.GetDuration(n.responseEnd,n.loadEventEnd);0===r?this._logger.throwInternal(Z.WARNING,re.ErrorPVCalc,"error calculating page view performance.",{total:r,network:o,request:i,response:a,dom:s}):this.shouldCollectDuration(r,o,i,a,s)?r<Math.floor(o)+Math.floor(i)+Math.floor(a)+Math.floor(s)?this._logger.throwInternal(Z.WARNING,re.ClientPerformanceMathError,"client performance math error.",{total:r,network:o,request:i,response:a,dom:s}):(e.durationMs=r,e.perfTotal=e.duration=Ct.msToTimeSpan(r),e.networkConnect=Ct.msToTimeSpan(o),e.sentRequest=Ct.msToTimeSpan(i),e.receivedResponse=Ct.msToTimeSpan(a),e.domProcessing=Ct.msToTimeSpan(s),e.isValid=!0):this._logger.throwInternal(Z.WARNING,re.InvalidDurationValue,"Invalid page load duration value. Browser perf data won't be sent.",{total:r,network:o,request:i,response:a,dom:s})}},e.prototype.getPerformanceTiming=function(){return this.isPerformanceTimingSupported()?x().timing:null},e.prototype.getPerformanceNavigationTiming=function(){return this.isPerformanceNavigationTimingSupported()?x().getEntriesByType("navigation")[0]:null},e.prototype.isPerformanceNavigationTimingSupported=function(){var e=x();return e&&e.getEntriesByType&&e.getEntriesByType("navigation").length>0},e.prototype.isPerformanceTimingSupported=function(){var e=x();return e&&e.timing},e.prototype.isPerformanceTimingDataReady=function(){var e=x(),t=e?e.timing:0;return t&&t.domainLookupStart>0&&t.navigationStart>0&&t.responseStart>0&&t.requestStart>0&&t.loadEventEnd>0&&t.responseEnd>0&&t.connectEnd>0&&t.domLoading>0},e.prototype.shouldCollectDuration=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=["googlebot","adsbot-google","apis-google","mediapartners-google"],r=(O()||{}).userAgent,o=!1;if(r)for(var i=0;i<n.length;i++)o=o||-1!==r.toLowerCase().indexOf(n[i]);if(o)return!1;for(i=0;i<e.length;i++)if(e[i]<0||e[i]>=this.MAX_DURATION_ALLOWED)return!1;return!0},e}();function vn(e,t){e&&e.dispatchEvent&&t&&e.dispatchEvent(t)}var bn=function(e){function t(){var t=e.call(this)||this;t.identifier=fn,t.priority=180,t.autoRoutePVDelay=500,t._trackAjaxAttempts=0;var n=E();return t._prevUri=n&&n.href||"",t}return __extends(t,e),t.getDefaultConfig=function(e){return e||(e={}),e.sessionRenewalMs=18e5,e.sessionExpirationMs=864e5,e.disableExceptionTracking=Ct.stringToBoolOrDefault(e.disableExceptionTracking),e.autoTrackPageVisitTime=Ct.stringToBoolOrDefault(e.autoTrackPageVisitTime),e.overridePageViewDuration=Ct.stringToBoolOrDefault(e.overridePageViewDuration),e.enableUnhandledPromiseRejectionTracking=Ct.stringToBoolOrDefault(e.enableUnhandledPromiseRejectionTracking),(isNaN(e.samplingPercentage)||e.samplingPercentage<=0||e.samplingPercentage>=100)&&(e.samplingPercentage=100),e.isCookieUseDisabled=Ct.stringToBoolOrDefault(e.isCookieUseDisabled),e.isStorageUseDisabled=Ct.stringToBoolOrDefault(e.isStorageUseDisabled),e.isBrowserLinkTrackingEnabled=Ct.stringToBoolOrDefault(e.isBrowserLinkTrackingEnabled),e.enableAutoRouteTracking=Ct.stringToBoolOrDefault(e.enableAutoRouteTracking),e.namePrefix=e.namePrefix||"",e},t.prototype.processTelemetry=function(e,t){var n=this;qe(this.core,function(){return n.identifier+":processTelemetry"},function(){var r=!1,o=n._telemetryInitializers.length;t=n._getTelCtx(t);for(var i=0;i<o;++i){var a=n._telemetryInitializers[i];if(a)try{if(!1===a.apply(null,[e])){r=!0;break}}catch(e){t.diagLog().throwInternal(Z.CRITICAL,re.TelemetryInitializerFailed,"One of telemetry initializers failed, telemetry item will not be sent: "+Ct.getExceptionName(e),{exception:Ct.dump(e)},!0)}}r||n.processNext(e,t)},function(){return{item:e}},!e.sync)},t.prototype.trackEvent=function(e,t){try{var n=un.create(e,Bt.dataType,Bt.envelopeType,this.diagLog(),t);this.core.track(n)}catch(e){this.diagLog().throwInternal(Z.WARNING,re.TrackTraceFailed,"trackTrace failed, trace will not be collected: "+Ct.getExceptionName(e),{exception:Ct.dump(e)})}},t.prototype.startTrackEvent=function(e){try{this._eventTracking.start(e)}catch(e){this.diagLog().throwInternal(Z.CRITICAL,re.StartTrackEventFailed,"startTrackEvent failed, event will not be collected: "+Ct.getExceptionName(e),{exception:Ct.dump(e)})}},t.prototype.stopTrackEvent=function(e,t,n){try{this._eventTracking.stop(e,void 0,t)}catch(e){this.diagLog().throwInternal(Z.CRITICAL,re.StopTrackEventFailed,"stopTrackEvent failed, event will not be collected: "+Ct.getExceptionName(e),{exception:Ct.dump(e)})}},t.prototype.trackTrace=function(e,t){try{var n=un.create(e,nn.dataType,nn.envelopeType,this.diagLog(),t);this.core.track(n)}catch(e){this.diagLog().throwInternal(Z.WARNING,re.TrackTraceFailed,"trackTrace failed, trace will not be collected: "+Ct.getExceptionName(e),{exception:Ct.dump(e)})}},t.prototype.trackMetric=function(e,t){try{var n=un.create(e,Jt.dataType,Jt.envelopeType,this.diagLog(),t);this.core.track(n)}catch(e){this.diagLog().throwInternal(Z.CRITICAL,re.TrackMetricFailed,"trackMetric failed, metric will not be collected: "+Ct.getExceptionName(e),{exception:Ct.dump(e)})}},t.prototype.trackPageView=function(e,t){try{var n=e||{};this._pageViewManager.trackPageView(n,__assign({},n.properties,n.measurements,t)),this.config.autoTrackPageVisitTime&&this._pageVisitTimeManager.trackPreviousPageVisit(n.name,n.uri)}catch(e){this.diagLog().throwInternal(Z.CRITICAL,re.TrackPVFailed,"trackPageView failed, page view will not be collected: "+Ct.getExceptionName(e),{exception:Ct.dump(e)})}},t.prototype.sendPageViewInternal=function(e,t,n){var r=w();r&&(e.refUri=void 0===e.refUri?r.referrer:e.refUri);var o=un.create(e,en.dataType,en.envelopeType,this.diagLog(),t,n);this.core.track(o),this._trackAjaxAttempts=0},t.prototype.sendPageViewPerformanceInternal=function(e,t,n){var r=un.create(e,rn.dataType,rn.envelopeType,this.diagLog(),t,n);this.core.track(r)},t.prototype.trackPageViewPerformance=function(e,t){try{this._pageViewPerformanceManager.populatePageViewPerformanceEvent(e),this.sendPageViewPerformanceInternal(e,t)}catch(e){this.diagLog().throwInternal(Z.CRITICAL,re.TrackPVFailed,"trackPageViewPerformance failed, page view will not be collected: "+Ct.getExceptionName(e),{exception:Ct.dump(e)})}},t.prototype.startTrackPage=function(e){try{if("string"!=typeof e){var t=w();e=t&&t.title||""}this._pageTracking.start(e)}catch(e){this.diagLog().throwInternal(Z.CRITICAL,re.StartTrackFailed,"startTrackPage failed, page view may not be collected: "+Ct.getExceptionName(e),{exception:Ct.dump(e)})}},t.prototype.stopTrackPage=function(e,t,n,r){try{if("string"!=typeof e){var o=w();e=o&&o.title||""}if("string"!=typeof t){var i=E();t=i&&i.href||""}this._pageTracking.stop(e,t,n,r),this.config.autoTrackPageVisitTime&&this._pageVisitTimeManager.trackPreviousPageVisit(e,t)}catch(e){this.diagLog().throwInternal(Z.CRITICAL,re.StopTrackFailed,"stopTrackPage failed, page view will not be collected: "+Ct.getExceptionName(e),{exception:Ct.dump(e)})}},t.prototype.sendExceptionInternal=function(e,t,n){var r=new Kt(this.diagLog(),e.exception||new Error(Ct.NotSpecified),e.properties,e.measurements,e.severityLevel,e.id).toInterface(),o=un.create(r,Kt.dataType,Kt.envelopeType,this.diagLog(),t,n);this.core.track(o)},t.prototype.trackException=function(e,t){try{this.sendExceptionInternal(e,t)}catch(e){this.diagLog().throwInternal(Z.CRITICAL,re.TrackExceptionFailed,"trackException failed, exception will not be collected: "+Ct.getExceptionName(e),{exception:Ct.dump(e)})}},t.prototype._onerror=function(e){try{var t={url:e&&e.url||(w()||{}).URL,lineNumber:e.lineNumber,columnNumber:e.columnNumber,message:e.message};if(Ct.isCrossOriginError(e.message,e.url,e.lineNumber,e.columnNumber,e.error))this._sendCORSException(t.url);else{if(!Ct.isError(e.error)){var n="window.onerror@"+t.url+":"+e.lineNumber+":"+(e.columnNumber||0);e.error=new Error(e.message),e.error.stack=n}this.trackException({exception:e.error,severityLevel:Xt.Error},t)}}catch(t){var r=e.error?e.error.name+", "+e.error.message:"null";this.diagLog().throwInternal(Z.CRITICAL,re.ExceptionWhileLoggingError,"_onError threw exception while logging error, error will not be collected: "+Ct.getExceptionName(t),{exception:Ct.dump(t),errorString:r})}},t.prototype.addTelemetryInitializer=function(e){this._telemetryInitializers.push(e)},t.prototype.initialize=function(n,r,o,i){var a=this;if(!this.isInitialized()){if(ee.isNullOrUndefined(r))throw Error("Error initializing");e.prototype.initialize.call(this,n,r,o,i),this.setInitialized(!1);var s=this._getTelCtx(),u=this.identifier;this._globalconfig={instrumentationKey:n.instrumentationKey,endpointUrl:n.endpointUrl||"https://dc.services.visualstudio.com/v2/track"},this.config=s.getExtCfg(u);var c=t.getDefaultConfig();if(void 0!==c){for(var l in c)this.config[l]=s.getConfig(u,l,c[l]);if(this._globalconfig)for(var l in c)void 0===this._globalconfig[l]&&(this._globalconfig[l]=c[l])}this.config.isCookieUseDisabled&&Ct.disableCookies(),this.config.isStorageUseDisabled&&Ct.disableStorage();var p={instrumentationKey:function(){return n.instrumentationKey},accountId:function(){return a.config.accountId||n.accountId},sessionRenewalMs:function(){return a.config.sessionRenewalMs||n.sessionRenewalMs},sessionExpirationMs:function(){return a.config.sessionExpirationMs||n.sessionExpirationMs},sampleRate:function(){return a.config.samplingPercentage||n.samplingPercentage},cookieDomain:function(){return a.config.cookieDomain||n.cookieDomain},sdkExtension:function(){return a.config.sdkExtension||n.sdkExtension},isBrowserLinkTrackingEnabled:function(){return a.config.isBrowserLinkTrackingEnabled||n.isBrowserLinkTrackingEnabled},appId:function(){return a.config.appId||n.appId}};this._pageViewPerformanceManager=new mn(this.core),this._pageViewManager=new hn(this,this.config.overridePageViewDuration,this.core,this._pageViewPerformanceManager),this._pageVisitTimeManager=new yn(this.diagLog(),function(e,t,n){return a.trackPageVisitTime(e,t,n)}),this._telemetryInitializers=this._telemetryInitializers||[],this._addDefaultTelemetryInitializers(p),this._eventTracking=new Sn(this.diagLog(),"trackEvent"),this._eventTracking.action=function(e,t,n,r){r||(r={}),r.duration=n.toString(),a.trackEvent({name:e,properties:r})},this._pageTracking=new Sn(this.diagLog(),"trackPageView"),this._pageTracking.action=function(e,t,n,r,o){ee.isNullOrUndefined(r)&&(r={}),r.duration=n.toString();var i={name:e,uri:t,properties:r,measurements:o};a.sendPageViewInternal(i,r)};var d=I(),f=P(),h=E(),y=this;if(!1===this.config.disableExceptionTracking&&!this.config.autoExceptionInstrumented&&d){var g=d.onerror;d.onerror=function(e,t,n,r,o){var i=g&&g(e,t,n,r,o);return!0!==i&&y._onerror({message:e,url:t,lineNumber:n,columnNumber:r,error:o}),i},this.config.autoExceptionInstrumented=!0}if(!1===this.config.disableExceptionTracking&&!0===this.config.enableUnhandledPromiseRejectionTracking&&!this.config.autoUnhandledPromiseInstrumented&&d){var m=d.onunhandledrejection;d.onunhandledrejection=function(e){var t=m&&m.call(d,e);return!0!==t&&y._onerror({message:e.reason.toString(),error:e.reason instanceof Error?e.reason:new Error(e.reason.toString()),url:h?h.href:"",lineNumber:0,columnNumber:0}),t},this.config.autoUnhandledPromiseInstrumented=!0}if(!0===this.config.enableAutoRouteTracking&&f&&ee.isFunction(f.pushState)&&ee.isFunction(f.replaceState)&&d&&"undefined"!=typeof Event){var v=this;ee.arrForEach(o,function(e){e.identifier===pn&&(a._properties=e)}),f.pushState=function(e){return function(){var t=e.apply(this,arguments);return vn(d,Ct.createDomEvent(v.config.namePrefix+"pushState")),vn(d,Ct.createDomEvent(v.config.namePrefix+"locationchange")),t}}(f.pushState),f.replaceState=function(e){return function(){var t=e.apply(this,arguments);return vn(d,Ct.createDomEvent(v.config.namePrefix+"replaceState")),vn(d,Ct.createDomEvent(v.config.namePrefix+"locationchange")),t}}(f.replaceState),d.addEventListener&&(d.addEventListener(v.config.namePrefix+"popstate",function(){vn(d,Ct.createDomEvent(v.config.namePrefix+"locationchange"))}),d.addEventListener(v.config.namePrefix+"locationchange",function(){v._properties&&v._properties.context&&v._properties.context.telemetryTrace&&(v._properties.context.telemetryTrace.traceID=Ct.generateW3CId(),v._properties.context.telemetryTrace.name=h&&h.pathname||"_unknown_"),a._currUri?(a._prevUri=a._currUri,a._currUri=h&&h.href||""):a._currUri=h&&h.href||"",setTimeout(function(e){v.trackPageView({refUri:e,properties:{duration:0}})}.bind(a,a._prevUri),v.autoRoutePVDelay)}))}this.setInitialized(!0)}},t.prototype.trackPageVisitTime=function(e,t,n){var r={PageName:e,PageUrl:t};this.trackMetric({name:"PageVisitTime",average:n,max:n,min:n,sampleCount:1},r)},t.prototype._addDefaultTelemetryInitializers=function(e){if(!e.isBrowserLinkTrackingEnabled()){var t=["/browserLinkSignalR/","/__browserLink/"];this._addTelemetryInitializer(function(e){if(e.baseType===tn.dataType){var n=e.baseData;if(n)for(var r=0;r<t.length;r++)if(n.target&&n.target.indexOf(t[r])>=0)return!1}return!0})}},t.prototype._addTelemetryInitializer=function(e){this._telemetryInitializers.push(e)},t.prototype._sendCORSException=function(e){var t={message:"Script error: The browser's same-origin policy prevents us from getting the details of this exception. Consider using the 'crossorigin' attribute.",url:e,lineNumber:0,columnNumber:0,error:void 0},n=un.create(t,Kt.dataType,Kt.envelopeType,this.diagLog(),{url:e});this.core.track(n)},t.Version="2.5.9",t}(Xe),Sn=function(){function e(e,t){this._name=t,this._events={},this._logger=e}return e.prototype.start=function(e){void 0!==this._events[e]&&this._logger.throwInternal(Z.WARNING,re.StartCalledMoreThanOnce,"start was called more than once for this event without calling stop.",{name:this._name,key:e},!0),this._events[e]=+new Date},e.prototype.stop=function(e,t,n,r){var o=this._events[e];if(isNaN(o))this._logger.throwInternal(Z.WARNING,re.StopCalledWithoutStart,"stop was called without a corresponding start.",{name:this._name,key:e},!0);else{var i=+new Date,a=Et.GetDuration(o,i);this.action(e,t,a,n,r)}delete this._events[e],this._events[e]=void 0},e}(),_n=function(){return function e(t){var n=[];Ae(e,this,function(e){e.enqueue=function(e){n.push(e)},e.count=function(){return n.length},e.clear=function(){n.length=0},e.getItems=function(){return n.slice(0)},e.batchPayloads=function(e){return e&&e.length>0?t.emitLineDelimitedJson()?e.join("\n"):"["+e.join(",")+"]":null},e.markAsSent=function(t){e.clear()},e.clearSent=function(e){}})}}(),Tn=function(){function e(t,n){var r,o=!1;Ae(e,this,function(i){var a=c(e.BUFFER_KEY),s=c(e.SENT_BUFFER_KEY);function u(e,t){var n=[];return ee.arrForEach(t,function(t){ee.isFunction(t)||-1!==ee.arrIndexOf(e,t)||n.push(t)}),n}function c(e){var r=e;try{r=n.namePrefix&&n.namePrefix()?n.namePrefix()+"_"+r:r;var o=Ct.getSessionStorage(t,r);if(o){var i=A().parse(o);if(ee.isString(i)&&(i=A().parse(i)),i&&Ct.isArray(i))return i}}catch(e){t.throwInternal(Z.CRITICAL,re.FailedToRestoreStorageBuffer," storage key: "+r+", "+Ct.getExceptionName(e),{exception:Ct.dump(e)})}return[]}function l(e,r){var o=e;try{o=n.namePrefix&&n.namePrefix()?n.namePrefix()+"_"+o:o;var i=JSON.stringify(r);Ct.setSessionStorage(t,o,i)}catch(e){Ct.setSessionStorage(t,o,JSON.stringify([])),t.throwInternal(Z.WARNING,re.FailedToSetStorageBuffer," storage key: "+o+", "+Ct.getExceptionName(e)+". Buffer cleared",{exception:Ct.dump(e)})}}(r=a.concat(s)).length>e.MAX_BUFFER_SIZE&&(r.length=e.MAX_BUFFER_SIZE),l(e.SENT_BUFFER_KEY,[]),l(e.BUFFER_KEY,r),i.enqueue=function(n){r.length>=e.MAX_BUFFER_SIZE?o||(t.throwInternal(Z.WARNING,re.SessionStorageBufferFull,"Maximum buffer size reached: "+r.length,!0),o=!0):(r.push(n),l(e.BUFFER_KEY,r))},i.count=function(){return r.length},i.clear=function(){r=[],l(e.BUFFER_KEY,[]),l(e.SENT_BUFFER_KEY,[]),o=!1},i.getItems=function(){return r.slice(0)},i.batchPayloads=function(e){return e&&e.length>0?n.emitLineDelimitedJson()?e.join("\n"):"["+e.join(",")+"]":null},i.markAsSent=function(n){r=u(n,r),l(e.BUFFER_KEY,r);var o=c(e.SENT_BUFFER_KEY);o instanceof Array&&n instanceof Array&&((o=o.concat(n)).length>e.MAX_BUFFER_SIZE&&(t.throwInternal(Z.CRITICAL,re.SessionStorageBufferFull,"Sent buffer reached its maximum size: "+o.length,!0),o.length=e.MAX_BUFFER_SIZE),l(e.SENT_BUFFER_KEY,o))},i.clearSent=function(t){var n=c(e.SENT_BUFFER_KEY);n=u(t,n),l(e.SENT_BUFFER_KEY,n)}})}return e.BUFFER_KEY="AI_buffer",e.SENT_BUFFER_KEY="AI_sentBuffer",e.MAX_BUFFER_SIZE=2e3,e}(),In=ee.arrForEach,Cn=ee.objKeys,wn=ee.isNullOrUndefined;function On(e,t,n){return e&&n?(e[t]=n,e[t]):null}var Pn=function(){function e(){}return e.extractPropsAndMeasurements=function(e,t,n){wn(e)||In(Cn(e),function(r){var o=e[r];ee.isNumber(o)?n[r]=o:ee.isString(o)?t[r]=o:N()&&(t[r]=A().stringify(o))})},e.createEnvelope=function(t,n,r,o){var i=new kt(t,o,n);On(i,"sampleRate",r[Nt]),(r.baseData||{}).startTime&&(i.time=ee.toISOString(r.baseData.startTime)),i.iKey=r.iKey;var a=r.iKey.replace(/-/g,"");return i.name=i.name.replace("{0}",a),e.extractPartAExtensions(r,i),r.tags=r.tags||[],i},e.extractPartAExtensions=function(t,n){var r=n.tags=n.tags||{},o=t.ext=t.ext||{},i=t.tags=t.tags||[],a=o.user;a&&(On(r,ln.userAuthUserId,a.authId),On(r,ln.userId,a.id||a.localId));var s=o.app;s&&On(r,ln.sessionId,s.sesId);var u=o.device;u&&(On(r,ln.deviceId,u.id||u.localId),On(r,ln.deviceType,u.deviceClass),On(r,ln.deviceIp,u.ip),On(r,ln.deviceModel,u.model),On(r,ln.deviceType,u.deviceType));var c=t.ext.web;if(c){On(r,ln.deviceLanguage,c.browserLang),On(r,ln.deviceBrowserVersion,c.browserVer),On(r,ln.deviceBrowser,c.browser);var l=n.data=n.data||{},p=l.baseData=l.baseData||{},d=p.properties=p.properties||{};On(d,"domain",c.domain),On(d,"isManual",c.isManual?"true":null),On(d,"screenRes",c.screenRes),On(d,"userConsent",c.userConsent?"true":null)}var f=o.os;f&&On(r,ln.deviceOS,f.name);var h=o.trace;h&&(On(r,ln.operationParentId,h.parentID),On(r,ln.operationName,h.name),On(r,ln.operationId,h.traceID));for(var y={},g=function(e){var t=i[e];In(Cn(t),function(e){y[e]=t[e]}),i.splice(e,1)},m=i.length-1;m>=0;m--)g(m);In(Cn(i),function(e){y[e]=i[e]}),n.tags=__assign({},r,y),n.tags[ln.internalSdkVersion]||(n.tags[ln.internalSdkVersion]="javascript:"+e.Version)},e.prototype.Init=function(e,t){this._logger=e,wn(t.baseData)&&this._logger.throwInternal(Z.CRITICAL,re.TelemetryEnvelopeInvalid,"telemetryItem.baseData cannot be null.")},e.Version="2.5.9",e}(),En=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Create=function(t,n){e.prototype.Init.call(this,t,n);var r=n.baseData.measurements||{},o=n.baseData.properties||{};Pn.extractPropsAndMeasurements(n.data,o,r);var i=n.baseData;if(wn(i))return t.warnToConsole("Invalid input for dependency data"),null;var a=i.properties&&i.properties[Rt]?i.properties[Rt]:"GET",s=new tn(t,i.id,i.target,i.name,i.duration,i.success,i.responseCode,a,i.type,i.correlationContext,o,r),u=new on(tn.dataType,s);return Pn.createEnvelope(t,tn.envelopeType,n,u)},t.DependencyEnvelopeCreator=new t,t}(Pn),xn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Create=function(t,n){e.prototype.Init.call(this,t,n);var r={},o={};n.baseType!==Bt.dataType&&(r.baseTypeSource=n.baseType),n.baseType===Bt.dataType?(r=n.baseData.properties||{},o=n.baseData.measurements||{}):n.baseData&&Pn.extractPropsAndMeasurements(n.baseData,r,o),Pn.extractPropsAndMeasurements(n.data,r,o);var i=n.baseData.name,a=new Bt(t,i,r,o),s=new on(Bt.dataType,a);return Pn.createEnvelope(t,Bt.envelopeType,n,s)},t.EventEnvelopeCreator=new t,t}(Pn),Nn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Create=function(t,n){e.prototype.Init.call(this,t,n);var r=n.baseData.measurements||{},o=n.baseData.properties||{};Pn.extractPropsAndMeasurements(n.data,o,r);var i=n.baseData,a=Kt.CreateFromInterface(t,i,o,r),s=new on(Kt.dataType,a);return Pn.createEnvelope(t,Kt.envelopeType,n,s)},t.ExceptionEnvelopeCreator=new t,t}(Pn),An=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Create=function(t,n){e.prototype.Init.call(this,t,n);var r=n.baseData,o=r.properties||{},i=r.measurements||{};Pn.extractPropsAndMeasurements(n.data,o,i);var a=new Jt(t,r.name,r.average,r.sampleCount,r.min,r.max,o,i),s=new on(Jt.dataType,a);return Pn.createEnvelope(t,Jt.envelopeType,n,s)},t.MetricEnvelopeCreator=new t,t}(Pn),Rn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Create=function(t,n){e.prototype.Init.call(this,t,n);var r,o=n.baseData;wn(o)||wn(o.properties)||wn(o.properties.duration)?wn(n.data)||wn(n.data.duration)||(r=n.data.duration,delete n.data.duration):(r=o.properties.duration,delete o.properties.duration);var i,a=n.baseData;((n.ext||{}).trace||{}).traceID&&(i=n.ext.trace.traceID);var s=a.id||i,u=a.name,c=a.uri,l=a.properties||{},p=a.measurements||{};if(wn(a.refUri)||(l.refUri=a.refUri),wn(a.pageType)||(l.pageType=a.pageType),wn(a.isLoggedIn)||(l.isLoggedIn=a.isLoggedIn.toString()),!wn(a.properties)){var d=a.properties;In(Cn(d),function(e){l[e]=d[e]})}Pn.extractPropsAndMeasurements(n.data,l,p);var f=new en(t,u,c,r,l,p,s),h=new on(en.dataType,f);return Pn.createEnvelope(t,en.envelopeType,n,h)},t.PageViewEnvelopeCreator=new t,t}(Pn),Mn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Create=function(t,n){e.prototype.Init.call(this,t,n);var r=n.baseData,o=r.name,i=r.uri||r.url,a=r.properties||{},s=r.measurements||{};Pn.extractPropsAndMeasurements(n.data,a,s);var u=new rn(t,o,i,void 0,a,s,r),c=new on(rn.dataType,u);return Pn.createEnvelope(t,rn.envelopeType,n,c)},t.PageViewPerformanceEnvelopeCreator=new t,t}(Pn),jn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Create=function(t,n){e.prototype.Init.call(this,t,n);var r=n.baseData.message,o=n.baseData.severityLevel,i=n.baseData.properties||{},a=n.baseData.measurements||{};Pn.extractPropsAndMeasurements(n.data,i,a);var s=new nn(t,r,o,i,a),u=new on(nn.dataType,s);return Pn.createEnvelope(t,nn.envelopeType,n,u)},t.TraceEnvelopeCreator=new t,t}(Pn),Dn=function(){return function e(t){Ae(e,this,function(e){function n(e,i){var a={};if(!e)return t.throwInternal(Z.CRITICAL,re.CannotSerializeObject,"cannot serialize object because it is null or undefined",{name:i},!0),a;if(e.__aiCircularRefCheck)return t.throwInternal(Z.WARNING,re.CircularReferenceDetected,"Circular reference detected while serializing object",{name:i},!0),a;if(!e.aiDataContract){if("measurements"===i)a=o(e,"number",i);else if("properties"===i)a=o(e,"string",i);else if("tags"===i)a=o(e,"string",i);else if(Ct.isArray(e))a=r(e,i);else{t.throwInternal(Z.WARNING,re.CannotSerializeObjectNonSerializable,"Attempting to serialize an object which does not implement ISerializable",{name:i},!0);try{A().stringify(e),a=e}catch(e){t.throwInternal(Z.CRITICAL,re.CannotSerializeObject,e&&ee.isFunction(e.toString)?e.toString():"Error serializing object",null,!0)}}return a}for(var s in e.__aiCircularRefCheck=!0,e.aiDataContract){var u=e.aiDataContract[s],c=ee.isFunction(u)?u()&it.Required:u&it.Required,l=ee.isFunction(u)?u()&it.Hidden:u&it.Hidden,p=u&it.Array,d=void 0!==e[s],f=ee.isObject(e[s])&&null!==e[s];if(!c||d||p){if(!l){var h=void 0;void 0!==(h=f?p?r(e[s],s):n(e[s],s):e[s])&&(a[s]=h)}}else t.throwInternal(Z.CRITICAL,re.MissingRequiredFieldSpecification,"Missing required field specification. The field is required but not present on source",{field:s,name:i})}return delete e.__aiCircularRefCheck,a}function r(e,r){var o;if(e)if(Ct.isArray(e)){o=[];for(var i=0;i<e.length;i++){var a=n(e[i],r+"["+i+"]");o.push(a)}}else t.throwInternal(Z.CRITICAL,re.ItemNotInArray,"This field was specified as an array in the contract but the item is not an array.\r\n",{name:r},!0);return o}function o(e,n,r){var o;if(e)for(var i in o={},e){var a=e[i];if("string"===n)void 0===a?o[i]="undefined":null===a?o[i]="null":a.toString?o[i]=a.toString():o[i]="invalid field: toString() is not defined.";else if("number"===n)if(void 0===a)o[i]="undefined";else if(null===a)o[i]="null";else{var s=parseFloat(a);isNaN(s)?o[i]="NaN":o[i]=s}else o[i]="invalid field: "+r+" is of unknown type.",t.throwInternal(Z.CRITICAL,o[i],null,!0)}return o}e.serialize=function(e){var r=n(e,"root");try{return A().stringify(r)}catch(e){t.throwInternal(Z.CRITICAL,re.CannotSerializeObject,e&&ee.isFunction(e.toString)?e.toString():"Error serializing object",null,!0)}}})}}(),Ln=function(){function e(){var t=I(),n=w(),r=!1,o=!0;Ae(e,this,function(e){try{if(t&&ne.Attach(t,"online",a)&&(ne.Attach(t,"offline",s),r=!0),n){var i=n.body||n;ee.isUndefined(i.ononline)||(i.ononline=a,i.onoffline=s,r=!0)}}catch(e){r=!1}function a(){o=!0}function s(){o=!1}e.isListening=r,e.isOnline=function(){var e=!0,t=O();return r?e=o:t&&!ee.isNullOrUndefined(t.onLine)&&(e=t.onLine),e},e.isOffline=function(){return!e.isOnline()}})}return e.Offline=new e,e}().Offline,kn=function(){function e(){}return e.prototype.getHashCodeScore=function(t){return 100*(this.getHashCode(t)/e.INT_MAX_VALUE)},e.prototype.getHashCode=function(t){if(""===t)return 0;for(;t.length<e.MIN_INPUT_LENGTH;)t=t.concat(t);for(var n=5381,r=0;r<t.length;++r)n=(n<<5)+n+t.charCodeAt(r),n&=n;return Math.abs(n)},e.INT_MAX_VALUE=2147483647,e.MIN_INPUT_LENGTH=8,e}(),Un=function(){function e(){this.hashCodeGeneragor=new kn,this.keys=new sn}return e.prototype.getSamplingScore=function(e){return e.tags&&e.tags[this.keys.userId]?this.hashCodeGeneragor.getHashCodeScore(e.tags[this.keys.userId]):e.ext&&e.ext.user&&e.ext.user.id?this.hashCodeGeneragor.getHashCodeScore(e.ext.user.id):e.tags&&e.tags[this.keys.operationId]?this.hashCodeGeneragor.getHashCodeScore(e.tags[this.keys.operationId]):e.ext&&e.ext.telemetryTrace&&e.ext.telemetryTrace.traceID?this.hashCodeGeneragor.getHashCodeScore(e.ext.telemetryTrace.traceID):100*Math.random()},e}(),Fn=function(){function e(e,t){this.INT_MAX_VALUE=2147483647,this._logger=ee.isNullOrUndefined(t)?new ke:t,(e>100||e<0)&&(this._logger.throwInternal(Z.WARNING,re.SampleRateOutOfRange,"Sampling rate is out of range (0..100). Sampling will be disabled, you may be sending too much data which may affect your AI service level.",{samplingRate:e},!0),this.sampleRate=100),this.sampleRate=e,this.samplingScoreGenerator=new Un}return e.prototype.isSampledIn=function(e){var t=this.sampleRate;return null===t||void 0===t||t>=100||(e.baseType===Jt.dataType||this.samplingScoreGenerator.getSamplingScore(e)<t)},e}();
/*!
 * Application Insights JavaScript SDK - Channel, 2.5.9
 * Copyright (c) Microsoft and contributors. All rights reserved.
 */
function Bn(e){try{return e.responseText}catch(e){}return null}var Gn=function(e){function t(){var n,r,o,i,a=e.call(this)||this;return a.priority=1001,a.identifier=dn,a._XMLHttpRequestSupported=!1,Ae(t,a,function(e,s){function u(){throw new Error("Method not implemented.")}function c(t,n){var r=e._senderConfig.endpointUrl(),o=e._buffer.batchPayloads(t),i=new Blob([o],{type:"text/plain;charset=UTF-8"});O().sendBeacon(r,i)?(e._buffer.markAsSent(t),e._onSuccess(t,t.length)):(l(t,!0),e.diagLog().throwInternal(Z.WARNING,re.TransmissionFailed,". Failed to send telemetry with Beacon API, retried with xhrSender."))}function l(t,n){var r=new XMLHttpRequest,o=e._senderConfig.endpointUrl();try{r[xt]=!0}catch(e){}r.open("POST",o,n),r.setRequestHeader("Content-type","application/json"),Ct.isInternalApplicationInsightsEndpoint(o)&&r.setRequestHeader(bt.sdkContextHeader,bt.sdkContextHeaderAppIdRequest),r.onreadystatechange=function(){return e._xhrReadyStateChange(r,t,t.length)},r.onerror=function(n){return e._onError(t,y(r),n)};var i=e._buffer.batchPayloads(t);r.send(i),e._buffer.markAsSent(t)}function p(t){try{if(t&&""!==t){var n=A().parse(t);if(n&&n.itemsReceived&&n.itemsReceived>=n.itemsAccepted&&n.itemsReceived-n.itemsAccepted===n.errors.length)return n}}catch(n){e.diagLog().throwInternal(Z.CRITICAL,re.InvalidBackendResponse,"Cannot parse the response. "+Ct.getExceptionName(n),{response:t})}return null}function d(t,o){if(void 0===o&&(o=1),t&&0!==t.length){e._buffer.clearSent(t),n++;for(var i=0,a=t;i<a.length;i++){var s=a[i];e._buffer.enqueue(s)}!function(e){var t;if(n<=1)t=10;else{var o=(Math.pow(2,n)-1)/2,i=Math.floor(Math.random()*o*10)+1;i*=e,t=Math.max(Math.min(i,3600),10)}var a=ee.dateNow()+1e3*t;r=a}(o),f()}}function f(){if(!o){var t=r?Math.max(0,r-ee.dateNow()):0,n=Math.max(e._senderConfig.maxBatchInterval(),t);o=setTimeout(function(){e.triggerSend(!0,null,1)},n)}}function h(e){return 408===e||429===e||500===e||503===e}function y(e,t){return e?"XMLHttpRequest,Status:"+e.status+",Response:"+Bn(e)||e.response||"":t}function g(t,n){var r=I(),o=new XDomainRequest;o.onload=function(){return e._xdrOnLoad(o,t)},o.onerror=function(n){return e._onError(t,m(o),n)};var i=r&&r.location&&r.location.protocol||"";if(0!==e._senderConfig.endpointUrl().lastIndexOf(i,0))return e.diagLog().throwInternal(Z.WARNING,re.TransmissionFailed,". Cannot send XDomain request. The endpoint URL protocol doesn't match the hosting page protocol."),void e._buffer.clear();var a=e._senderConfig.endpointUrl().replace(/^(https?:)/,"");o.open("POST",a);var s=e._buffer.batchPayloads(t);o.send(s),e._buffer.markAsSent(t)}function m(e,t){return e?"XDomainRequest,Response:"+Bn(e)||"":t}e.pause=u,e.resume=u,e.flush=function(){try{e.triggerSend(!0,null,1)}catch(t){e.diagLog().throwInternal(Z.CRITICAL,re.FlushFailed,"flush failed, telemetry will not be collected: "+Ct.getExceptionName(t),{exception:Ct.dump(t)})}},e.onunloadFlush=function(){if(!1!==e._senderConfig.onunloadDisableBeacon()&&!1!==e._senderConfig.isBeaconApiDisabled()||!Ct.IsBeaconApiSupported())e.flush();else try{e.triggerSend(!0,c,2)}catch(t){e.diagLog().throwInternal(Z.CRITICAL,re.FailedToSendQueuedTelemetry,"failed to flush with beacon sender on page unload, telemetry will not be collected: "+Ct.getExceptionName(t),{exception:Ct.dump(t)})}},e.teardown=u,e.initialize=function(o,a,u,p){s.initialize(o,a,u,p);var d=e._getTelCtx(),f=e.identifier;i=new Dn(a.logger),n=0,r=null,0,e._sender=null;var h=t._getDefaultAppInsightsChannelConfig();e._senderConfig=t._getEmptyAppInsightsChannelConfig();var y=function(t){e._senderConfig[t]=function(){return d.getConfig(f,t,h[t]())}};for(var m in h)y(m);if(e._buffer=e._senderConfig.enableSessionStorageBuffer()&&Ct.canUseSessionStorage()?new Tn(e.diagLog(),e._senderConfig):new _n(e._senderConfig),e._sample=new Fn(e._senderConfig.samplingPercentage(),e.diagLog()),function(e){if(!ee.isNullOrUndefined(e.disableInstrumentaionKeyValidation)&&e.disableInstrumentaionKeyValidation)return!0;return new RegExp("^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$").test(e.instrumentationKey)}(o)||e.diagLog().throwInternal(Z.CRITICAL,re.InvalidInstrumentationKey,"Invalid Instrumentation key "+o.instrumentationKey),!e._senderConfig.isBeaconApiDisabled()&&Ct.IsBeaconApiSupported())e._sender=c;else if(void 0!==typeof XMLHttpRequest){var v=_("XMLHttpRequest");if(v)"withCredentials"in new v?(e._sender=l,e._XMLHttpRequestSupported=!0):void 0!==typeof XDomainRequest&&(e._sender=g)}},e.processTelemetry=function(n,r){r=e._getTelCtx(r);try{if(e._senderConfig.disableTelemetry())return;if(!n)return void r.diagLog().throwInternal(Z.CRITICAL,re.CannotSendEmptyTelemetry,"Cannot send empty telemetry");if(n.baseData&&!n.baseType)return void r.diagLog().throwInternal(Z.CRITICAL,re.InvalidEvent,"Cannot send telemetry without baseData and baseType");if(n.baseType||(n.baseType="EventData"),!e._sender)return void r.diagLog().throwInternal(Z.CRITICAL,re.SenderNotInitialized,"Sender was not initialized");if(!function(t){return e._sample.isSampledIn(t)}(n))return void r.diagLog().throwInternal(Z.WARNING,re.TelemetrySampledAndNotSent,"Telemetry item was sampled out and not sent",{SampleRate:e._sample.sampleRate});n[Nt]=e._sample.sampleRate;var o=t.constructEnvelope(n,e._senderConfig.instrumentationKey(),r.diagLog());if(!o)return void r.diagLog().throwInternal(Z.CRITICAL,re.CreateEnvelopeError,"Unable to create an AppInsights envelope");var a=!1;if(n.tags&&n.tags[At]&&(ee.arrForEach(n.tags[At],function(e){try{e&&!1===e(o)&&(a=!0,r.diagLog().warnToConsole("Telemetry processor check returns false"))}catch(e){r.diagLog().throwInternal(Z.CRITICAL,re.TelemetryInitializerFailed,"One of telemetry initializers failed, telemetry item will not be sent: "+Ct.getExceptionName(e),{exception:Ct.dump(e)},!0)}}),delete n.tags[At]),a)return;var s=i.serialize(o),u=e._buffer.getItems(),c=e._buffer.batchPayloads(u);c&&c.length+s.length>e._senderConfig.maxBatchSizeInBytes()&&e.triggerSend(!0,null,10),e._buffer.enqueue(s),f()}catch(e){r.diagLog().throwInternal(Z.WARNING,re.FailedAddingTelemetryToBuffer,"Failed adding telemetry to the sender's buffer, some telemetry will be lost: "+Ct.getExceptionName(e),{exception:Ct.dump(e)})}e.processNext(n,r)},e._xhrReadyStateChange=function(t,r,o){if(4===t.readyState){var i=null;if(e._appId||(i=p(Bn(t)||t.response))&&i.appId&&(e._appId=i.appId),(t.status<200||t.status>=300)&&0!==t.status)!e._senderConfig.isRetryDisabled()&&h(t.status)?(d(r),e.diagLog().throwInternal(Z.WARNING,re.TransmissionFailed,". Response code "+t.status+". Will retry to send "+r.length+" items.")):e._onError(r,y(t));else if(Ln.isOffline()){if(!e._senderConfig.isRetryDisabled()){d(r,10),e.diagLog().throwInternal(Z.WARNING,re.TransmissionFailed,". Offline - Response Code: "+t.status+". Offline status: "+Ln.isOffline()+". Will retry to send "+r.length+" items.")}}else 206===t.status?(i||(i=p(Bn(t)||t.response)),i&&!e._senderConfig.isRetryDisabled()?e._onPartialSuccess(r,i):e._onError(r,y(t))):(n=0,e._onSuccess(r,o))}},e.triggerSend=function(t,n,i){void 0===t&&(t=!0);try{if(e._senderConfig.disableTelemetry())e._buffer.clear();else{if(e._buffer.count()>0){var s=e._buffer.getItems();!function(t,n){var r=function(){if(e.core.getNotifyMgr)return e.core.getNotifyMgr();return e.core._notificationManager}();if(r&&r.eventsSendRequest)try{r.eventsSendRequest(t,n)}catch(t){e.diagLog().throwInternal(Z.CRITICAL,re.NotificationException,"send request notification failed: "+Ct.getExceptionName(t),{exception:Ct.dump(t)})}}(i||0,t),n?n.call(a,s,t):e._sender(s,t)}+new Date}clearTimeout(o),o=null,r=null}catch(t){var u=Ct.getIEVersion();(!u||u>9)&&e.diagLog().throwInternal(Z.CRITICAL,re.TransmissionFailed,"Telemetry transmission failed, some telemetry will be lost: "+Ct.getExceptionName(t),{exception:Ct.dump(t)})}},e._onError=function(t,n,r){e.diagLog().throwInternal(Z.WARNING,re.OnError,"Failed to send telemetry.",{message:n}),e._buffer.clearSent(t)},e._onPartialSuccess=function(t,n){for(var r=[],o=[],i=0,a=n.errors.reverse();i<a.length;i++){var s=a[i],u=t.splice(s.index,1)[0];h(s.statusCode)?o.push(u):r.push(u)}t.length>0&&e._onSuccess(t,n.itemsAccepted),r.length>0&&e._onError(r,y(null,["partial success",n.itemsAccepted,"of",n.itemsReceived].join(" "))),o.length>0&&(d(o),e.diagLog().throwInternal(Z.WARNING,re.TransmissionFailed,"Partial success. Delivered: "+t.length+", Failed: "+r.length+". Will retry to send "+o.length+" our of "+n.itemsReceived+" items"))},e._onSuccess=function(t,n){e._buffer.clearSent(t)},e._xdrOnLoad=function(t,r){var o=Bn(t);if(!t||o+""!="200"&&""!==o){var i=p(o);i&&i.itemsReceived&&i.itemsReceived>i.itemsAccepted&&!e._senderConfig.isRetryDisabled()?e._onPartialSuccess(r,i):e._onError(r,m(t))}else n=0,e._onSuccess(r,0)}}),a}return __extends(t,e),t.constructEnvelope=function(e,t,n){var r;switch((r=t===e.iKey||ee.isNullOrUndefined(t)?e:__assign({},e,{iKey:t})).baseType){case Bt.dataType:return xn.EventEnvelopeCreator.Create(n,r);case nn.dataType:return jn.TraceEnvelopeCreator.Create(n,r);case en.dataType:return Rn.PageViewEnvelopeCreator.Create(n,r);case rn.dataType:return Mn.PageViewPerformanceEnvelopeCreator.Create(n,r);case Kt.dataType:return Nn.ExceptionEnvelopeCreator.Create(n,r);case Jt.dataType:return An.MetricEnvelopeCreator.Create(n,r);case tn.dataType:return En.DependencyEnvelopeCreator.Create(n,r);default:return xn.EventEnvelopeCreator.Create(n,r)}},t._getDefaultAppInsightsChannelConfig=function(){return{endpointUrl:function(){return"https://dc.services.visualstudio.com/v2/track"},emitLineDelimitedJson:function(){return!1},maxBatchInterval:function(){return 15e3},maxBatchSizeInBytes:function(){return 102400},disableTelemetry:function(){return!1},enableSessionStorageBuffer:function(){return!0},isRetryDisabled:function(){return!1},isBeaconApiDisabled:function(){return!0},onunloadDisableBeacon:function(){return!1},instrumentationKey:function(){},namePrefix:function(){},samplingPercentage:function(){return 100}}},t._getEmptyAppInsightsChannelConfig=function(){return{endpointUrl:void 0,emitLineDelimitedJson:void 0,maxBatchInterval:void 0,maxBatchSizeInBytes:void 0,disableTelemetry:void 0,enableSessionStorageBuffer:void 0,isRetryDisabled:void 0,isBeaconApiDisabled:void 0,onunloadDisableBeacon:void 0,instrumentationKey:void 0,namePrefix:void 0,samplingPercentage:void 0}},t}(Xe),qn=function(){return function(){}}(),Hn=function(){function e(t,n){var r=this;ee.isNullOrUndefined(n)?this._logger=new ke:this._logger=n,t||(t={}),"function"!=typeof t.sessionExpirationMs&&(t.sessionExpirationMs=function(){return e.acquisitionSpan}),"function"!=typeof t.sessionRenewalMs&&(t.sessionRenewalMs=function(){return e.renewalSpan}),this.config=t,this._storageNamePrefix=function(){return r.config.namePrefix&&r.config.namePrefix()?e.cookieNameConst+r.config.namePrefix():e.cookieNameConst},this.automaticSession=new qn}return e.prototype.update=function(){this.automaticSession.id||this.initializeAutomaticSession();var t=(new Date).getTime(),n=0!==this.config.sessionExpirationMs()&&t-this.automaticSession.acquisitionDate>this.config.sessionExpirationMs(),r=0!==this.config.sessionExpirationMs()&&t-this.automaticSession.renewalDate>this.config.sessionRenewalMs();n||r?this.renew():(!this.cookieUpdatedTimestamp||t-this.cookieUpdatedTimestamp>e.cookieUpdateInterval)&&(this.automaticSession.renewalDate=t,this.setCookie(this.automaticSession.id,this.automaticSession.acquisitionDate,this.automaticSession.renewalDate))},e.prototype.backup=function(){this.setStorage(this.automaticSession.id,this.automaticSession.acquisitionDate,this.automaticSession.renewalDate)},e.prototype.initializeAutomaticSession=function(){var e=Ct.getCookie(this._logger,this._storageNamePrefix());if(e&&"function"==typeof e.split)this.initializeAutomaticSessionWithData(e);else{var t=Ct.getStorage(this._logger,this._storageNamePrefix());t&&this.initializeAutomaticSessionWithData(t)}this.automaticSession.id||this.renew()},e.prototype.initializeAutomaticSessionWithData=function(e){var t=e.split("|");t.length>0&&(this.automaticSession.id=t[0]);try{if(t.length>1){var n=+t[1];this.automaticSession.acquisitionDate=+new Date(n),this.automaticSession.acquisitionDate=this.automaticSession.acquisitionDate>0?this.automaticSession.acquisitionDate:0}if(t.length>2){var r=+t[2];this.automaticSession.renewalDate=+new Date(r),this.automaticSession.renewalDate=this.automaticSession.renewalDate>0?this.automaticSession.renewalDate:0}}catch(e){this._logger.throwInternal(Z.CRITICAL,re.ErrorParsingAISessionCookie,"Error parsing ai_session cookie, session will be reset: "+Ct.getExceptionName(e),{exception:Ct.dump(e)})}0===this.automaticSession.renewalDate&&this._logger.throwInternal(Z.WARNING,re.SessionRenewalDateIsZero,"AI session renewal date is 0, session will be reset.")},e.prototype.renew=function(){var e=(new Date).getTime();this.automaticSession.id=Ct.newId(this.config&&this.config.idLength?this.config.idLength():22),this.automaticSession.acquisitionDate=e,this.automaticSession.renewalDate=e,this.setCookie(this.automaticSession.id,this.automaticSession.acquisitionDate,this.automaticSession.renewalDate),Ct.canUseLocalStorage()||this._logger.throwInternal(Z.WARNING,re.BrowserDoesNotSupportLocalStorage,"Browser does not support local storage. Session durations will be inaccurate.")},e.prototype.setCookie=function(e,t,n){var r=t+this.config.sessionExpirationMs(),o=n+this.config.sessionRenewalMs(),i=new Date,a=[e,t,n];r<o?i.setTime(r):i.setTime(o);var s=this.config.cookieDomain?this.config.cookieDomain():null,u=0===this.config.sessionExpirationMs()?"0":i.toUTCString();Ct.setCookie(this._logger,this._storageNamePrefix(),a.join("|")+";expires="+u,s),this.cookieUpdatedTimestamp=(new Date).getTime()},e.prototype.setStorage=function(e,t,n){Ct.setStorage(this._logger,this._storageNamePrefix(),[e,t,n].join("|"))},e.acquisitionSpan=864e5,e.renewalSpan=18e5,e.cookieUpdateInterval=6e4,e.cookieNameConst="ai_session",e}(),Vn=function(){return function(){}}(),Wn=function(){return function(){this.id="browser",this.deviceClass="Browser"}}(),Kn="2.5.9",zn=function(){return function(e){this.sdkVersion=(e.sdkExtension&&e.sdkExtension()?e.sdkExtension()+"_":"")+"javascript:"+Kn}}(),$n=function(){function e(t,n){this.isNewUser=!1,this._logger=n;var r=Ct.getCookie(this._logger,e.userCookieName);if(r){this.isNewUser=!1;var o=r.split(e.cookieSeparator);o.length>0&&(this.id=o[0])}if(this.config=t,!this.id){this.id=ee.newId(t&&t.idLength?t.idLength():22);var i=new Date,a=ee.toISOString(i);this.accountAcquisitionDate=a,this.isNewUser=!0,i.setTime(i.getTime()+31536e6);var s=[this.id,a],u=this.config.cookieDomain?this.config.cookieDomain():void 0;Ct.setCookie(this._logger,e.userCookieName,s.join(e.cookieSeparator)+";expires="+i.toUTCString(),u);var c=t.namePrefix&&t.namePrefix()?t.namePrefix()+"ai_session":"ai_session";Ct.removeStorage(this._logger,c)}this.accountId=t.accountId?t.accountId():void 0;var l=Ct.getCookie(this._logger,e.authUserCookieName);if(l){var p=(l=decodeURI(l)).split(e.cookieSeparator);p[0]&&(this.authenticatedId=p[0]),p.length>1&&p[1]&&(this.accountId=p[1])}}return e.prototype.setAuthenticatedUserContext=function(t,n,r){if(void 0===r&&(r=!1),!this.validateUserInput(t)||n&&!this.validateUserInput(n))this._logger.throwInternal(Z.WARNING,re.SetAuthContextFailedAccountName,"Setting auth user context failed. User auth/account id should be of type string, and not contain commas, semi-colons, equal signs, spaces, or vertical-bars.",!0);else{this.authenticatedId=t;var o=this.authenticatedId;n&&(this.accountId=n,o=[this.authenticatedId,this.accountId].join(e.cookieSeparator)),r&&Ct.setCookie(this._logger,e.authUserCookieName,encodeURI(o),this.config.cookieDomain())}},e.prototype.clearAuthenticatedUserContext=function(){this.authenticatedId=null,this.accountId=null,Ct.deleteCookie(this._logger,e.authUserCookieName)},e.prototype.validateUserInput=function(e){return!("string"!=typeof e||!e||e.match(/,|;|=| |\|/))},e.cookieSeparator="|",e.userCookieName="ai_user",e.authUserCookieName="ai_authUser",e}(),Qn=function(){return function(){}}(),Xn=function(){return function(e,t,n,r){this.traceID=e||Ct.generateW3CId(),this.parentID=t,this.name=n;var o=E();!n&&o&&o.pathname&&(this.name=o.pathname),this.name=St.sanitizeString(r,this.name)}}(),Yn=function(){function e(e,t){this.application=new Vn,this.internal=new zn(t),T()&&(this.sessionManager=new Hn(t,e),this.device=new Wn,this.location=new Qn,this.user=new $n(t,e),this.telemetryTrace=new Xn(void 0,void 0,void 0,e),this.session=new qn),this.appId=function(){return null}}return e.prototype.applySessionContext=function(e,t){var n=this.session,r=this.sessionManager,o=n||r&&r.automaticSession;o&&ee.isString(o.id)&&(e.ext.app.sesId=o.id),n&&(ee.isString(n.id)?e.ext.app.sesId=n.id:e.ext.app.sesId=r.automaticSession.id)},e.prototype.applyOperatingSystemContxt=function(e,t){var n=this.os;n&&n.name&&(e.ext.os=n)},e.prototype.applyApplicationContext=function(e,t){var n=this.application;n&&(ee.isString(n.ver)&&(e.tags[ln.applicationVersion]=n.ver),ee.isString(n.build)&&(e.tags[ln.applicationBuild]=n.build))},e.prototype.applyDeviceContext=function(e,t){var n=this.device;n&&(ee.isString(n.id)&&(e.ext.device.localId=n.id),ee.isString(n.ip)&&(e.ext.device.ip=n.ip),ee.isString(n.model)&&(e.ext.device.model=n.model),ee.isString(n.deviceClass)&&(e.ext.device.deviceClass=n.deviceClass))},e.prototype.applyInternalContext=function(e,t){var n=this.internal;n&&(ee.isString(n.agentVersion)&&(e.tags[ln.internalAgentVersion]=n.agentVersion),ee.isString(n.sdkVersion)&&(e.tags[ln.internalSdkVersion]=n.sdkVersion),e.baseType!==Le.dataType&&e.baseType!==en.dataType||(ee.isString(n.snippetVer)&&(e.tags[ln.internalSnippet]=n.snippetVer),ee.isString(n.sdkSrc)&&(e.tags[ln.internalSdkSrc]=n.sdkSrc)))},e.prototype.applyLocationContext=function(e,t){var n=this.location;n&&ee.isString(n.ip)&&(e.tags[ln.locationIp]=n.ip)},e.prototype.applyOperationContext=function(e,t){var n=this.telemetryTrace;if(n){var r=e.ext.trace||{traceID:void 0,parentID:void 0};ee.isString(n.traceID)&&(r.traceID=n.traceID),ee.isString(n.name)&&(r.name=n.name),ee.isString(n.parentID)&&(r.parentID=n.parentID),e.ext.trace=r}},e.prototype.applyWebContext=function(e,t){var n=this.web;n&&(e.ext.web=e.ext.web||{},e.ext.web=n)},e.prototype.applyUserContext=function(e,t){var n=this.user;n&&(e.tags||(e.tags=[]),ee.isString(n.accountId)&&(e.tags[ln.userAccountId]=n.accountId),ee.isString(n.id)&&(e.ext.user.id=n.id),ee.isString(n.authenticatedId)&&(e.ext.user.authId=n.authenticatedId))},e.prototype.cleanUp=function(e,t){e.ext[cn.DeviceExt]&&0===ee.objKeys(e.ext[cn.DeviceExt]).length&&delete e.ext[cn.DeviceExt],e.ext[cn.UserExt]&&0===ee.objKeys(e.ext[cn.UserExt]).length&&delete e.ext[cn.UserExt],e.ext[cn.WebExt]&&0===ee.objKeys(e.ext[cn.WebExt]).length&&delete e.ext[cn.WebExt],e.ext[cn.OSExt]&&0===ee.objKeys(e.ext[cn.OSExt]).length&&delete e.ext[cn.OSExt],e.ext[cn.AppExt]&&0===ee.objKeys(e.ext[cn.AppExt]).length&&delete e.ext[cn.AppExt],e.ext[cn.TraceExt]&&0===ee.objKeys(e.ext[cn.TraceExt]).length&&delete e.ext[cn.TraceExt]},e}(),Jn=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.priority=110,t.identifier=pn,t}return __extends(t,e),t.getDefaultConfig=function(){return{instrumentationKey:function(){},accountId:function(){return null},sessionRenewalMs:function(){return 18e5},samplingPercentage:function(){return 100},sessionExpirationMs:function(){return 864e5},cookieDomain:function(){return null},sdkExtension:function(){return null},isBrowserLinkTrackingEnabled:function(){return!1},appId:function(){return null},namePrefix:function(){},idLength:function(){return 22}}},t.prototype.initialize=function(n,r,o,i){var a=this;e.prototype.initialize.call(this,n,r,o,i);var s=this._getTelCtx(),u=this.identifier,c=t.getDefaultConfig();this._extensionConfig=this._extensionConfig||t.getDefaultConfig();var l=function(e){p._extensionConfig[e]=function(){return s.getConfig(u,e,c[e]())}},p=this;for(var d in c)l(d);this.context=new Yn(r.logger,this._extensionConfig),this._breezeChannel=Ct.getExtension(o,dn),this.context.appId=function(){return a._breezeChannel?a._breezeChannel._appId:null}},t.prototype.processTelemetry=function(e,t){if(ee.isNullOrUndefined(e));else{if(t=this._getTelCtx(t),e.name===en.envelopeType&&t.diagLog().resetInternalMessageCount(),this.context.session&&"string"!=typeof this.context.session.id&&this.context.sessionManager.update(),this._processTelemetryInternal(e,t),this.context&&this.context.user&&this.context.user.isNewUser){this.context.user.isNewUser=!1;var n=new Le(re.SendBrowserInfoOnUserInit,(O()||{}).userAgent||"");t.diagLog().logInternalMessage(Z.CRITICAL,n)}this.processNext(e,t)}},t.prototype._processTelemetryInternal=function(e,t){e.tags||(e.tags=[]),e.ext||(e.ext={});var n=e.ext;n[cn.DeviceExt]=n[cn.DeviceExt]||{},n[cn.WebExt]=n[cn.WebExt]||{},n[cn.UserExt]=n[cn.UserExt]||{},n[cn.OSExt]=n[cn.OSExt]||{},n[cn.AppExt]=n[cn.AppExt]||{},n[cn.TraceExt]=n[cn.TraceExt]||{};var r=this.context;r.applySessionContext(e,t),r.applyApplicationContext(e,t),r.applyDeviceContext(e,t),r.applyOperationContext(e,t),r.applyUserContext(e,t),r.applyOperatingSystemContxt(e,t),r.applyWebContext(e,t),r.applyLocationContext(e,t),r.applyInternalContext(e,t),r.cleanUp(e,t)},t}(Xe),Zn="_aiHooks",er=["req","rsp","hkErr","fnErr"],tr="__proto__",nr="constructor";function rr(e,t){if(e)for(var n=0;n<e.length&&!t(e[n],n);n++);}function or(e,t,n,r,o){o>=0&&o<=2&&rr(e,function(e,i){var a=e.cbks,s=a[er[o]];if(s){t.ctx=function(){return r[i]=r[i]||{}};try{s.apply(t.inst,n)}catch(e){var u=t.err;try{var c=a[er[2]];c&&(t.err=e,c.apply(t.inst,n))}catch(e){}finally{t.err=u}}}})}var ir=Object.getPrototypeOf;function ar(e,t,n){var r=null;return e&&(ee.hasOwnProperty(e,t)?r=e:n&&(r=ar(function(e){if(e){if(ir)return ir(e);var t=e[tr]||e[s]||e[nr];if(t)return t}return null}(e),t,!1))),r}function sr(e,t,n,r){if(void 0===r&&(r=!0),e&&t&&n){var o=ar(e,t,r);if(o){var i=o[t];if(typeof i===u){var a=i[Zn];if(!a){var s=function(e){return function(){var t=arguments,n=e.h,r={name:e.n,inst:this,ctx:null,set:function(e,n){(t=a([],t))[e]=n,i=a([r],t)}},o=[],i=a([r],t);function a(e,t){return rr(t,function(t){e.push(t)}),e}or(n,r,i,o,0);var s=e.f;try{r.rslt=s.apply(this,t)}catch(e){throw r.err=e,or(n,r,i,o,3),e}return or(n,r,i,o,1),r.rslt}}(a={i:0,n:t,f:i,h:[]});s[Zn]=a,o[t]=s}var c={id:a.i,cbks:n,rm:function(){var e=this.id;rr(a.h,function(t,n){if(t.id===e)return a.h.splice(n,1),1})}};return a.i++,a.h.push(c),c}}}return null}
/*!
 * Application Insights JavaScript SDK - Dependencies Plugin, 2.5.9
 * Copyright (c) Microsoft and contributors. All rights reserved.
 */
var ur="properties",cr=ee.objKeys,lr=ee.arrForEach;function pr(e,t,n){var r=0,o=e[t],i=e[n];return o&&i&&(r=Et.GetDuration(o,i)),r}function dr(e,t,n,r,o){var i=0,a=pr(n,r,o);return a&&(i=fr(e,t,Ct.msToTimeSpan(a))),i}function fr(e,t,n){var r=0;e&&t&&n&&((e.ajaxPerf=e.ajaxPerf||{})[t]=n,r=1);return r}var hr=function(){return function(){this.openDone=!1,this.setRequestHeaderDone=!1,this.sendDone=!1,this.abortDone=!1,this.stateChangeAttached=!1}}(),yr=function(){return function e(t,n,r){var o=r;this.perfMark=null,this.completed=!1,this.requestHeadersSize=null,this.requestHeaders=null,this.responseReceivingDuration=null,this.callbackDuration=null,this.ajaxTotalDuration=null,this.aborted=0,this.pageUrl=null,this.requestUrl=null,this.requestSize=0,this.method=null,this.status=null,this.requestSentTime=null,this.responseStartedTime=null,this.responseFinishedTime=null,this.callbackFinishedTime=null,this.endTime=null,this.xhrMonitoringState=new hr,this.clientFailure=0,this.traceID=t,this.spanID=n,Ae(e,this,function(e){e.getAbsoluteUrl=function(){return e.requestUrl?wt.getAbsoluteUrl(e.requestUrl):null},e.getPathName=function(){return e.requestUrl?St.sanitizeUrl(o,wt.getCompleteUrl(e.method,e.requestUrl)):null},e.CreateTrackItem=function(t,n,r){if(e.ajaxTotalDuration=Math.round(1e3*Et.GetDuration(e.requestSentTime,e.responseFinishedTime))/1e3,e.ajaxTotalDuration<0)return null;var o,i=((o={id:"|"+e.traceID+"."+e.spanID,target:e.getAbsoluteUrl(),name:e.getPathName(),type:t,duration:e.ajaxTotalDuration,success:+e.status>=200&&+e.status<400,responseCode:+e.status,method:e.method})[ur]={HttpMethod:e.method},o);if(function(e,t){var n=e.perfTiming,r=t[ur]||{},o=0,i=ee.isString,a="redirect",s=a+"Start",u=a="End";if(n){o|=dr(r,a,n,s,u),o|=dr(r,"domainLookup",n,"domainLookupStart","domainLookupEnd"),o|=dr(r,"connect",n,"connectStart","connectEnd"),o|=dr(r,"request",n,"requestStart","requestEnd"),o|=dr(r,"response",n,"responseStart","responseEnd"),o|=dr(r,"networkConnect",n,"startTime","connectEnd"),o|=dr(r,"sentRequest",n,"requestStart","responseEnd");var c=n.duration;c||(c=pr(n,"startTime","responseEnd")||0),o|=fr(r,"duration",c),o|=fr(r,"perfTotal",c);var l=n.serverTiming;if(l){var p={};lr(l,function(e,t){var n=function(e){var t=e,n=/([^\w\d_$])/g;return n.test(e)&&(t=e.replace(n,"_")),t}(e.name||""+t),r=p[n]||{};lr(cr(e),function(t){var n=e[t];("name"!==t&&i(n)||ee.isNumber(n))&&(r[t]&&(n=r[t]+";"+n),!n&&i(n)||(r[t]=n))}),p[n]=r}),o|=fr(r,"serverTiming",p)}o|=fr(r,"transferSize",n.transferSize),o|=fr(r,"encodedBodySize",n.encodedBodySize),o|=fr(r,"decodedBodySize",n.decodedBodySize)}else e.perfMark&&(o|=fr(r,"missing",e.perfAttempts));o&&(t[ur]=r)}(e,i),n&&cr(e.requestHeaders).length>0&&(i[ur]=i[ur]||{},i[ur].requestHeaders=e.requestHeaders),r){var a=r();if(a){var s=a.correlationContext;if(s&&(i.correlationContext=s),a.headerMap&&cr(a.headerMap).length>0&&(i[ur]=i[ur]||{},i[ur].responseHeaders=a.headerMap),e.status>=400){var u=a.type;i[ur]=i[ur]||{},""!==u&&"text"!==u||(i[ur].responseText=a.responseText?a.statusText+" - "+a.responseText:a.statusText),"json"===u&&(i[ur].responseText=a.response?a.statusText+" - "+JSON.stringify(a.response):a.statusText)}}}return i}})}}(),gr=function(){function e(t,n){this.traceFlag=e.DEFAULT_TRACE_FLAG,this.version=e.DEFAULT_VERSION,t&&e.isValidTraceId(t)?this.traceId=t:this.traceId=Ct.generateW3CId(),n&&e.isValidSpanId(n)?this.spanId=n:this.spanId=Ct.generateW3CId().substr(0,16)}return e.isValidTraceId=function(e){return e.match(/^[0-9a-f]{32}$/)&&"00000000000000000000000000000000"!==e},e.isValidSpanId=function(e){return e.match(/^[0-9a-f]{16}$/)&&"0000000000000000"!==e},e.prototype.toString=function(){return this.version+"-"+this.traceId+"-"+this.spanId+"-"+this.traceFlag},e.DEFAULT_TRACE_FLAG="01",e.DEFAULT_VERSION="00",e}(),mr="ai.ajxmn.",vr="diagLog",br="ajaxData",Sr="throwInternal",_r="fetch",Tr=ee.isNullOrUndefined,Ir=ee.arrForEach,Cr=ee.objKeys,wr=0;function Or(e){var t="";try{Tr(e)||Tr(e[br])||Tr(e[br].requestUrl)||(t+="(url: '"+e[br].requestUrl+"')")}catch(e){}return t}function Pr(e,t,n,r,o){e[vr]()[Sr](Z.CRITICAL,t,n,r,o)}function Er(e,t,n,r,o){e[vr]()[Sr](Z.WARNING,t,n,r,o)}function xr(e,t,n){return function(r){Pr(e,t,n,{ajaxDiagnosticsMessage:Or(r.inst),exception:Ct.dump(r.err)})}}function Nr(e,t){return e&&t?e.indexOf(t):-1}var Ar,Rr=function(e){function t(){var n=e.call(this)||this;n.identifier=t.identifier,n.priority=120;var r,o,a,u,c="trackDependencyDataInternal",l=E(),p=!1,d=!1,f=l&&l.host&&l.host.toLowerCase(),h=t.getEmptyConfig(),y=!1,g=0,m=!1,v=0,b=!1,_=[],T={};return Ae(t,n,function(e,n){function l(e,t,n){_.push(function(e,t,n){return e?sr(e[s],t,n,!1):null}(e,t,n))}function I(e,t,n){var r=!1,o=((ee.isString(t)?t:(t||{}).url||"")||"").toLowerCase(),i=Nr(o,"?"),a=Nr(o,"#");return(-1===i||-1!==a&&a<i)&&(i=a),-1!==i&&(o=o.substring(0,i)),Tr(e)?Tr(t)||(r="object"==typeof t&&!0===t[xt]||!!n&&!0===n[xt]):r=!0===e[xt]||!0===o[xt],r?T[o]||(T[o]=1):T[o]&&(r=!0),r}function C(e,t){var n=!0,r=d;return Tr(e)||(n=!0===t||!Tr(e[br])),r&&n}function w(e,t){if(t.requestUrl&&u&&m){var n=x();if(n&&ee.isFunction(n.mark)){var r=u+e+"#"+ ++wr;n.mark(r);var o=n.getEntriesByName(r);o&&1===o.length&&(t.perfMark=o[0])}}}function O(e,t,n,r){var o=t.perfMark,i=x(),a=h.maxAjaxPerfLookupAttempts,s=h.ajaxPerfLookupDelay,u=t.requestUrl,c=0;!function l(){try{if(i&&o){c++;for(var p=null,d=i.getEntries(),f=d.length-1;f>=0;f--){var h=d[f];if(h){if("resource"===h.entryType)h.initiatorType!==e||-1===Nr(h.name,u)&&-1===Nr(u,h.name)||(p=h);else if("mark"===h.entryType&&h.name===o.name){t.perfTiming=p;break}if(h.startTime<o.startTime-1e3)break}}}!o||t.perfTiming||c>=a||!1===t.async?(o&&ee.isFunction(i.clearMarks)&&i.clearMarks(o.name),t.perfAttempts=c,n()):setTimeout(l,s)}catch(e){r(e)}}()}function P(t){var n="";try{Tr(t)||(n+="string"==typeof t?"(url: '"+t+"')":"(url: '"+t.url+"')")}catch(t){Pr(e,re.FailedMonitorAjaxOpen,"Failed to grab failed fetch diagnostics message",{exception:Ct.dump(t)})}return n}function E(t,n,r,o,i,a){function s(t,n,o){var i=o||{};i.fetchDiagnosticsMessage=P(r),n&&(i.exception=Ct.dump(n)),Er(e,t,"Failed to calculate the duration of the fetch call, monitoring data for this fetch call won't be sent.",i)}o&&(o.responseFinishedTime=Et.Now(),o.status=n,O("fetch",o,function(){var t=o.CreateTrackItem("Fetch",y,i);t?e[c](t):s(re.FailedMonitorAjaxDur,null,{requestSentTime:o.requestSentTime,responseFinishedTime:o.responseFinishedTime})},function(e){s(re.FailedMonitorAjaxGetCorrelationHeader,e,null)}))}e.initialize=function(f,g,T,x){if(!e.isInitialized()){n.initialize(f,g,T,x);var N=e._getTelCtx(),A=t.getDefaultConfig();Ir(Cr(A),function(e){h[e]=N.getConfig(t.identifier,e,A[e])});var R=h.distributedTracingMode;if(y=h.enableRequestHeaderTracking,m=h.enableAjaxPerfTracking,v=h.maxAjaxCallsPerView,b=h.enableResponseHeaderTracking,a=R===at.AI||R===at.AI_AND_W3C,o=R===at.AI_AND_W3C||R===at.W3C,m){var M=f.instrumentationKey||"unkwn";u=M.length>5?mr+M.substring(M.length-5)+".":mr+M+"."}if(!1===h.disableAjaxTracking&&function(e){var t=!1;if(typeof XMLHttpRequest!==i&&!Tr(XMLHttpRequest)){var n=XMLHttpRequest[s];t=!(Tr(n)||Tr(n.open)||Tr(n.send)||Tr(n.abort))}var r=Ct.getIEVersion();if(r&&r<9&&(t=!1),t)try{(new XMLHttpRequest)[br]={};var o=XMLHttpRequest[s].open;XMLHttpRequest[s].open=o}catch(n){t=!1,Pr(e,re.FailedMonitorAjaxOpen,"Failed to enable XMLHttpRequest monitoring, extension is not supported",{exception:Ct.dump(n)})}return t}(e)&&!d&&(l(XMLHttpRequest,"open",{req:function(t,n,o,i){var a=t.inst,s=a[br];I(a,o)||!C(a,!0)||s&&s.xhrMonitoringState.openDone||function(t,n,o,i){var a=r&&r.telemetryTrace&&r.telemetryTrace.traceID||Ct.generateW3CId(),s=Ct.generateW3CId().substr(0,16),u=new yr(a,s,e[vr]());u.method=n,u.requestUrl=o,u.xhrMonitoringState.openDone=!0,u.requestHeaders={},u.async=i,t[br]=u,function(t){t[br].xhrMonitoringState.stateChangeAttached=ne.Attach(t,"readystatechange",function(){try{t&&4===t.readyState&&C(t)&&function(t){var n=t[br];function r(n,r){var o=r||{};o.ajaxDiagnosticsMessage=Or(t),n&&(o.exception=Ct.dump(n)),Er(e,re.FailedMonitorAjaxDur,"Failed to calculate the duration of the ajax call, monitoring data for this ajax call won't be sent.",o)}n.responseFinishedTime=Et.Now(),n.status=t.status,O("xmlhttprequest",n,function(){try{var o=n.CreateTrackItem("Ajax",y,function(){var n={statusText:t.statusText,headerMap:null,correlationContext:function(t){try{var n=t.getAllResponseHeaders();if(null!==n){var r=Nr(n.toLowerCase(),bt.requestContextHeaderLowerCase);if(-1!==r){var o=t.getResponseHeader(bt.requestContextHeader);return Ot.getCorrelationContext(o)}}}catch(n){Er(e,re.FailedMonitorAjaxGetCorrelationHeader,"Failed to get Request-Context correlation header as it may be not included in the response or not accessible.",{ajaxDiagnosticsMessage:Or(t),exception:Ct.dump(n)})}}(t),type:t.responseType,responseText:function(e){try{var t=e.responseType;if(""===t||"text"===t)return e.responseText}catch(e){}return null}(t),response:t.response};if(b){var r=t.getAllResponseHeaders();if(r){var o=ee.strTrim(r).split(/[\r\n]+/),i={};Ir(o,function(e){var t=e.split(": "),n=t.shift(),r=t.join(": ");i[n]=r}),n.headerMap=i}}return n});o?e[c](o):r(null,{requestSentTime:n.requestSentTime,responseFinishedTime:n.responseFinishedTime})}finally{try{t[br]=null}catch(e){}}},function(e){r(e,null)})}(t)}catch(r){var n=Ct.dump(r);n&&-1!==Nr(n.toLowerCase(),"c00c023f")||Pr(e,re.FailedMonitorAjaxRSC,"Failed to monitor XMLHttpRequest 'readystatechange' event handler, monitoring data for this ajax call may be incorrect.",{ajaxDiagnosticsMessage:Or(t),exception:n})}})}(t)}(a,n,o,i)},hkErr:xr(e,re.FailedMonitorAjaxOpen,"Failed to monitor XMLHttpRequest.open, monitoring data for this ajax call may be incorrect.")}),l(XMLHttpRequest,"send",{req:function(t,n){var r=t.inst,o=r[br];C(r)&&!o.xhrMonitoringState.sendDone&&(w("xhr",o),o.requestSentTime=Et.Now(),r=e.includeCorrelationHeaders(o,void 0,void 0,r),o.xhrMonitoringState.sendDone=!0)},hkErr:xr(e,re.FailedMonitorAjaxSend,"Failed to monitor XMLHttpRequest, monitoring data for this ajax call may be incorrect.")}),l(XMLHttpRequest,"abort",{req:function(e){var t=e.inst,n=t[br];C(t)&&!n.xhrMonitoringState.abortDone&&(n.aborted=1,n.xhrMonitoringState.abortDone=!0)},hkErr:xr(e,re.FailedMonitorAjaxAbort,"Failed to monitor XMLHttpRequest.abort, monitoring data for this ajax call may be incorrect.")}),y&&l(XMLHttpRequest,"setRequestHeader",{req:function(e,t,n){var r=e.inst;C(r)&&(r[br].requestHeaders[t]=n)},hkErr:xr(e,re.FailedMonitorAjaxSetRequestHeader,"Failed to monitor XMLHttpRequest.setRequestHeader, monitoring data for this ajax call may be incorrect.")}),d=!0),function(){var t=function(){var e=S();return!e||Tr(e.Request)||Tr(e.Request[s])||Tr(e[_r])?null:e[_r]}();if(!t)return;var n=S(),o=t.polyfill;!1===h.disableFetchTracking?(_.push(sr(n,_r,{req:function(t,n,i){var a;if(p&&!I(null,n,i)&&(!o||!d)){var s=t.ctx();a=function(t,n){var o=r&&r.telemetryTrace&&r.telemetryTrace.traceID||Ct.generateW3CId(),i=Ct.generateW3CId().substr(0,16),a=new yr(o,i,e[vr]());a.requestSentTime=Et.Now(),t instanceof Request?a.requestUrl=t?t.url:"":a.requestUrl=t;var s="GET";n&&n.method?s=n.method:t&&t instanceof Request&&(s=t.method);a.method=s;var u={};if(y){var c=new Headers((n?n.headers:0)||t instanceof Request&&t.headers||{});c.forEach(function(e,t){u[t]=e})}return a.requestHeaders=u,w("fetch",a),a}(n,i);var u=e.includeCorrelationHeaders(a,n,i);u!==i&&t.set(1,u),s.data=a}},rsp:function(t,n){var r=t.ctx().data;r&&(t.rslt=t.rslt.then(function(n){return E(t,(n||{}).status,n,r,function(){var t={statusText:n.statusText,headerMap:null,correlationContext:function(t){if(t&&t.headers)try{var n=t.headers.get(bt.requestContextHeader);return Ot.getCorrelationContext(n)}catch(n){Er(e,re.FailedMonitorAjaxGetCorrelationHeader,"Failed to get Request-Context correlation header as it may be not included in the response or not accessible.",{fetchDiagnosticsMessage:P(t),exception:Ct.dump(n)})}}(n)};if(b){var r={};n.headers.forEach(function(e,t){r[t]=e}),t.headerMap=r}return t}),n}).catch(function(e){throw E(t,0,n,r,null,{error:e.message}),e}))},hkErr:xr(e,re.FailedMonitorAjaxOpen,"Failed to monitor Window.fetch, monitoring data for this fetch call may be incorrect.")})),p=!0):o&&_.push(sr(n,_r,{req:function(e,t,n){I(null,t,n)}}));o&&(n[_r].polyfill=o)}(),T.length>0&&T){for(var j=void 0,D=0;!j&&D<T.length;)T[D]&&T[D].identifier===pn&&(j=T[D]),D++;j&&(r=j.context)}}},e.teardown=function(){Ir(_,function(e){e.rm()}),_=[],p=!1,d=!1,e.setInitialized(!1)},e.trackDependencyData=function(t,n){e[c](t,n)},e.includeCorrelationHeaders=function(t,n,i,s){var u=e._currentWindowHost||f;if(n){if(Ot.canIncludeCorrelationHeader(h,t.getAbsoluteUrl(),u)){if(i||(i={}),i.headers=new Headers(i.headers||n instanceof Request&&n.headers||{}),a){var c="|"+t.traceID+"."+t.spanID;i.headers.set(bt.requestIdHeader,c),y&&(t.requestHeaders[bt.requestIdHeader]=c)}if((p=h.appId||r&&r.appId())&&(i.headers.set(bt.requestContextHeader,bt.requestContextAppIdFormat+p),y&&(t.requestHeaders[bt.requestContextHeader]=bt.requestContextAppIdFormat+p)),o){var l=new gr(t.traceID,t.spanID);i.headers.set(bt.traceParentHeader,l.toString()),y&&(t.requestHeaders[bt.traceParentHeader]=l.toString())}}return i}if(s){if(Ot.canIncludeCorrelationHeader(h,t.getAbsoluteUrl(),u)){if(a){c="|"+t.traceID+"."+t.spanID;s.setRequestHeader(bt.requestIdHeader,c),y&&(t.requestHeaders[bt.requestIdHeader]=c)}var p;if((p=h.appId||r&&r.appId())&&(s.setRequestHeader(bt.requestContextHeader,bt.requestContextAppIdFormat+p),y&&(t.requestHeaders[bt.requestContextHeader]=bt.requestContextAppIdFormat+p)),o){l=new gr(t.traceID,t.spanID);s.setRequestHeader(bt.traceParentHeader,l.toString()),y&&(t.requestHeaders[bt.traceParentHeader]=l.toString())}}return s}},e[c]=function(t,n,r){if(-1===v||g<v){h.distributedTracingMode!==at.W3C&&h.distributedTracingMode!==at.AI_AND_W3C||"string"!=typeof t.id||"."===t.id[t.id.length-1]||(t.id+="."),ee.isNullOrUndefined(t.startTime)&&(t.startTime=new Date);var o=un.create(t,tn.dataType,tn.envelopeType,e[vr](),n,r);e.core.track(o)}else g===v&&Pr(e,re.MaxAjaxPerPVExceeded,"Maximum ajax per page view limit reached, ajax monitoring is paused until the next trackPageView(). In order to increase the limit set the maxAjaxCallsPerView configuration parameter.",!0);++g}}),n}return __extends(t,e),t.getDefaultConfig=function(){return{maxAjaxCallsPerView:500,disableAjaxTracking:!1,disableFetchTracking:!0,disableCorrelationHeaders:!1,distributedTracingMode:at.AI,correlationHeaderExcludedDomains:["*.blob.core.windows.net","*.blob.core.chinacloudapi.cn","*.blob.core.cloudapi.de","*.blob.core.usgovcloudapi.net"],correlationHeaderDomains:void 0,appId:void 0,enableCorsCorrelation:!1,enableRequestHeaderTracking:!1,enableResponseHeaderTracking:!1,enableAjaxErrorStatusText:!1,enableAjaxPerfTracking:!1,maxAjaxPerfLookupAttempts:3,ajaxPerfLookupDelay:25}},t.getEmptyConfig=function(){var e=this.getDefaultConfig();return Ir(Cr(e),function(t){e[t]=void 0}),e},t.prototype.processTelemetry=function(e,t){this.processNext(e,t)},t.identifier="AjaxDependencyPlugin",t}(Xe),Mr=r,jr=function(){function e(e){this._snippetVersion=""+(e.sv||e.version||""),e.queue=e.queue||[],e.version=e.version||2;var t=e.config||{};if(t.connectionString){var n=jt.parse(t.connectionString),r=n.ingestionendpoint;t.endpointUrl=r?r+"/v2/track":t.endpointUrl,t.instrumentationKey=n.instrumentationkey||t.instrumentationKey}this.appInsights=new bn,this.properties=new Jn,this.dependencies=new Rr,this.core=new vt,this.snippet=e,this.config=t,this.getSKUDefaults()}return e.prototype.trackEvent=function(e,t){this.appInsights.trackEvent(e,t)},e.prototype.trackPageView=function(e){var t=e||{};this.appInsights.trackPageView(t)},e.prototype.trackPageViewPerformance=function(e){var t=e||{};this.appInsights.trackPageViewPerformance(t)},e.prototype.trackException=function(e){!e.exception&&e.error&&(e.exception=e.error),this.appInsights.trackException(e)},e.prototype._onerror=function(e){this.appInsights._onerror(e)},e.prototype.trackTrace=function(e,t){this.appInsights.trackTrace(e,t)},e.prototype.trackMetric=function(e,t){this.appInsights.trackMetric(e,t)},e.prototype.startTrackPage=function(e){this.appInsights.startTrackPage(e)},e.prototype.stopTrackPage=function(e,t,n,r){this.appInsights.stopTrackPage(e,t,n,r)},e.prototype.startTrackEvent=function(e){this.appInsights.startTrackEvent(e)},e.prototype.stopTrackEvent=function(e,t,n){this.appInsights.stopTrackEvent(e,t,n)},e.prototype.addTelemetryInitializer=function(e){return this.appInsights.addTelemetryInitializer(e)},e.prototype.setAuthenticatedUserContext=function(e,t,n){void 0===n&&(n=!1),this.properties.context.user.setAuthenticatedUserContext(e,t,n)},e.prototype.clearAuthenticatedUserContext=function(){this.properties.context.user.clearAuthenticatedUserContext()},e.prototype.trackDependencyData=function(e){this.dependencies.trackDependencyData(e)},e.prototype.flush=function(e){var t=this;void 0===e&&(e=!0),qe(this.core,function(){return"AISKU.flush"},function(){ee.arrForEach(t.core.getTransmissionControls(),function(t){ee.arrForEach(t,function(t){t.flush(e)})})},null,e)},e.prototype.onunloadFlush=function(e){void 0===e&&(e=!0),ee.arrForEach(this.core.getTransmissionControls(),function(t){ee.arrForEach(t,function(t){t.onunloadFlush?t.onunloadFlush():t.flush(e)})})},e.prototype.loadAppInsights=function(e,t,n){var r=this;void 0===e&&(e=!1);var o=this;if(e&&o.config.extensions&&o.config.extensions.length>0)throw new Error("Extensions not allowed in legacy mode");return qe(o.core,function(){return"AISKU.loadAppInsights"},function(){var i=[],a=new Gn;i.push(a),i.push(o.properties),i.push(o.dependencies),i.push(o.appInsights),o.core.initialize(o.config,i,t,n),o.context=o.properties.context,Ar&&o.context&&(o.context.internal.sdkSrc=Ar),function(t){if(t){var n="";for(var r in ee.isNullOrUndefined(o._snippetVersion)||(n+=o._snippetVersion),e&&(n+=".lg"),o.context&&o.context.internal&&(o.context.internal.snippetVer=n||"-"),o)ee.isString(r)&&!ee.isFunction(o[r])&&"_"!==r.substring(0,1)&&(t[r]=o[r])}}(o.snippet),o.emptyQueue(),o.pollInternalLogs(),o.addHousekeepingBeforeUnload(r)}),o},e.prototype.updateSnippetDefinitions=function(e){for(var t in this)ee.isString(t)&&(e[t]=this[t])},e.prototype.emptyQueue=function(){try{if(Ct.isArray(this.snippet.queue)){for(var e=this.snippet.queue.length,t=0;t<e;t++){(0,this.snippet.queue[t])()}this.snippet.queue=void 0,delete this.snippet.queue}}catch(e){e&&ee.isFunction(e.toString)&&e.toString()}},e.prototype.pollInternalLogs=function(){this.core.pollInternalLogs()},e.prototype.addHousekeepingBeforeUnload=function(e){if(T()||C()){var t=function(){e.onunloadFlush(!1);var t=e.appInsights.core._extensions[pn];t&&t.context&&t.context._sessionManager&&t.context._sessionManager.backup()};if(!e.appInsights.config.disableFlushOnBeforeUnload){var n=ee.addEventHandler("beforeunload",t);(n=ee.addEventHandler("pagehide",t)||n)||function(){var e=O();return!(!e||!e.product)&&e.product===b}()||e.appInsights.core.logger.throwInternal(Z.CRITICAL,re.FailedToAddHandlerForOnBeforeUnload,"Could not add handler for beforeunload and pagehide")}e.appInsights.config.disableFlushOnUnload||ee.addEventHandler("pagehide",t)}},e.prototype.getSKUDefaults=function(){this.config.diagnosticLogInterval=this.config.diagnosticLogInterval&&this.config.diagnosticLogInterval>0?this.config.diagnosticLogInterval:1e4},e}();
/*!
 * Application Insights JavaScript SDK - Web, 2.5.9
 * Copyright (c) Microsoft and contributors. All rights reserved.
 */!function(){var e=null,t=["://az416426.vo.msecnd.net/"];try{var n=(document||{}).currentScript;n&&(e=n.src)}catch(e){}if(e)try{var r=e.toLowerCase();if(r)for(var o="",i=0;i<t.length;i++)if(-1!==r.indexOf(t[i])){o="cdn"+(i+1),-1===r.indexOf("/scripts/")&&(-1!==r.indexOf("/next/")?o+="-next":-1!==r.indexOf("/beta/")&&(o+="-beta")),Ar=o+"";break}}catch(e){}}();
/*!
 * Application Insights JavaScript SDK - Web, 2.5.9
 * Copyright (c) Microsoft and contributors. All rights reserved.
 */
var Dr=function(){function e(t,n){this._hasLegacyInitializers=!1,this._queue=[],this.config=e.getDefaultConfig(t.config),this.appInsightsNew=n,this.context={addTelemetryInitializer:this.addTelemetryInitializers.bind(this)}}return e.getDefaultConfig=function(e){return e||(e={}),e.endpointUrl=e.endpointUrl||"https://dc.services.visualstudio.com/v2/track",e.sessionRenewalMs=18e5,e.sessionExpirationMs=864e5,e.maxBatchSizeInBytes=e.maxBatchSizeInBytes>0?e.maxBatchSizeInBytes:102400,e.maxBatchInterval=isNaN(e.maxBatchInterval)?15e3:e.maxBatchInterval,e.enableDebug=Ct.stringToBoolOrDefault(e.enableDebug),e.disableExceptionTracking=Ct.stringToBoolOrDefault(e.disableExceptionTracking),e.disableTelemetry=Ct.stringToBoolOrDefault(e.disableTelemetry),e.verboseLogging=Ct.stringToBoolOrDefault(e.verboseLogging),e.emitLineDelimitedJson=Ct.stringToBoolOrDefault(e.emitLineDelimitedJson),e.diagnosticLogInterval=e.diagnosticLogInterval||1e4,e.autoTrackPageVisitTime=Ct.stringToBoolOrDefault(e.autoTrackPageVisitTime),(isNaN(e.samplingPercentage)||e.samplingPercentage<=0||e.samplingPercentage>=100)&&(e.samplingPercentage=100),e.disableAjaxTracking=Ct.stringToBoolOrDefault(e.disableAjaxTracking),e.maxAjaxCallsPerView=isNaN(e.maxAjaxCallsPerView)?500:e.maxAjaxCallsPerView,e.isBeaconApiDisabled=Ct.stringToBoolOrDefault(e.isBeaconApiDisabled,!0),e.disableCorrelationHeaders=Ct.stringToBoolOrDefault(e.disableCorrelationHeaders),e.correlationHeaderExcludedDomains=e.correlationHeaderExcludedDomains||["*.blob.core.windows.net","*.blob.core.chinacloudapi.cn","*.blob.core.cloudapi.de","*.blob.core.usgovcloudapi.net"],e.disableFlushOnBeforeUnload=Ct.stringToBoolOrDefault(e.disableFlushOnBeforeUnload),e.disableFlushOnUnload=Ct.stringToBoolOrDefault(e.disableFlushOnUnload,e.disableFlushOnBeforeUnload),e.enableSessionStorageBuffer=Ct.stringToBoolOrDefault(e.enableSessionStorageBuffer,!0),e.isRetryDisabled=Ct.stringToBoolOrDefault(e.isRetryDisabled),e.isCookieUseDisabled=Ct.stringToBoolOrDefault(e.isCookieUseDisabled),e.isStorageUseDisabled=Ct.stringToBoolOrDefault(e.isStorageUseDisabled),e.isBrowserLinkTrackingEnabled=Ct.stringToBoolOrDefault(e.isBrowserLinkTrackingEnabled),e.enableCorsCorrelation=Ct.stringToBoolOrDefault(e.enableCorsCorrelation),e},e.prototype.addTelemetryInitializers=function(e){var t=this;this._hasLegacyInitializers||(this.appInsightsNew.addTelemetryInitializer(function(e){t._processLegacyInitializers(e)}),this._hasLegacyInitializers=!0),this._queue.push(e)},e.prototype.startTrackPage=function(e){this.appInsightsNew.startTrackPage(e)},e.prototype.stopTrackPage=function(e,t,n,r){this.appInsightsNew.stopTrackPage(e,t,n)},e.prototype.trackPageView=function(e,t,n,r,o){var i={name:e,uri:t,properties:n,measurements:r};this.appInsightsNew.trackPageView(i)},e.prototype.trackEvent=function(e,t,n){this.appInsightsNew.trackEvent({name:e})},e.prototype.trackDependency=function(e,t,n,r,o,i,a){this.appInsightsNew.trackDependencyData({id:e,target:n,type:r,duration:o,properties:{HttpMethod:t},success:i,responseCode:a})},e.prototype.trackException=function(e,t,n,r,o){this.appInsightsNew.trackException({exception:e})},e.prototype.trackMetric=function(e,t,n,r,o,i){this.appInsightsNew.trackMetric({name:e,average:t,sampleCount:n,min:r,max:o})},e.prototype.trackTrace=function(e,t,n){this.appInsightsNew.trackTrace({message:e,severityLevel:n})},e.prototype.flush=function(e){this.appInsightsNew.flush(e)},e.prototype.setAuthenticatedUserContext=function(e,t,n){this.appInsightsNew.context.user.setAuthenticatedUserContext(e,t,n)},e.prototype.clearAuthenticatedUserContext=function(){this.appInsightsNew.context.user.clearAuthenticatedUserContext()},e.prototype._onerror=function(e,t,n,r,o){this.appInsightsNew._onerror({message:e,url:t,lineNumber:n,columnNumber:r,error:o})},e.prototype.startTrackEvent=function(e){this.appInsightsNew.startTrackEvent(e)},e.prototype.stopTrackEvent=function(e,t,n){this.appInsightsNew.stopTrackEvent(e,t,n)},e.prototype.downloadAndSetup=function(e){throw new Error("downloadAndSetup not implemented in web SKU")},e.prototype.updateSnippetDefinitions=function(e){for(var t in this)"string"==typeof t&&(e[t]=this[t])},e.prototype.loadAppInsights=function(){var e=this;if(this.config.iKey){var t=this.trackPageView;this.trackPageView=function(n,r,o){t.apply(e,[null,n,r,o])}}"function"==typeof this.snippet.logPageView&&(this.logPageView=function(t,n,r){e.trackPageView(null,t,n,r)});return"function"==typeof this.snippet.logEvent&&(this.logEvent=function(t,n,r){e.trackEvent(t,n,r)}),this},e.prototype._processLegacyInitializers=function(e){return e.tags[At]=this._queue,e},e}(),Lr=function(){function e(){}return e.getAppInsights=function(e,t){var n=new jr(e),r=2!==t;if(2===t)return n.updateSnippetDefinitions(e),n.loadAppInsights(r),n;var o=new Dr(e,n);return o.updateSnippetDefinitions(e),n.loadAppInsights(r),o},e}();
/*!
 * Application Insights JavaScript SDK - Web, 2.5.9
 * Copyright (c) Microsoft and contributors. All rights reserved.
 */
/*!
 * Application Insights JavaScript SDK - Channel, 2.5.9
 * Copyright (c) Microsoft and contributors. All rights reserved.
 */
/*!
 * Application Insights JavaScript SDK - Web Analytics, 2.5.9
 * Copyright (c) Microsoft and contributors. All rights reserved.
 */
/*!
 * Application Insights JavaScript SDK - Dependencies Plugin, 2.5.9
 * Copyright (c) Microsoft and contributors. All rights reserved.
 */n.d(t,"ApplicationInsights",function(){return jr}),n.d(t,"Telemetry",function(){return Mr}),n.d(t,"ApplicationInsightsContainer",function(){return Lr}),n.d(t,"AppInsightsCore",function(){return vt}),n.d(t,"LoggingSeverity",function(){return Z}),n.d(t,"_InternalMessageId",function(){return re}),n.d(t,"PerfEvent",function(){return Fe}),n.d(t,"PerfManager",function(){return Be}),n.d(t,"doPerf",function(){return qe}),n.d(t,"NotificationManager",function(){return mt}),n.d(t,"Util",function(){return Ct}),n.d(t,"SeverityLevel",function(){return Xt}),n.d(t,"Event",function(){return Bt}),n.d(t,"Exception",function(){return Kt}),n.d(t,"Metric",function(){return Jt}),n.d(t,"PageView",function(){return en}),n.d(t,"PageViewPerformance",function(){return rn}),n.d(t,"RemoteDependencyData",function(){return tn}),n.d(t,"Trace",function(){return nn}),n.d(t,"DistributedTracingModes",function(){return at}),n.d(t,"Sender",function(){return Gn}),n.d(t,"ApplicationAnalytics",function(){return bn}),n.d(t,"PropertiesPlugin",function(){return Jn}),n.d(t,"DependenciesPlugin",function(){return Rr})},function(e,t,n){"use strict";n.r(t);var r=n(0),o=n(3),i=n(4),a=n(1),s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function u(e,t){function n(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function c(e,t){void 0===e&&(e=null),void 0===t&&(t=null);var n=[];return n.push('<Query Id="$$ID$$" ObjectPathId="$$PATH_ID$$">'),null===e||e.length<1?(n.push('<Query SelectAllProperties="true" >'),n.push("<Properties />"),n.push("</Query >")):(n.push('<Query SelectAllProperties="false" >'),n.push("<Properties>"),[].push.apply(n,e.map(function(e){return'<Property Name="'+e+'" SelectAll="true" />'})),n.push("</Properties>"),n.push("</Query >")),null!==t&&(t.length<1?(n.push('<ChildItemQuery SelectAllProperties="true" >'),n.push("<Properties />"),n.push("</ChildItemQuery >")):(n.push('<ChildItemQuery SelectAllProperties="false" >'),n.push("<Properties>"),[].push.apply(n,t.map(function(e){return'<Property Name="'+e+'" SelectAll="true" />'})),n.push("</Properties>"),n.push("</ChildItemQuery >"))),n.push("</Query >"),n.join("")}function l(e,t,n){var r=[];return r.push('<SetProperty Id="$$ID$$" ObjectPathId="$$PATH_ID$$" Name="'+e+'">'),r.push('<Parameter Type="'+t+'">'+n+"</Parameter>"),r.push("</SetProperty>"),r.join("")}function p(e){return Object.getOwnPropertyNames(e).map(function(t){var n=e[t];return"boolean"==typeof n?l(t,"Boolean",""+n):"number"==typeof n?l(t,"Number",""+n):"string"==typeof n?l(t,"String",""+n):""},[])}function d(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return new v('<Property Id="$$ID$$" ParentId="$$PARENT_ID$$" Name="'+e+'" />',t)}function f(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return new v('<StaticMethod Id="$$ID$$" Name="'+e+'" TypeId="'+t+'" />',n)}function h(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return new v('<Constructor Id="$$ID$$" TypeId="'+e+'" />',t)}var y=function(){function e(e){void 0===e&&(e=[]),this._p=e}return e.build=function(t){void 0===t&&(t=[]);var n=new e;return[].push.apply(n._p,t),n},e.prototype.string=function(e){return this.a("String",e)},e.prototype.number=function(e){return this.a("Number",e.toString())},e.prototype.boolean=function(e){return this.a("Boolean",e.toString())},e.prototype.strArray=function(e){return this.a("Array",e.map(function(e){return'<Object Type="String">'+e+"</Object>"}).join(""))},e.prototype.objectPath=function(e){return this.a("ObjectPath",e.toString())},e.prototype.toArray=function(){return this._p},e.prototype.a=function(e,t){return this._p.push({type:e,value:t}),this},e}();function g(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var o=[];if(o.push('<Method Id="$$ID$$" ParentId="$$PARENT_ID$$" Name="'+e+'">'),null!==t){var i=t.toArray();i.length<1?o.push("<Parameters />"):(o.push("<Parameters>"),[].push.apply(o,i.map(function(e){return"ObjectPath"===e.type?'<Parameter ObjectPathId="$$OP_PARAM_ID_'+e.value+'$$" />':'<Parameter Type="'+e.type+'">'+e.value+"</Parameter>"})),o.push("</Parameters>"))}return o.push("</Method>"),new v(o.join(""),n)}function m(e){var t=[],n=[];return e.forEach(function(e){n.push(e.path),t.push.apply(t,e.actions)}),['<Request xmlns="http://schemas.microsoft.com/sharepoint/clientquery/2009" SchemaVersion="15.0.0.0" LibraryVersion="16.0.0.0" ApplicationName="PnPjs">',"<Actions>",t.join(""),"</Actions>","<ObjectPaths>",n.join(""),"</ObjectPaths>","</Request>"].join("")}var v=function(){return function(e,t,n,r){void 0===t&&(t=[]),void 0===n&&(n=-1),void 0===r&&(r=[]),this.path=e,this.actions=t,this.id=n,this.replaceAfter=r}}();function b(e,t){return t.replace(/\$\$ID\$\$/g,e)}function S(e,t){return t.replace(/\$\$PATH_ID\$\$/g,e)}function _(e,t){return t.replace(/\$\$PARENT_ID\$\$/g,e)}function T(e,t,n){void 0===n&&(n=function(e){return e});var r=/\$\$OP_PARAM_ID_(\d+)\$\$/gi.exec(t);if(null!==r)for(var o=1;o<r.length;o++){var i=parseInt(r[o],10),a=new RegExp("\\$\\$OP_PARAM_ID_"+i+"\\$\\$","ig");t=t.replace(a,e[n(i)].toString())}return t}var I=function(){function e(e,t){void 0===e&&(e=[]),void 0===t&&(t={}),this._paths=e,this._relationships=t,this._contextIndex=-1,this._siteIndex=-1,this._webIndex=-1}return e.prototype.add=function(e){return this.dirty(),this._paths.push(e),this.lastIndex},e.prototype.addChildRelationship=function(e,t){Object(r.objectDefinedNotNull)(this._relationships["_"+e])?this._relationships["_"+e].push(t):this._relationships["_"+e]=[t]},e.prototype.getChildRelationship=function(e){return Object(r.objectDefinedNotNull)(this._relationships["_"+e])?this._relationships["_"+e]:[]},e.prototype.getChildRelationships=function(){return this._relationships},e.prototype.appendAction=function(e,t){return this.dirty(),e.actions.push(t),this},e.prototype.appendActionToLast=function(e){return this.appendAction(this.last,e)},e.prototype.clone=function(){var t=new e(this.toArray(),Object(r.extend)({},this._relationships));return t._contextIndex=this._contextIndex,t._siteIndex=this._siteIndex,t._webIndex=this._webIndex,t},e.prototype.toArray=function(){return this._paths.slice(0)},Object.defineProperty(e.prototype,"last",{get:function(){return this._paths.length<1?null:this._paths[this.lastIndex]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lastIndex",{get:function(){return this._paths.length-1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"siteIndex",{get:function(){if(this._siteIndex<0){var e=this.contextIndex;this._siteIndex=this.add(d("Site",'<ObjectPath Id="$$ID$$" ObjectPathId="$$PATH_ID$$" />')),this.addChildRelationship(e,this._siteIndex)}return this._siteIndex},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"webIndex",{get:function(){if(this._webIndex<0){var e=this.contextIndex;this._webIndex=this.add(d("Web",'<ObjectPath Id="$$ID$$" ObjectPathId="$$PATH_ID$$" />')),this.addChildRelationship(e,this._webIndex)}return this._webIndex},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"contextIndex",{get:function(){return this._contextIndex<0&&(this._contextIndex=this.add(function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return new v('<StaticProperty Id="$$ID$$" Name="'+e+'" TypeId="'+t+'" />',n)}("Current","{3747adcd-a3c3-41b9-bfab-4a64dd2f1e0a}",'<ObjectPath Id="$$ID$$" ObjectPathId="$$PATH_ID$$" />'))),this._contextIndex},enumerable:!0,configurable:!0}),e.prototype.toBody=function(){return Object(r.objectDefinedNotNull)(this._xml)?this._xml:(this._xml=m(this.toIndexedTree()),this._xml)},e.prototype.toIndexedTree=function(){var e=this,t=-1,n=-1,r=[];return this.toArray().map(function(o,i,a){var s=++t;return r.push(s),o.path=T(r,b(s.toString(),o.path)),n>=0&&(o.path=_(n.toString(),o.path)),o.actions=o.actions.map(function(e){return b((++t).toString(),S(s.toString(),e))}),e.getChildRelationship(i).forEach(function(e){a[e].path=_(s.toString(),a[e].path)}),n=s,o})},e.prototype.dirty=function(){this._xml=null},e}(),C=function(){function e(e){this.op=e}return e.prototype.parse=function(e){var t=this;return e.text().then(function(t){if(!e.ok)throw Error(t);try{return JSON.parse(t)}catch(e){throw Error(t)}}).then(function(e){if(e.length>0&&Object(r.hOP)(e[0],"ErrorInfo")&&null!==e[0].ErrorInfo)throw Error(Object(r.jsS)(e[0].ErrorInfo));return t.findResult(e)})},e.prototype.findResult=function(e){for(var t=0;t<this.op.actions.length;t++){var n,o=this.op.actions[t];if(/^<ObjectPath /i.test(o))if(!(n=this.getParsedResultById(e,parseInt(Object(r.getAttrValueFromString)(o,"Id"),10)))||n&&n.IsNull)return Promise.resolve(null);if(/^<Query /i.test(o))return(n=this.getParsedResultById(e,parseInt(Object(r.getAttrValueFromString)(o,"Id"),10)))&&Object(r.hOP)(n,"_Child_Items_")?Promise.resolve(n._Child_Items_):Promise.resolve(n);if(t===this.op.actions.length-1&&/^<Method /i.test(o))return Promise.resolve(this.getParsedResultById(e,parseInt(Object(r.getAttrValueFromString)(o,"Id"),10)))}},e.prototype.getParsedResultById=function(e,t){for(var n=0;n<e.length;n++)if(e[n]===t)return e[n+1];return null},e}(),w="_vti_bin/client.svc/ProcessQuery",O=function(e){function t(t,n){void 0===t&&(t=""),void 0===n&&(n=null);var o=e.call(this)||this;return o._objectPaths=n,o._selects=[],"string"==typeof t?(o._parentUrl=t,o._url=Object(r.combine)(t.replace(w,""),w),Object(r.objectDefinedNotNull)(o._objectPaths)||(o._objectPaths=new I)):(o._parentUrl=t._parentUrl,o._url=Object(r.combine)(t._parentUrl,w),Object(r.objectDefinedNotNull)(n)||(o._objectPaths=t._objectPaths.clone()),o.configureFrom(t)),o}return u(t,e),t.prototype.select=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return[].push.apply(this._selects,e),this},t.prototype.inBatch=function(e){if(null!==this.batch)throw Error("This query is already part of a batch.");return this._batch=e,this},t.prototype.toUrlAndQuery=function(){return e.prototype.toUrl.call(this)+"?"+Array.from(this.query).map(function(e){return e[0]+"="+e[1]}).join("&")},t.prototype.getSelects=function(){return Object(r.objectDefinedNotNull)(this._selects)?this._selects:[]},t.prototype.getChild=function(e,t,n){var r=this._objectPaths.clone();return r.add(g(t,n,'<ObjectPath Id="$$ID$$" ObjectPathId="$$PATH_ID$$" />')),new e(this,r)},t.prototype.getChildProperty=function(e,t){var n=this._objectPaths.clone();return n.add(d(t)),new e(this,n)},t.prototype.send=function(t,n,o){return void 0===n&&(n={}),void 0===o&&(o=null),Object(r.objectDefinedNotNull)(o)||(o=new C(t.last)),this.hasBatch?n=Object(r.extend)(n,{clientsvc_ObjectPaths:t.clone()}):Object(r.hOP)(n,"body")||(n=Object(r.extend)(n,{body:t.toBody()})),e.prototype.postCore.call(this,n,o)},t.prototype.sendGet=function(e){var t=this,n=this._objectPaths.clone().appendActionToLast(c(this.getSelects()));return this.send(n).then(function(n){return Object(r.extend)(new e(t),n)})},t.prototype.sendGetCollection=function(e){var t=this._objectPaths.clone().appendActionToLast(c([],this.getSelects()));return this.send(t).then(function(t){return t.map(function(t){return Object(r.extend)(e(t),t)})})},t.prototype.invokeMethod=function(e,t){void 0===t&&(t=null);for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return this.invokeMethodImpl(e,t,n,c([],null))},t.prototype.invokeMethodAction=function(e,t){void 0===t&&(t=null);for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return this.invokeMethodImpl(e,t,n,null,!0)},t.prototype.invokeNonQuery=function(e,t){void 0===t&&(t=null);for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return this._useCaching=!1,this.invokeMethodImpl(e,t,n,null,!0)},t.prototype.invokeMethodCollection=function(e,t){void 0===t&&(t=null);for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return this.invokeMethodImpl(e,t,n,c([],[]))},t.prototype.invokeUpdate=function(e,t){var n=this,o=this._objectPaths.clone();return p(e).map(function(e){return o.appendActionToLast(e)}),o.appendActionToLast(c([],null)),this.send(o).then(function(e){return Object(r.extend)(new t(n),e)})},t.prototype.toRequestContext=function(e,t,n,a){var s=this;return Object(i.toAbsoluteUrl)(this.toUrlAndQuery()).then(function(u){Object(r.mergeOptions)(t,s._options);var c=new Headers;if(Object(r.mergeHeaders)(c,t.headers),Object(r.mergeHeaders)(c,{accept:"*/*","content-type":"text/xml"}),t=Object(r.extend)(t,{headers:c}),s._useCaching){var l="PnPjs.ProcessQueryClient("+Object(r.getHashCode)(s._objectPaths.toBody())+")";Object(r.objectDefinedNotNull)(s._cachingOptions)?/\/client\.svc\/ProcessQuery\?$/i.test(s._cachingOptions.key)&&(s._cachingOptions.key=l):s._cachingOptions=new o.c(l)}var p=s.hasBatch?s.addBatchDependency():function(){};return{batch:s.batch,batchDependency:p,cachingOptions:s._cachingOptions,clientFactory:function(){return new i.SPHttpClient},isBatched:s.hasBatch,isCached:s._useCaching,options:t,parser:n,pipeline:a,requestAbsoluteUrl:u,requestId:Object(r.getGUID)(),verb:e}})},t.prototype.addBatchDependency=function(){return null!==this._batch?this._batch.addDependency():function(){return null}},Object.defineProperty(t.prototype,"hasBatch",{get:function(){return Object(r.objectDefinedNotNull)(this._batch)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"batch",{get:function(){return this.hasBatch?this._batch:null},enumerable:!0,configurable:!0}),t.prototype.invokeMethodImpl=function(e,t,n,r,o){void 0===o&&(o=!1);var i=this._objectPaths.clone();return o?i.appendActionToLast(function(e,t){var n=[];if(n.push('<Method Id="$$ID$$" ObjectPathId="$$PATH_ID$$" Name="'+e+'">'),null!==t){var r=t.toArray();r.length<1?n.push("<Parameters />"):(n.push("<Parameters>"),[].push.apply(n,r.map(function(e){return'<Parameter Type="'+e.type+'">'+e.value+"</Parameter>"})),n.push("</Parameters>"))}return n.push("</Method>"),n.join("")}(e,t)):i.add(g.apply(void 0,[e,t].concat(['<ObjectPath Id="$$ID$$" ObjectPathId="$$PATH_ID$$" />'].concat(n,[r])))),this.send(i)},t}(o.j),P=function(e){function t(t,n){var r=e.call(this,n)||this;return r.parentUrl=t,r}return u(t,e),t.prototype.executeImpl=function(){if(this.requests.length<1)return a.a.write("Resolving empty batch.",1),Promise.resolve();var e=new E(this.parentUrl,this.batchId);return e.appendRequests(this.requests),e.execute()},t}(o.f),E=function(e){function t(t,n){var r=e.call(this,t)||this;r.batchId=n,r._requests=[],r._builderIndex=1;var o=f("GetTaxonomySession","{981cbc68-9edc-4f8d-872f-71146fcbb84f}");return o.path=b("0",o.path),o.actions.push(b("1",S("0",'<ObjectPath Id="$$ID$$" ObjectPathId="$$PATH_ID$$" />'))),r._objectPaths.add(o),r}return u(t,e),t.prototype.appendRequests=function(e){var t=this;e.forEach(function(e){var n=e.options.clientsvc_ObjectPaths,r=n.toArray();if(!(r.length<0)){var i=function(e){return e};/GetTaxonomySession/i.test(r[0].path)&&((r=r.slice(1))[0].path=_("0",r[0].path),i=function(e){return e-1});var a=-1,s=[];r.map(function(e,r,o){var u=++t._builderIndex;s.push(u);var c=T(s,b(u.toString(),e.path),i);a>=0&&(c=_(a.toString(),c));var l=e.actions.map(function(e){return b((++t._builderIndex).toString(),S(u.toString(),e))});return n.getChildRelationship(r+1).map(function(e){return e-1}).forEach(function(e){o[e].path=_(u.toString(),o[e].path)}),a=u,new v(c,l)}).forEach(function(e){return t._objectPaths.add(e)});var u=t._objectPaths.toArray(),c=new C(u[u.length-1]);e.parser instanceof o.d?e.parser=new N(c,e.parser):e.parser=c,t._requests.push(e),delete e.options.clientsvc_ObjectPaths}})},t.prototype.execute=function(){var t=this;a.a.write("["+this.batchId+"] ("+(new Date).getTime()+") Executing batch with "+this._requests.length+" requests.",1);var n={body:m(this._objectPaths.toArray())};return a.a.write("["+this.batchId+"] ("+(new Date).getTime()+") Sending batch request.",1),e.prototype.postCore.call(this,n,new x).then(function(e){return a.a.write("["+t.batchId+"] ("+(new Date).getTime()+") Resolving batched requests.",1),t._requests.reduce(function(n,r){return a.a.write("["+r.id+"] ("+(new Date).getTime()+") Resolving request in batch "+t.batchId+".",1),n.then(function(t){return r.parser.findResult(e).then(r.resolve).catch(r.reject)})},Promise.resolve())})},t}(O),x=function(e){function t(){return e.call(this,null)||this}return u(t,e),t.prototype.findResult=function(e){return e},t}(C),N=function(e){function t(t,n){return e.call(this,t,n.cacheOptions)||this}return u(t,e),t.prototype.findResult=function(e){var t=this;return this.parser.findResult(e).then(function(e){return t.cacheData(e)})},t}(o.d);n.d(t,"taxonomy",function(){return $}),n.d(t,"Labels",function(){return L}),n.d(t,"Label",function(){return k}),n.d(t,"Session",function(){return W}),n.d(t,"TermGroup",function(){return q}),n.d(t,"Terms",function(){return U}),n.d(t,"Term",function(){return F}),n.d(t,"TermSets",function(){return B}),n.d(t,"TermSet",function(){return G}),n.d(t,"TermStores",function(){return H}),n.d(t,"TermStore",function(){return V}),n.d(t,"StringMatchOption",function(){return M}),n.d(t,"ChangedItemType",function(){return j}),n.d(t,"ChangedOperationType",function(){return D}),n.d(t,"setItemMetaDataField",function(){return K}),n.d(t,"setItemMetaDataMultiField",function(){return z});
/**
 * @license
 * v1.2.6
 * MIT (https://github.com/pnp/pnpjs/blob/master/LICENSE)
 * Copyright (c) 2018 Microsoft
 * docs: https://pnp.github.io/pnpjs/
 * source: https://github.com/pnp/pnpjs
 * bugs: https://github.com/pnp/pnpjs/issues
 */
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var A=function(e,t){return(A=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function R(e,t){function n(){this.constructor=e}A(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var M,j,D,L=function(e){function t(t,n){void 0===t&&(t=""),void 0===n&&(n=null);var r=e.call(this,t,n)||this;return r._objectPaths.add(d("Labels")),r}return R(t,e),t.prototype.getByValue=function(e){var t=y.build().string(e);return this.getChild(k,"GetByValue",t)},t.prototype.get=function(){var e=this;return this.sendGetCollection(function(t){if(!Object(r.stringIsNullOrEmpty)(t.Value))return e.getByValue(t.Value);throw Error("Could not find Value in Labels.get(). You must include at least one of these in your select fields.")})},t}(O),k=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R(t,e),t.prototype.get=function(){return this.sendGet(t)},t.prototype.setAsDefaultForLanguage=function(){return this.invokeNonQuery("SetAsDefaultForLanguage")},t.prototype.delete=function(){return this.invokeNonQuery("DeleteObject")},t}(O),U=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R(t,e),t.prototype.get=function(){var e=this;return this.sendGetCollection(function(t){if(!Object(r.stringIsNullOrEmpty)(t.Name))return e.getByName(t.Name);if(!Object(r.stringIsNullOrEmpty)(t.Id))return e.getById(t.Id);throw Error("Could not find Name or Id in Terms.get(). You must include at least one of these in your select fields.")})},t.prototype.getById=function(e){var t=y.build().string(Object(r.sanitizeGuid)(e));return this.getChild(F,"GetById",t)},t.prototype.getByName=function(e){var t=y.build().string(e);return this.getChild(F,"GetByName",t)},t}(O),F=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R(t,e),Object.defineProperty(t.prototype,"labels",{get:function(){return new L(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return this.getChildProperty(t,"Parent")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pinSourceTermSet",{get:function(){return this.getChildProperty(G,"PinSourceTermSet")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"reusedTerms",{get:function(){return this.getChildProperty(U,"ReusedTerms")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sourceTerm",{get:function(){return this.getChildProperty(t,"SourceTerm")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"termSet",{get:function(){return this.getChildProperty(G,"TermSet")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"termSets",{get:function(){return this.getChildProperty(B,"TermSets")},enumerable:!0,configurable:!0}),t.prototype.createLabel=function(e,t,n){var o=this;void 0===n&&(n=!1);var i=y.build().string(e).number(t).boolean(n);return this._useCaching=!1,this.invokeMethod("CreateLabel",i).then(function(t){return Object(r.extend)(o.labels.getByValue(e),t)})},t.prototype.deprecate=function(e){var t=y.build().boolean(e);return this.invokeNonQuery("Deprecate",t)},t.prototype.get=function(){return this.sendGet(t)},t.prototype.getDescription=function(e){var t=y.build().number(e);return this.invokeMethodAction("GetDescription",t)},t.prototype.setDescription=function(e,t){var n=y.build().string(e).number(t);return this.invokeNonQuery("SetDescription",n)},t.prototype.setLocalCustomProperty=function(e,t){var n=y.build().string(e).string(t);return this.invokeNonQuery("SetLocalCustomProperty",n)},t.prototype.update=function(e){return this.invokeUpdate(e,t)},t}(O),B=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R(t,e),t.prototype.get=function(){var e=this;return this.sendGetCollection(function(t){if(!Object(r.stringIsNullOrEmpty)(t.Name))return e.getByName(t.Name);if(!Object(r.stringIsNullOrEmpty)(t.Id))return e.getById(t.Id);throw Error("Could not find Value in Labels.get(). You must include at least one of these in your select fields.")})},t.prototype.getById=function(e){var t=y.build().string(Object(r.sanitizeGuid)(e));return this.getChild(G,"GetById",t)},t.prototype.getByName=function(e){var t=y.build().string(e);return this.getChild(G,"GetByName",t)},t}(O),G=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return R(t,e),Object.defineProperty(t.prototype,"group",{get:function(){return this.getChildProperty(q,"Group")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"terms",{get:function(){return this.getChild(U,"GetAllTerms",null)},enumerable:!0,configurable:!0}),t.prototype.addStakeholder=function(e){var t=y.build().string(e);return this.invokeNonQuery("DeleteStakeholder",t)},t.prototype.deleteStakeholder=function(e){var t=y.build().string(e);return this.invokeNonQuery("AddStakeholder",t)},t.prototype.get=function(){return this.sendGet(t)},t.prototype.getTermById=function(e){var t=y.build().string(Object(r.sanitizeGuid)(e));return this.getChild(F,"GetTerm",t)},t.prototype.addTerm=function(e,t,n,o){var i=this;void 0===n&&(n=!0),void 0===o&&(o=Object(r.getGUID)());var a=y.build().string(e).number(t).string(Object(r.sanitizeGuid)(o));return this._useCaching=!1,this.invokeMethod("CreateTerm",a,l("IsAvailableForTagging","Boolean",""+n)).then(function(e){return Object(r.extend)(i.getTermById(e.Id),e)})},t.prototype.copy=function(){return this.invokeMethod("Copy",null)},t.prototype.update=function(e){return this.invokeUpdate(e,t)},t}(O),q=function(e){function t(t,n){void 0===t&&(t="");var r=e.call(this,t,n)||this;return r.store=t instanceof V?t:null,r}return R(t,e),Object.defineProperty(t.prototype,"termSets",{get:function(){return this.getChildProperty(B,"TermSets")},enumerable:!0,configurable:!0}),t.prototype.addContributor=function(e){var t=y.build().string(e);return this.invokeNonQuery("AddContributor",t)},t.prototype.addGroupManager=function(e){var t=y.build().string(e);return this.invokeNonQuery("AddGroupManager",t)},t.prototype.createTermSet=function(e,t,n){var o=this;void 0===n&&(n=Object(r.getGUID)());var i=y.build().string(e).string(Object(r.sanitizeGuid)(n)).number(t);return this._useCaching=!1,this.invokeMethod("CreateTermSet",i).then(function(e){return Object(r.extend)(o.store.getTermSetById(e.Id),e)})},t.prototype.get=function(){return this.sendGet(t)},t.prototype.update=function(e){return this.invokeUpdate(e,t)},t}(O),H=function(e){function t(t){void 0===t&&(t="");var n=e.call(this,t)||this;return n._objectPaths.add(d("TermStores",'<ObjectPath Id="$$ID$$" ObjectPathId="$$PATH_ID$$" />')),n}return R(t,e),t.prototype.get=function(){var e=this;return this.sendGetCollection(function(t){if(!Object(r.stringIsNullOrEmpty)(t.Name))return e.getByName(t.Name);if(!Object(r.stringIsNullOrEmpty)(t.Id))return e.getById(t.Id);throw Error("Could not find Name or Id in TermStores.get(). You must include at least one of these in your select fields.")})},t.prototype.getByName=function(e){return this.getChild(V,"GetByName",y.build().string(e))},t.prototype.getById=function(e){return this.getChild(V,"GetById",y.build().string(Object(r.sanitizeGuid)(e)))},t}(O),V=function(e){function t(t,n){return void 0===t&&(t=""),void 0===n&&(n=null),e.call(this,t,n)||this}return R(t,e),Object.defineProperty(t.prototype,"hashTagsTermSet",{get:function(){return this.getChildProperty(G,"HashTagsTermSet")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"keywordsTermSet",{get:function(){return this.getChildProperty(G,"KeywordsTermSet")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"orphanedTermsTermSet",{get:function(){return this.getChildProperty(G,"OrphanedTermsTermSet")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"systemGroup",{get:function(){return this.getChildProperty(q,"SystemGroup")},enumerable:!0,configurable:!0}),t.prototype.get=function(){return this.sendGet(t)},t.prototype.getTermSetsByName=function(e,t){var n=y.build().string(e).number(t);return this.getChild(B,"GetTermSetsByName",n)},t.prototype.getTermSetById=function(e){var t=y.build().string(Object(r.sanitizeGuid)(e));return this.getChild(G,"GetTermSet",t)},t.prototype.getTermById=function(e){var t=y.build().string(Object(r.sanitizeGuid)(e));return this.getChild(F,"GetTerm",t)},t.prototype.getTermsById=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=y.build().strArray(e.map(function(e){return Object(r.sanitizeGuid)(e)}));return this.getChild(U,"GetTermsById",n)},t.prototype.getTermInTermSet=function(e,t){var n=y.build().string(Object(r.sanitizeGuid)(e)).string(Object(r.sanitizeGuid)(t));return this.getChild(F,"GetTermInTermSet",n)},t.prototype.getTermGroupById=function(e){var t=y.build().string(Object(r.sanitizeGuid)(e));return this.getChild(q,"GetGroup",t)},t.prototype.getTerms=function(e){var t=this._objectPaths.clone(),n=t.lastIndex,r=h.apply(void 0,["{61a1d689-2744-4ea3-a88b-c95bee9803aa}",'<ObjectPath Id="$$ID$$" ObjectPathId="$$PATH_ID$$" />'].concat(p(e))),o=t.add(r),i=y.build().objectPath(o),a=t.add(g("GetTerms",i,'<ObjectPath Id="$$ID$$" ObjectPathId="$$PATH_ID$$" />'));return t.addChildRelationship(n,a),new U(this,t)},t.prototype.getSiteCollectionGroup=function(e){void 0===e&&(e=!1);var t=this._objectPaths.clone(),n=t.lastIndex,r=t.siteIndex,o=y.build().objectPath(r).boolean(e),i=t.add(g("GetSiteCollectionGroup",o,'<ObjectPath Id="$$ID$$" ObjectPathId="$$PATH_ID$$" />'));return t.addChildRelationship(n,i),new q(this,t)},t.prototype.addLanguage=function(e){var t=y.build().number(e);return this.invokeNonQuery("AddLanguage",t)},t.prototype.addGroup=function(e,t){var n=this;void 0===t&&(t=Object(r.getGUID)());var o=y.build().string(e).string(Object(r.sanitizeGuid)(t));return this._useCaching=!1,this.invokeMethod("CreateGroup",o).then(function(e){return Object(r.extend)(n.getTermGroupById(e.Id),e)})},t.prototype.commitAll=function(){return this.invokeNonQuery("CommitAll")},t.prototype.deleteLanguage=function(e){var t=y.build().number(e);return this.invokeNonQuery("DeleteLanguage",t)},t.prototype.rollbackAll=function(){return this.invokeNonQuery("RollbackAll")},t.prototype.updateCache=function(){return this.invokeNonQuery("UpdateCache")},t.prototype.update=function(e){return this.invokeUpdate(e,t)},t.prototype.updateUsedTermsOnSite=function(){var e=this._objectPaths.clone(),t=e.lastIndex,n=e.siteIndex,r=y.build().objectPath(n),o=e.add(g("UpdateUsedTermsOnSite",r));return e.addChildRelationship(t,o),this.send(e)},t.prototype.getChanges=function(e){var t=this._objectPaths.clone(),n=t.lastIndex,r=t.add(h.apply(void 0,["{1f849fb0-4fcb-4a54-9b01-9152b9e482d3}",'<ObjectPath Id="$$ID$$" ObjectPathId="$$PATH_ID$$" />'].concat(p(e)))),o=y.build().objectPath(r),i=t.add(g("GetChanges",o,'<ObjectPath Id="$$ID$$" ObjectPathId="$$PATH_ID$$" />',c([],this.getSelects())));return t.addChildRelationship(n,i),this.send(t)},t}(O),W=function(e){function t(t){void 0===t&&(t="");var n=e.call(this,t)||this;return n._objectPaths.add(f("GetTaxonomySession","{981cbc68-9edc-4f8d-872f-71146fcbb84f}",'<ObjectPath Id="$$ID$$" ObjectPathId="$$PATH_ID$$" />')),n}return R(t,e),Object.defineProperty(t.prototype,"termStores",{get:function(){return new H(this)},enumerable:!0,configurable:!0}),t.prototype.setup=function(e){i.sp.setup(e)},t.prototype.createBatch=function(){return new P(this.toUrl())},t.prototype.getDefaultKeywordTermStore=function(){return this.getChild(V,"GetDefaultKeywordsTermStore",null)},t.prototype.getDefaultSiteCollectionTermStore=function(){return this.getChild(V,"GetDefaultSiteCollectionTermStore",null)},t}(O);function K(e,t,n){if(!Object(r.objectDefinedNotNull)(n))return Promise.resolve(null);var o={};return o[t]={Label:n.Name,TermGuid:Object(r.sanitizeGuid)(n.Id),WssId:"-1",__metadata:{type:"SP.Taxonomy.TaxonomyFieldValue"}},e.update(o)}function z(e,t){for(var n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];return n.length<1?Promise.resolve(null):e.list.fields.getByTitle(t+"_0").select("InternalName").get().then(function(t){var o={};return o[t.InternalName]=n.map(function(e){return"-1;#"+e.Name+"|"+Object(r.sanitizeGuid)(e.Id)+";#"}).join(""),e.update(o)})}!function(e){e[e.StartsWith=0]="StartsWith",e[e.ExactMatch=1]="ExactMatch"}(M||(M={})),function(e){e[e.Unknown=0]="Unknown",e[e.Term=1]="Term",e[e.TermSet=2]="TermSet",e[e.Group=3]="Group",e[e.TermStore=4]="TermStore",e[e.Site=5]="Site"}(j||(j={})),function(e){e[e.Unknown=0]="Unknown",e[e.Add=1]="Add",e[e.Edit=2]="Edit",e[e.DeleteObject=3]="DeleteObject",e[e.Move=4]="Move",e[e.Copy=5]="Copy",e[e.PathChange=6]="PathChange",e[e.Merge=7]="Merge",e[e.ImportObject=8]="ImportObject",e[e.Restore=9]="Restore"}(D||(D={}));var $=new W}])});
//# sourceMappingURL=Share.Common.TypeScript.js.map